{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "9f8415fd279415fade9c1dcbe1e082b7", "detectedBy": ["DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "b85d3e340d53d3d4f53241404e6fad80", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/ant/taskdefs/optional/net/FTP.java", "commitBeforeChange": "030ac58e280b9267ca8ea709bd846443059a0205", "commitAfterChange": "e074b294911e39877ee9a480e44979f16b9a4882", "methodNumberBeforeChange": 27, "methodNumberAfterChange": 27, "signatureBeforeChange": "     protected void createParents(FTPClient ftp, String filename)          throws IOException, BuildException", "signatureAfterChange": "     protected void createParents(FTPClient ftp, String filename)          throws IOException, BuildException", "diff": ["+", "+        String cwd = ftp.printWorkingDirectory();", "+        ", "-        for (int i = parents.size() - 1; i >= 0; i--) {", "+        // find first non cached dir", "+        int i = parents.size() - 1;", "+        while (i >= 0) {", "-                log(\"creating remote directory \" + resolveFile(dir.getPath()),", "-                    Project.MSG_VERBOSE);", "-                if(!ftp.makeDirectory(resolveFile(dir.getPath()))) {", "-                    handleMkDirFailure(ftp);", "+                break;", "+            }", "+            i--;", "+        }", "+                ", "+        if (i >= 0) {", "+            String parent = dir.getParent();", "+            if (parent != null) {", "+                if (!ftp.changeWorkingDirectory(parent)) {", "+                    throw new BuildException(\"could not change to \" ", "+                        + \"directory: \" + ftp.getReplyString());", "+                }", "+            }", "+            ", "+            while (i >= 0) {", "+                dir = (File) parents.elementAt(i--);", "+                // check if dir exists by trying to change into it.", "+                if (!ftp.changeWorkingDirectory(dir.getName())) {", "+                    // could not change to it - try to create it", "+                    log(\"creating remote directory \" ", "+                        + resolveFile(dir.getPath()), Project.MSG_VERBOSE);", "+                    if(!ftp.makeDirectory(dir.getName())) {", "+                        handleMkDirFailure(ftp);", "+                    }", "+                    if (!ftp.changeWorkingDirectory(dir.getName())) {", "+                        throw new BuildException(\"could not change to \" ", "+                            + \"directory: \" + ftp.getReplyString());", "+                    }", "+            ftp.changeWorkingDirectory(cwd);            "]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "dc9c1bd4f5442a862b4191d086911b2d", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/ant/taskdefs/Move.java", "commitBeforeChange": "dd59f330e28468c67b69a1d4e352f4e5bafcb27f", "commitAfterChange": "a5a1cf23953be08f91c28840a830e295eb7b171c", "methodNumberBeforeChange": 7, "methodNumberAfterChange": 8, "signatureBeforeChange": "     protected boolean renameFile(File sourceFile, File destFile,                                  boolean filtering, boolean overwrite)         throws IOException, BuildException", "signatureAfterChange": "     protected boolean renameFile(File sourceFile, File destFile,                                  boolean filtering, boolean overwrite)         throws IOException, BuildException", "diff": ["-        boolean renamed = true;", "-        if ((getFilterSets() != null && getFilterSets().size() > 0)", "-            || (getFilterChains() != null && getFilterChains().size() > 0)) {", "-            renamed = false;", "-        } else {", "-            if (!filtering) {", "-                // ensure that parent dir of dest file exists!", "-                File parent = destFile.getParentFile();", "-                if (parent != null && !parent.exists()) {", "-                    parent.mkdirs();", "-                }", "-", "-                if (destFile.exists()) {", "-                    if (sourceFile.isDirectory()) {", "-                     throw new BuildException(", "-                        new StringBuffer(\"Cannot replace \").append(", "-                        ((destFile.isFile()) ? \"file \" : \"directory \")).append(", "-                        destFile).append(\" with directory \").append(", "-                        sourceFile).toString());", "-                    } else if (destFile.isFile() && !destFile.delete()) {", "-                        throw new BuildException(\"Unable to remove existing \"", "-                                                 + \"file \" + destFile);", "-                    }", "-                }", "-                renamed = sourceFile.renameTo(destFile);", "-            } else {", "-                renamed = false;", "+        boolean renamed = false;", "+        if ((getFilterSets().size() + getFilterChains().size() == 0)", "+            && !(filtering || destFile.isDirectory())) {", "+            // ensure that parent dir of dest file exists!", "+            File parent = destFile.getParentFile();", "+            if (parent != null && !parent.exists()) {", "+                parent.mkdirs();", "+            if (destFile.isFile() && !destFile.delete()) {", "+                throw new BuildException(\"Unable to remove existing \"", "+                                         + \"file \" + destFile);", "+            }", "+            renamed = sourceFile.renameTo(destFile);"]}]}