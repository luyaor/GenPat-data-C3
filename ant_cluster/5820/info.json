{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "0f8f1cd77525553fe8d35cb1c5817960", "detectedBy": ["DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "052dfb226bdac829f38d65fb40d8af68", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "proposal/myrmidon/src/java/org/apache/aut/vfs/provider/AbstractFileObject.java", "commitBeforeChange": "f382fa32eec7260111db0d67ae9c90dee2d6de0b", "commitAfterChange": "dfa0c6e159416ba22df942ba98e496d99d53d07f", "methodNumberBeforeChange": 24, "methodNumberAfterChange": 25, "signatureBeforeChange": "     public void delete() throws FileSystemException", "signatureAfterChange": "     public void delete( final FileSelector selector ) throws FileSystemException", "diff": ["-    public void delete() throws FileSystemException", "+    public void delete( final FileSelector selector ) throws FileSystemException", "-        // Recursively delete this file and all its children", "-        List queue = new ArrayList();", "-        Set expanded = new HashSet();", "-        queue.add( this );", "+        // Locate all the files to delete", "+        ArrayList files = new ArrayList();", "+        findFiles( selector, true, files );", "-        // Recursively delete each file", "-        // TODO - recover from errors", "-        while( queue.size() > 0 )", "+        // Delete 'em", "+        final int count = files.size();", "+        for( int i = 0; i < count; i++ )", "-            AbstractFileObject file = (AbstractFileObject)queue.get( 0 );", "+            final AbstractFileObject file = (AbstractFileObject)files.get( i );", "-            if( file.m_type == null )", "+            // If the file is a folder, make sure all its children have been deleted", "+            if( file.m_type == FileType.FOLDER && file.getChildren().length != 0 )", "-                // Shouldn't happen", "-                queue.remove( 0 );", "+                // Skip", "+                continue;", "-            else if( file.m_type == FileType.FILE )", "-            {", "-                // Delete the file", "-                file.deleteSelf();", "-                queue.remove( 0 );", "-            }", "-            else if( expanded.contains( file ) )", "-            {", "-                // Have already deleted all the children of this folder -", "-                // delete it", "-                file.deleteSelf();", "-                queue.remove( 0 );", "-            }", "-            else", "-            {", "-                // Delete the folder's children", "-                FileObject[] children = file.getChildren();", "-                for( int i = 0; i < children.length; i++ )", "-                {", "-                    FileObject child = children[ i ];", "-                    queue.add( 0, child );", "-                }", "-                expanded.add( file );", "-            }", "-        }", "-        // Update parent's child list", "-        notifyParent();", "+            // Delete the file", "+            file.deleteSelf();", "+        }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "15cdd007b0e7d4b5132382cd58a72690", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/ant/taskdefs/optional/ssh/SSHExec.java", "commitBeforeChange": "99905c75ac5271a7eb5c1cabd0493b25e11cdc2d", "commitAfterChange": "e601be9dd7423c9000e6913ce2f5a785c7881b89", "methodNumberBeforeChange": 3, "methodNumberAfterChange": 6, "signatureBeforeChange": "     public void execute() throws BuildException", "signatureAfterChange": "     public void execute() throws BuildException", "diff": ["-            throw new BuildException(\"Host is null.\");", "+            throw new BuildException(\"Host is required.\");", "-            throw new BuildException(\"Username is null.\");", "+            throw new BuildException(\"Username is required.\");", "-            throw new BuildException(\"Password and Keyfile are null.\");", "+            throw new BuildException(\"Password or Keyfile is required.\");", "-            throw new BuildException(\"Command is null.\");", "+            throw new BuildException(\"Command is required.\");", "+        ByteArrayOutputStream out = new ByteArrayOutputStream();", "+        Tee tee = new Tee(out, System.out);", "+", "+            // execute the command", "-            ChannelExec channel=(ChannelExec) session.openChannel(\"exec\");", "+            session.setTimeout(maxwait);", "+            final ChannelExec channel=(ChannelExec) session.openChannel(\"exec\");", "-            channel.setInputStream(System.in);", "-            channel.setOutputStream(System.out);", "+            channel.setOutputStream(tee);", "+", "+            // wait for it to finish", "+            thread =", "+                new Thread() {", "+                    public void run() {", "+                        while (!channel.isEOF()) {", "+                            if (thread == null) {", "+                                return;", "+                            }", "+                            try {", "+                                sleep(500);", "+                            } catch (Exception e) {", "+                                // ignored", "+                            }", "+                        }", "+                    }", "+                };", "+                    ", "+            thread.start();", "+            thread.join(maxwait);", "+            ", "+            if (thread.isAlive()) {", "+                // ran out of time", "+                thread = null;", "+                log(\"Timeout period exceeded, connection dropped.\");", "+            } else {", "+                // completed successfully", "+                if (output_property != null) {", "+                    getProject().setProperty(output_property, out.toString());", "+                }", "+                if (output_file != null) {", "+                    writeToFile(out.toString(), append, output_file);", "+                }", "+            }", "+"]}]}