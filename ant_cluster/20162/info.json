{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "8fb301f06ca147a1eb586434151f1a21", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "20f7e6a44c7306ee10c86f69da30ecd4", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/zip/ZipFile.java", "commitBeforeChange": "1a4946cfd6c88cd17f387b99634ab859dbbea692", "commitAfterChange": "82641d77bb4d421ae6190f0b99484f668ebc2106", "methodNumberBeforeChange": 18, "methodNumberAfterChange": 18, "signatureBeforeChange": "     private void positionAtCentralDirectory()         throws IOException", "signatureAfterChange": "     private void positionAtCentralDirectory()         throws IOException", "diff": ["-        archive.seek(archive.getFilePointer() - ZIP64_EOCDL_LENGTH);", "-        archive.readFully(WORD_BUF);", "-        boolean found = Arrays.equals(ZipOutputStream.ZIP64_EOCD_LOC_SIG,", "-                                      WORD_BUF);", "+        boolean found = false;", "+        boolean searchedForZip64EOCD =", "+            archive.getFilePointer() > ZIP64_EOCDL_LENGTH;", "+        if (searchedForZip64EOCD) {", "+            archive.seek(archive.getFilePointer() - ZIP64_EOCDL_LENGTH);", "+            archive.readFully(WORD_BUF);", "+            found = Arrays.equals(ZipOutputStream.ZIP64_EOCD_LOC_SIG, WORD_BUF);", "+        }", "-            skipBytes(ZIP64_EOCDL_LENGTH - WORD);", "+            if (searchedForZip64EOCD) {", "+                skipBytes(ZIP64_EOCDL_LENGTH - WORD);", "+            }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "2cf529a208d19bf47807bd0d801e0b77", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/zip/ZipFile.java", "commitBeforeChange": "aa43e37a025cdf54b8914b8283e57419a253ed59", "commitAfterChange": "dee95e3acc5154aee03ff5f91f9a56426ae79f3f", "methodNumberBeforeChange": 13, "methodNumberAfterChange": 18, "signatureBeforeChange": "     private void positionAtCentralDirectory()         throws IOException", "signatureAfterChange": "     private void positionAtCentralDirectory()         throws IOException", "diff": ["+        boolean found = tryToLocateSignature(MIN_EOCD_SIZE + ZIP64_EOCDL_LENGTH,", "+                                             MAX_EOCD_SIZE + ZIP64_EOCDL_LENGTH,", "+                                             ZipOutputStream", "+                                             .ZIP64_EOCD_LOC_SIG);", "+        if (!found) {", "+            // not a ZIP64 archive", "+            positionAtCentralDirectory32();", "+        } else {", "+            positionAtCentralDirectory64();", "+        }", "+    }", "-        long off = archive.length() - MIN_EOCD_SIZE;", "-            Math.max(0L, archive.length() - MAX_EOCD_SIZE);", "-            final byte[] sig = ZipOutputStream.EOCD_SIG;", "-        if (!found) {", "-            throw new ZipException(\"archive is not a ZIP archive\");", "-        archive.seek(off + CFD_LOCATOR_OFFSET);", "-        byte[] cfdOffset = new byte[WORD];", "-        archive.readFully(cfdOffset);", "-        archive.seek(ZipLong.getValue(cfdOffset));"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "a3e9d3d30dd89fc1fc67d6a16cbfdd45", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/zip/ZipFile.java", "commitBeforeChange": "f844348eff346280acc9d922bfacf5c99668ac4a", "commitAfterChange": "1a4946cfd6c88cd17f387b99634ab859dbbea692", "methodNumberBeforeChange": 18, "methodNumberAfterChange": 18, "signatureBeforeChange": "     private void positionAtCentralDirectory()         throws IOException", "signatureAfterChange": "     private void positionAtCentralDirectory()         throws IOException", "diff": ["-        boolean found = tryToLocateSignature(MIN_EOCD_SIZE + ZIP64_EOCDL_LENGTH,", "-                                             MAX_EOCD_SIZE + ZIP64_EOCDL_LENGTH,", "-                                             ZipOutputStream", "-                                             .ZIP64_EOCD_LOC_SIG);", "+        positionAtEndOfCentralDirectoryRecord();", "+        archive.seek(archive.getFilePointer() - ZIP64_EOCDL_LENGTH);", "+        archive.readFully(WORD_BUF);", "+        boolean found = Arrays.equals(ZipOutputStream.ZIP64_EOCD_LOC_SIG,", "+                                      WORD_BUF);", "+            skipBytes(ZIP64_EOCDL_LENGTH - WORD);"]}]}