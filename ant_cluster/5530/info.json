{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "415518a213cbe50f059fb4d60802018f", "detectedBy": ["DIFF_DBSCAN", "AST_HIERARCHICAL", "AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "3070cfad485d02df15a41c371a6217d5", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/ant/taskdefs/Expand.java", "commitBeforeChange": "dc00bd536bd6a1cd2bae07cecc352c085a8a0f9d", "commitAfterChange": "80d371a3b4e1ba3f845e1b9a8f831fd6a11fafd5", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": "      private void expandFile(Touch touch, File srcF, File dir)", "signatureAfterChange": "     protected void expandFile(Touch touch, File srcF, File dir)", "diff": ["-    private void expandFile(Touch touch, File srcF, File dir) {", "+     */", "+    protected void expandFile(Touch touch, File srcF, File dir) {", "-            log(\"Expanding: \" + srcF + \" into \" + dir, Project.MSG_INFO);", "-                File f = new File(dir, project.translatePath(ze.getName()));", "-                try {", "-                    if (!overwrite && f.exists() ", "-                        && f.lastModified() >= ze.getTime()) {", "-                        log(\"Skipping \" + f + \" as it is up-to-date\",", "-                            Project.MSG_DEBUG);", "-                        continue;", "-                    }", "-                    ", "-                    log(\"expanding \" + ze.getName() + \" to \"+ f, ", "-                        Project.MSG_VERBOSE);", "-                    // create intermediary directories - sometimes zip don't add them", "-                    File dirF=new File(f.getParent());", "-                    dirF.mkdirs();", "-                    ", "-                    if (ze.isDirectory()) {", "-                        f.mkdirs(); ", "-                    } else {", "-                        byte[] buffer = new byte[1024];", "-                        int length = 0;", "-                        FileOutputStream fos = new FileOutputStream(f);", "-                        ", "-                        while ((length = zis.read(buffer)) >= 0) {", "-                            fos.write(buffer, 0, length);", "-                        }", "-                        ", "-                        fos.close();", "-                    }", "-                    ", "-                    if (project.getJavaVersion() != Project.JAVA_1_1) {", "-                        touch.setFile(f);", "-                        touch.setMillis(ze.getTime());", "-                        touch.touch();", "-                    }", "-                    ", "-                } catch( FileNotFoundException ex ) {", "-                    log(\"Unable to expand to file \" + f.getPath(), Project.MSG_WARN);", "-                }", "+                extractFile(touch, srcF, dir, zis,", "+                            ze.getName(), ze.getSize(),", "+                            new Date(ze.getTime()),", "+                            ze.isDirectory());", "-            log(\"expand complete\", Project.MSG_VERBOSE );", "+", "+            if (dest != null) {", "+                log(\"expand complete\", Project.MSG_VERBOSE );", "+            }", "+"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "fef40ba098eec3c339116f1e496e65cb", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/ant/taskdefs/Untar.java", "commitBeforeChange": "dc00bd536bd6a1cd2bae07cecc352c085a8a0f9d", "commitAfterChange": "80d371a3b4e1ba3f845e1b9a8f831fd6a11fafd5", "methodNumberBeforeChange": 0, "methodNumberAfterChange": 0, "signatureBeforeChange": "     public void execute() throws BuildException", "signatureAfterChange": "      protected void expandFile(Touch touch, File srcF, File dir)", "diff": ["-     */", "-    public void execute() throws BuildException {", "-", "-        Touch touch = (Touch) project.createTask(\"touch\");", "-        touch.setOwningTarget(target);", "-        touch.setTaskName(getTaskName());", "-        touch.setLocation(getLocation());", "-                    ", "-        File srcF = source;", "-", "+    protected void expandFile(Touch touch, File srcF, File dir) {", "-            if (source == null) {", "-                throw new BuildException(\"No source specified\", location);", "-            }", "-            if (!srcF.exists()) {", "-                throw new BuildException(\"source \"+srcF+\" doesn't exist\",", "-                                         location);", "+            if (dest != null) {", "+                log(\"Expanding: \" + srcF + \" into \" + dir, Project.MSG_INFO);", "-            if (dest == null) {", "-                throw new BuildException(\"No destination specified\", location);", "-            }", "-            File dir = dest;", "-", "-            log(\"Expanding: \" + srcF + \" into \" + dir, Project.MSG_INFO);", "-                try {", "-                    File f = new File(dir, project.translatePath(te.getName()));", "-                    if (!overwrite && f.exists() ", "-                        && f.lastModified() >= te.getModTime().getTime()) {", "-                        log(\"Skipping \" + f + \" as it is up-to-date\",", "-                            Project.MSG_DEBUG);", "-                        continue;", "-                    }", "-                    ", "-                    log(\"expanding \" + te.getName() + \" to \"+ f, ", "-                        Project.MSG_VERBOSE);", "-                    File dirF=new File(f.getParent());", "-                    dirF.mkdirs();", "-", "-                    if (te.isDirectory()) {", "-                        f.mkdirs();", "-                    } else {", "-                        byte[] buffer = new byte[1024];", "-                        int length = 0;", "-                        FileOutputStream fos = new FileOutputStream(f);", "-", "-                        while ((length = tis.read(buffer)) >= 0) {", "-                            fos.write(buffer, 0, length);", "-                        }", "-", "-                        fos.close();", "-                    }", "-", "-                    if (project.getJavaVersion() != Project.JAVA_1_1) {", "-                        touch.setFile(f);", "-                        touch.setMillis(te.getModTime().getTime());", "-                        touch.touch();", "-                    }", "-", "-                } catch(FileNotFoundException ex) {", "-                    log(\"FileNotFoundException: \" + te.getName(),", "-                        Project.MSG_WARN);", "-                }", "+                extractFile(touch, srcF, dir, tis,", "+                            te.getName(), te.getSize(),", "+                            te.getModTime(), te.isDirectory(),", "+                            mode2str(te.getMode()),", "+                            te.getUserId() + \"/\" + te.getGroupId());", "+            if (dest != null) {", "+                log(\"expand complete\", Project.MSG_VERBOSE );", "+            }", "+", "-\t} finally {", "-\t    if (tis != null) {", "-\t        try {", "-\t            tis.close();", "-\t        }", "-\t        catch (IOException e) {}", "-\t    }", "-\t}", "+        } finally {", "+            if (tis != null) {", "+                try {", "+                    tis.close();", "+                }", "+                catch (IOException e) {}", "+            }", "+        }"]}]}