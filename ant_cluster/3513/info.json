{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "a43c403495e6205ff9243e598029b362", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "3b04d3fa3eeba7bf73a515a43e67207e", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/ant/taskdefs/XSLTProcess.java", "commitBeforeChange": "aba1be216b8e8f554e7eeab98c77fdb5d61d2a47", "commitAfterChange": "ca5695fa0b2244e641914350434aa0dc8071d12c", "methodNumberBeforeChange": 2, "methodNumberAfterChange": 2, "signatureBeforeChange": "     public void execute() throws BuildException", "signatureAfterChange": "     public void execute() throws BuildException", "diff": ["+        File savedBaseDir = baseDir;", "+", "-        if (baseDir == null) {", "-            baseDir = project.resolveFile(\".\");", "-        }", "-        ", "-        liaison = getLiaison();", "-        ", "-        // check if liaison wants to log errors using us as logger", "-        if (liaison instanceof XSLTLoggerAware) {", "-            ((XSLTLoggerAware)liaison).setLogger(this);", "-        }", "-        ", "-        log(\"Using \" + liaison.getClass().toString(), Project.MSG_VERBOSE);", "-        ", "-        File stylesheet = project.resolveFile(xslFile);", "-        if (!stylesheet.exists()) {", "-            stylesheet = fileUtils.resolveFile(baseDir, xslFile);", "-            /*", "-             * shouldn't throw out deprecation warnings before we know,", "-             * the wrong version has been used.", "-             */", "-            if (stylesheet.exists()) {", "-                log(\"DEPRECATED - the style attribute should be relative \" ", "-                    + \"to the project\\'s\");", "-                log(\"             basedir, not the tasks\\'s basedir.\");", "+        try {", "+            if (baseDir == null) {", "+                baseDir = project.resolveFile(\".\");", "-        }", "-        // if we have an in file and out then process them", "-        if (inFile != null && outFile != null) {", "-            process(inFile, outFile, stylesheet);", "-            return;", "-        }", "-        ", "-        /*", "-         * if we get here, in and out have not been specified, we are", "-         * in batch processing mode.", "-         */", "-        ", "-        //-- make sure Source directory exists...", "-        if (destDir == null ) {", "-            String msg = \"destdir attributes must be set!\";", "-            throw new BuildException(msg);", "-        }", "-        scanner = getDirectoryScanner(baseDir);", "-        log(\"Transforming into \" + destDir, Project.MSG_INFO);", "-        ", "-        // Process all the files marked for styling", "-        list = scanner.getIncludedFiles();", "-        for (int i = 0; i < list.length; ++i) {", "-            process( baseDir, list[i], destDir, stylesheet );", "-        }", "-        if (performDirectoryScan) {", "-            // Process all the directories marked for styling", "-            dirs = scanner.getIncludedDirectories();", "-            for (int j = 0; j < dirs.length; ++j){", "-                list = new File(baseDir, dirs[j]).list();", "-                for (int i = 0; i < list.length; ++i) {", "-                    process( baseDir, list[i], destDir, stylesheet );", "+            liaison = getLiaison();", "+            ", "+            // check if liaison wants to log errors using us as logger", "+            if (liaison instanceof XSLTLoggerAware) {", "+                ((XSLTLoggerAware)liaison).setLogger(this);", "+            }", "+            ", "+            log(\"Using \" + liaison.getClass().toString(), Project.MSG_VERBOSE);", "+            ", "+            File stylesheet = project.resolveFile(xslFile);", "+            if (!stylesheet.exists()) {", "+                stylesheet = fileUtils.resolveFile(baseDir, xslFile);", "+                /*", "+                 * shouldn't throw out deprecation warnings before we know,", "+                 * the wrong version has been used.", "+                 */", "+                if (stylesheet.exists()) {", "+                    log(\"DEPRECATED - the style attribute should be relative \" ", "+                        + \"to the project\\'s\");", "+                    log(\"             basedir, not the tasks\\'s basedir.\");", "+        ", "+            // if we have an in file and out then process them", "+            if (inFile != null && outFile != null) {", "+                process(inFile, outFile, stylesheet);", "+                return;", "+            }", "+        ", "+            /*", "+             * if we get here, in and out have not been specified, we are", "+             * in batch processing mode.", "+             */", "+        ", "+            //-- make sure Source directory exists...", "+            if (destDir == null ) {", "+                String msg = \"destdir attributes must be set!\";", "+                throw new BuildException(msg);", "+            }", "+            scanner = getDirectoryScanner(baseDir);", "+            log(\"Transforming into \" + destDir, Project.MSG_INFO);", "+        ", "+            // Process all the files marked for styling", "+            list = scanner.getIncludedFiles();", "+            for (int i = 0; i < list.length; ++i) {", "+                process( baseDir, list[i], destDir, stylesheet );", "+            }", "+            if (performDirectoryScan) {", "+                // Process all the directories marked for styling", "+                dirs = scanner.getIncludedDirectories();", "+                for (int j = 0; j < dirs.length; ++j){", "+                    list = new File(baseDir, dirs[j]).list();", "+                    for (int i = 0; i < list.length; ++i) {", "+                        process( baseDir, list[i], destDir, stylesheet );", "+                    }", "+                }", "+            }", "+        } finally {", "+            liaison = null;", "+            stylesheetLoaded = false;", "+            baseDir = savedBaseDir;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "629911b45835307429aebee122f9569a", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/ant/taskdefs/XSLTProcess.java", "commitBeforeChange": "5800b026fac0179cb373c1c85261c04bf2b54e8e", "commitAfterChange": "88f1be2d0462de59e99bf085522756a647195248", "methodNumberBeforeChange": 6, "methodNumberAfterChange": 7, "signatureBeforeChange": "     public void execute() throws BuildException", "signatureAfterChange": "     public void execute() throws BuildException", "diff": ["-            log(\"Warning: the task name <style> is deprecated. Use <xslt> instead.\", Project.MSG_WARN);", "+            log(\"Warning: the task name <style> is deprecated. Use <xslt> instead.\",", "+                    Project.MSG_WARN);", "-        if (xslFile == null) {", "-            throw new BuildException(\"no stylesheet specified\", getLocation());", "+        if (xslResource == null && xslFile == null) {", "+            throw new BuildException(\"specify the \"", "+                + \"stylesheet either as a filename in style \"", "+                + \"attribute or as a nested resource\", getLocation());", "+", "+        }", "+        if (xslResource != null && xslFile != null) {", "+            throw new BuildException(\"specify the \"", "+                + \"stylesheet either as a filename in style \"", "+                + \"attribute or as a nested resource but not \"", "+                + \"as both\", getLocation());", "-            File stylesheet = getProject().resolveFile(xslFile);", "-            if (!stylesheet.exists()) {", "-                stylesheet = FILE_UTILS.resolveFile(baseDir, xslFile);", "-                /*", "-                 * shouldn't throw out deprecation warnings before we know,", "-                 * the wrong version has been used.", "-                 */", "-                if (stylesheet.exists()) {", "-                    log(\"DEPRECATED - the 'style' attribute should be relative \"", "-                        + \"to the project's\");", "-                    log(\"             basedir, not the tasks's basedir.\");", "+            if (xslFile != null) {", "+                // If we enter here, it means that the stylesheet is supplied", "+                // via style attribute", "+                File stylesheet = FILE_UTILS.resolveFile(getProject().getBaseDir(), xslFile);", "+                if (!stylesheet.exists()) {", "+                    stylesheet = FILE_UTILS.resolveFile(baseDir, xslFile);", "+                    /*", "+                     * shouldn't throw out deprecation warnings before we know,", "+                     * the wrong version has been used.", "+                     */", "+                    if (stylesheet.exists()) {", "+                        log(\"DEPRECATED - the 'style' attribute should be relative \"", "+                                + \"to the project's\");", "+                        log(\"             basedir, not the tasks's basedir.\");", "+                    }", "+                FileResource fr = new FileResource();", "+                fr.setProject(getProject());", "+                fr.setFile(stylesheet);", "+                xslResource = fr;", "-                process(inFile, outFile, stylesheet);", "+                process(inFile, outFile, xslResource);", "-\t    checkDest();", "+            checkDest();", "-\t    if (useImplicitFileset) {", "-            scanner = getDirectoryScanner(baseDir);", "-            log(\"Transforming into \" + destDir, Project.MSG_INFO);", "+            if (useImplicitFileset) {", "+                scanner = getDirectoryScanner(baseDir);", "+                log(\"Transforming into \" + destDir, Project.MSG_INFO);", "-            // Process all the files marked for styling", "-            list = scanner.getIncludedFiles();", "-            for (int i = 0; i < list.length; ++i) {", "-                process(baseDir, list[i], destDir, stylesheet);", "-            }", "-            if (performDirectoryScan) {", "-                // Process all the directories marked for styling", "-                dirs = scanner.getIncludedDirectories();", "-                for (int j = 0; j < dirs.length; ++j) {", "-                    list = new File(baseDir, dirs[j]).list();", "-                    for (int i = 0; i < list.length; ++i) {", "-                        process(baseDir, dirs[j] + File.separator + list[i],", "-                                destDir, stylesheet);", "+                // Process all the files marked for styling", "+                list = scanner.getIncludedFiles();", "+                for (int i = 0; i < list.length; ++i) {", "+                    process(baseDir, list[i], destDir, xslResource);", "+                }", "+                if (performDirectoryScan) {", "+                    // Process all the directories marked for styling", "+                    dirs = scanner.getIncludedDirectories();", "+                    for (int j = 0; j < dirs.length; ++j) {", "+                        list = new File(baseDir, dirs[j]).list();", "+                        for (int i = 0; i < list.length; ++i) {", "+                            process(baseDir, dirs[j] + File.separator + list[i],", "+                                    destDir, xslResource);", "+                        }", "+            } else { // only resource collections, there better be some", "+                if (resources.size() == 0) {", "+                    throw new BuildException(\"no resources specified\");", "+                }", "-\t    } else { // only resource collections, there better be some", "-            if (resources.size() == 0) {", "-                throw new BuildException(\"no resources specified\");", "-            }", "-\t    }", "-\t    processResources(stylesheet);", "+            processResources(xslResource);"]}]}