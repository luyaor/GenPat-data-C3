{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "b3060b03c145a2a0e85629a7bb9e8543", "detectedBy": ["AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "b85d3e340d53d3d4f53241404e6fad80", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/ant/taskdefs/optional/net/FTP.java", "commitBeforeChange": "030ac58e280b9267ca8ea709bd846443059a0205", "commitAfterChange": "e074b294911e39877ee9a480e44979f16b9a4882", "methodNumberBeforeChange": 27, "methodNumberAfterChange": 27, "signatureBeforeChange": "     protected void createParents(FTPClient ftp, String filename)          throws IOException, BuildException", "signatureAfterChange": "     protected void createParents(FTPClient ftp, String filename)          throws IOException, BuildException", "diff": ["+", "+        String cwd = ftp.printWorkingDirectory();", "+        ", "-        for (int i = parents.size() - 1; i >= 0; i--) {", "+        // find first non cached dir", "+        int i = parents.size() - 1;", "+        while (i >= 0) {", "-                log(\"creating remote directory \" + resolveFile(dir.getPath()),", "-                    Project.MSG_VERBOSE);", "-                if(!ftp.makeDirectory(resolveFile(dir.getPath()))) {", "-                    handleMkDirFailure(ftp);", "+                break;", "+            }", "+            i--;", "+        }", "+                ", "+        if (i >= 0) {", "+            String parent = dir.getParent();", "+            if (parent != null) {", "+                if (!ftp.changeWorkingDirectory(parent)) {", "+                    throw new BuildException(\"could not change to \" ", "+                        + \"directory: \" + ftp.getReplyString());", "+                }", "+            }", "+            ", "+            while (i >= 0) {", "+                dir = (File) parents.elementAt(i--);", "+                // check if dir exists by trying to change into it.", "+                if (!ftp.changeWorkingDirectory(dir.getName())) {", "+                    // could not change to it - try to create it", "+                    log(\"creating remote directory \" ", "+                        + resolveFile(dir.getPath()), Project.MSG_VERBOSE);", "+                    if(!ftp.makeDirectory(dir.getName())) {", "+                        handleMkDirFailure(ftp);", "+                    }", "+                    if (!ftp.changeWorkingDirectory(dir.getName())) {", "+                        throw new BuildException(\"could not change to \" ", "+                            + \"directory: \" + ftp.getReplyString());", "+                    }", "+            ftp.changeWorkingDirectory(cwd);            "]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "e0748339528f3b83e6f3998200995747", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/ant/taskdefs/optional/net/FTP.java", "commitBeforeChange": "c6c2722ad0807de6ce4f826bd92e51f2600ec07f", "commitAfterChange": "387d93e6ece00a294af599f30f0aac7b0bb56eee", "methodNumberBeforeChange": 35, "methodNumberAfterChange": 35, "signatureBeforeChange": "     protected void makeRemoteDir(FTPClient ftp, String dir)          throws IOException, BuildException", "signatureAfterChange": "     protected void makeRemoteDir(FTPClient ftp, String dir)          throws IOException, BuildException", "diff": ["+        String workingDirectory = ftp.printWorkingDirectory();", "-            log(\"creating directory: \" + dir);", "+            log(\"Creating directory: \" + dir);", "-", "-        if (!ftp.makeDirectory(dir)) {", "-            // codes 521, 550 and 553 can be produced by FTP Servers", "-            //  to indicate that an attempt to create a directory has", "-            //  failed because the directory already exists.", "-            handleMkDirFailure(ftp);", "-            if (verbose) {", "-                log(\"directory already exists\");", "+        if (dir.indexOf(\"/\") == 0) {", "+            ftp.changeWorkingDirectory(\"/\");", "+        }", "+        String subdir = new String();", "+        StringTokenizer st = new StringTokenizer(dir, \"/\");", "+        while (st.hasMoreTokens()) {", "+            subdir = st.nextToken();", "+            log(\"Checking \" + subdir, Project.MSG_DEBUG);", "+            if (!ftp.changeWorkingDirectory(subdir)) {", "+                if(!ftp.makeDirectory(subdir)) {", "+                    // codes 521, 550 and 553 can be produced by FTP Servers", "+                    //  to indicate that an attempt to create a directory has", "+                    //  failed because the directory already exists.", "+                    int rc = ftp.getReplyCode();", "+                    if (!(ignoreNoncriticalErrors && (rc == 550 || rc == 553 || rc==521))) {", "+                        throw new BuildException(\"could not create directory: \" + ftp.getReplyString());", "+                    }", "+                    if (verbose) {", "+                        log(\"Directory already exists\");", "+                    }", "+                } else {", "+                    if (verbose) {", "+                        log(\"Directory created OK\");", "+                    }", "+                    ftp.changeWorkingDirectory(subdir);", "+                }", "-        } else {", "-            if (verbose) {", "-                log(\"directory created OK\");", "-            }", "+        }", "+        if (workingDirectory != null) {", "+            ftp.changeWorkingDirectory(workingDirectory);"]}]}