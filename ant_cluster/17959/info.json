{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "9c728bb11ac19051080615bd645e9ed2", "detectedBy": ["AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "3f24c0f7a91d2e30bea35b89dd580d38", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/ant/taskdefs/Property.java", "commitBeforeChange": "be12707c63314ce0314959ff551e37fe59b83943", "commitAfterChange": "4f3e4e1690289144b15872597586ed34ae92efb5", "methodNumberBeforeChange": 24, "methodNumberAfterChange": 24, "signatureBeforeChange": "      private void resolveAllProperties(Hashtable props)", "signatureAfterChange": "      private void resolveAllProperties(Properties props) throws BuildException", "diff": ["-    private void resolveAllProperties(Hashtable props) {", "-        Hashtable unresolvableProperties = new Hashtable();", "-        for (Enumeration e = props.keys(); e.hasMoreElements(); ) {", "-            String name = (String) e.nextElement();", "-            String value = (String) props.get(name);", "+    private void resolveAllProperties(Properties props) throws BuildException {", "+        for (Enumeration e = props.keys(); e.hasMoreElements();) {", "+            String name = (String)e.nextElement();", "+            String value = props.getProperty(name);", "-            while (!resolved) { ", "-                Vector propsInValue = new Vector();", "-    ", "-                // assume it will be resolved", "+            while (!resolved) {", "+                Vector fragments = new Vector();", "+                Vector propertyRefs = new Vector();", "+                ProjectHelper.parsePropertyString(value, fragments, propertyRefs);", "+                ", "-                boolean unresolvable = false;", "-                if (extractProperties(value, propsInValue)) {", "-                    for (int i=0; i < propsInValue.size(); i++) {", "-                        String elem = (String) propsInValue.elementAt(i);", "-                        if (elem.equals(name) || unresolvableProperties.containsKey(elem)) {", "-                            // we won't try further resolving elements with circular ", "-                            // property dependencies or dependencies on unresolvable elements", "-                            unresolvable = true;", "-                            break;", "+                if (propertyRefs.size() != 0) {", "+                    StringBuffer sb = new StringBuffer();", "+                    Enumeration i = fragments.elements();", "+                    Enumeration j = propertyRefs.elements();", "+                    while (i.hasMoreElements()) {", "+                        String fragment = (String)i.nextElement();", "+                        if (fragment == null) {", "+                            String propertyName = (String)j.nextElement();", "+                            if (propertyName.equals(name)) {", "+                                throw new BuildException(\"Property \" + name + \" was circularly defined.\");", "+                            }", "+                            if (props.containsKey(propertyName)) {", "+                                fragment = props.getProperty(propertyName);", "+                                resolved = false;", "+                            }", "+                            else {", "+                                fragment = \"${\" + propertyName + \"}\";", "+                            }", "-                        ", "-                        if (project.getProperties().containsKey(elem) ||", "-                            props.containsKey(elem)) {", "-                            resolved = false;", "-                        }", "+                        sb.append(fragment);", "-                }", "-    ", "-                if (unresolvable) {", "-                    unresolvableProperties.put(name, value);", "-                    resolved = true;", "-                }", "-    ", "-                if (!resolved) {", "-                    value = ProjectHelper.replaceProperties(project, value,", "-                                                               project.getProperties());", "-                    value = ProjectHelper.replaceProperties(project, value, props);", "+                    value = sb.toString();", "-                }    ", "+                }", "-    }", "+    }    "]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "9bc8efb662e7d5e75da2cd20af87f7af", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/ant/types/selectors/modifiedselector/ModifiedSelector.java", "commitBeforeChange": "44be0d652d306225e106ce501d4c6421d50fd8b5", "commitAfterChange": "590844e775f322377fe9d9dbb7137ed465d625d9", "methodNumberBeforeChange": 2, "methodNumberAfterChange": 2, "signatureBeforeChange": "     public void configure()", "signatureAfterChange": "     public void configure()", "diff": ["-        org.apache.tools.ant.Project project = getProject();", "+        Project project = getProject();", "+", "+            // set self as a BuildListener to delay cachefile saves", "+            getProject().addBuildListener(this);", "-            // no reference to project - e.g. during JUnit tests", "+            // no reference to project - e.g. during normal JUnit tests", "+            setDelayUpdate(false);", "-        cache = new PropertiesfileCache(cachefile);", "-        algorithm = new DigestAlgorithm();", "-        comparator = new EqualComparator();", "+        Cache      defaultCache      = new PropertiesfileCache(cachefile);", "+        Algorithm  defaultAlgorithm  = new DigestAlgorithm();", "+        Comparator defaultComparator = new EqualComparator();", "-", "-        String pkg = \"org.apache.tools.ant.types.selectors.cacheselector\";", "+        String pkg = \"org.apache.tools.ant.types.selectors.modifiedselector\";", "-        // the algorithm", "-        if (algorithm == null) {", "+        // specify the algorithm classname", "+        if (algoName != null) {", "+            // use Algorithm defined via name", "-                className = pkg + \".HashvalueAlgorithm\";", "+                algorithm = new HashvalueAlgorithm();", "-                className = pkg + \".DigestAlgorithm\";", "+                algorithm = new DigestAlgorithm();", "+            } else if (\"checksum\".equals(algoName.getValue())) {", "+                algorithm = new ChecksumAlgorithm();", "-            if (className != null) {", "-                try {", "-                    // load the specified Algorithm, save the reference and configure it", "-                    algorithm = (Algorithm) Class.forName(className).newInstance();", "-                } catch (Exception e) {", "-                    e.printStackTrace();", "-                }", "+        } else {", "+            if (algorithmClass != null) {", "+                // use Algorithm specified by classname", "+                algorithm = (Algorithm) loadClass(", "+                    algorithmClass,", "+                    \"is not an Algorithm.\",", "+                    Algorithm.class);", "+            } else {", "+                // nothing specified - use default", "+                algorithm = defaultAlgorithm;", "-        // the cache", "-        if (cache == null) {", "+        // specify the cache classname", "+        if (cacheName != null) {", "+            // use Cache defined via name", "-                className = pkg + \".PropertiesfileCache\";", "+                cache = new PropertiesfileCache();", "-            if (className != null) {", "-                try {", "-                    // load the specified Cache, save the reference and configure it", "-                    cache = (Cache) Class.forName(className).newInstance();", "-                } catch (Exception e) {", "-                    e.printStackTrace();", "-                }", "+        } else {", "+            if (cacheClass != null) {", "+                // use Cache specified by classname", "+                cache = (Cache) loadClass(cacheClass, \"is not a Cache.\", Cache.class);", "+            } else {", "+                // nothing specified - use default", "+                cache = defaultCache;", "-        // the comparator", "-        if (comparator == null) {", "+        // specify the comparator classname", "+        if (compName != null) {", "+            // use Algorithm defined via name", "-                className = pkg + \".EqualComparator\";", "-            } else if (\"role\".equals(compName.getValue())) {", "-                className = \"java.text.RuleBasedCollator\";", "+                comparator = new EqualComparator();", "+             } else if (\"rule\".equals(compName.getValue())) {", "+                // TODO there is a problem with the constructor for the RBC.", "+                // you have to provide the rules in the constructors - no setters", "+                // available.", "+                throw new BuildException(\"RuleBasedCollator not yet supported.\");", "+                // Have to think about lazy initialization here...  JHM", "+                // comparator = new java.text.RuleBasedCollator();", "-            if (className != null) {", "-                try {", "-                    // load the specified Cache, save the reference and configure it", "-                    comparator = (Comparator) Class.forName(className).newInstance();", "-                } catch (Exception e) {", "-                    e.printStackTrace();", "-                }", "+        } else {", "+            if (comparatorClass != null) {", "+                // use Algorithm specified by classname", "+                comparator = (Comparator) loadClass(", "+                    comparatorClass,", "+                    \"is not a Comparator.\",", "+                    Comparator.class);", "+            } else {", "+                // nothing specified - use default", "+                comparator = defaultComparator;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "b4fc54c3399f4f222766f0add013ec59", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "proposal/myrmidon/src/main/org/apache/tools/ant/taskdefs/optional/dotnet/CSharp.java", "commitBeforeChange": "919e3c42b4f5fe58f906c93171d446e5cda882e0", "commitAfterChange": "9e8e57522752c19d172b764350480e0d7b69c112", "methodNumberBeforeChange": 34, "methodNumberAfterChange": 22, "signatureBeforeChange": "     public void execute()         throws TaskException", "signatureAfterChange": "     public void execute()         throws TaskException", "diff": ["-        if( _srcDir == null )", "+        if( null == m_srcDir )", "-            _srcDir = getBaseDirectory();", "+            m_srcDir = getBaseDirectory();", "-        NetCommand command = new NetCommand( this, \"CSC\", csc_exe_name );", "-        command.setFailOnError( getFailFailOnError() );", "-        //DEBUG helper", "-        command.setTraceCommandLine( true );", "-        //fill in args", "-        command.addArgument( \"/nologo\" );", "-        command.addArgument( getAdditionalModulesParameter() );", "-        command.addArgument( getDefinitionsParameter() );", "-        command.addArgument( getDebugParameter() );", "-        command.addArgument( getDocFileParameter() );", "-        command.addArgument( getIncrementalParameter() );", "-        command.addArgument( getMainClassParameter() );", "-        command.addArgument( getOptimizeParameter() );", "-        command.addArgument( getReferencesParameter() );", "-        command.addArgument( getTargetTypeParameter() );", "-        command.addArgument( getUnsafeParameter() );", "-        command.addArgument( getWarnLevelParameter() );", "-        command.addArgument( getWin32IconParameter() );", "-        command.addArgument( getOutputFileParameter() );", "-        command.addArgument( getIncludeDefaultReferencesParameter() );", "-        command.addArgument( getDefaultReferenceParameter() );", "-        command.addArgument( getWin32ResParameter() );", "-        command.addArgument( getUtf8OutpuParameter() );", "-        command.addArgument( getNoConfigParameter() );", "-        command.addArgument( getFullPathsParameter() );", "-        command.addArgument( getExtraOptionsParameter() );", "+        final ExecManager execManager = (ExecManager)getService( ExecManager.class );", "+        final Execute exe = new Execute( execManager );", "+        exe.setReturnCode( 0 );", "+", "+        final Commandline cmd = exe.getCommandline();", "+        cmd.setExecutable( EXE_NAME );", "+", "+        addArgument( cmd, \"/nologo\" );", "+        addArgument( cmd, getAdditionalModulesParameter() );", "+        addArgument( cmd, getDefinitionsParameter() );", "+        addArgument( cmd, getDebugParameter() );", "+        addArgument( cmd, getDocFileParameter() );", "+        addArgument( cmd, getIncrementalParameter() );", "+        addArgument( cmd, getMainClassParameter() );", "+        addArgument( cmd, getOptimizeParameter() );", "+        addArgument( cmd, getReferencesParameter() );", "+        addArgument( cmd, getTargetTypeParameter() );", "+        addArgument( cmd, getUnsafeParameter() );", "+        addArgument( cmd, getWarnLevelParameter() );", "+        addArgument( cmd, getWin32IconParameter() );", "+        addArgument( cmd, getOutputFileParameter() );", "+        addArgument( cmd, getIncludeDefaultReferencesParameter() );", "+        addArgument( cmd, getDefaultReferenceParameter() );", "+        addArgument( cmd, getWin32ResParameter() );", "+        addArgument( cmd, getUtf8OutpuParameter() );", "+        addArgument( cmd, getFullPathsParameter() );", "+        addArgument( cmd, getExtraOptionsParameter() );", "-        DirectoryScanner scanner = super.getDirectoryScanner( _srcDir );", "-        String[] dependencies = scanner.getIncludedFiles();", "-        getLogger().info( \"compiling \" + dependencies.length + \" file\" + ( ( dependencies.length == 1 ) ? \"\" : \"s\" ) );", "-        String baseDir = scanner.getBasedir().toString();", "+        final DirectoryScanner scanner = super.getDirectoryScanner( m_srcDir );", "+        final String[] dependencies = scanner.getIncludedFiles();", "+        final String message = \"compiling \" + dependencies.length + \" file\" +", "+            ( ( dependencies.length == 1 ) ? \"\" : \"s\" );", "+        getLogger().info( message );", "+        final String baseDir = scanner.getBasedir().toString();", "-            String targetFile = dependencies[ i ];", "-            targetFile = baseDir + File.separator + targetFile;", "-            command.addArgument( targetFile );", "+            final String targetFile = baseDir + File.separator + dependencies[ i ];", "+            addArgument( cmd, targetFile );", "-        command.runCommand();", "+        exe.execute();"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "c85feb95ad5222a25a9d68b1af7a2c54", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "proposal/myrmidon/src/todo/org/apache/tools/ant/taskdefs/optional/dotnet/CSharp.java", "commitBeforeChange": "919e3c42b4f5fe58f906c93171d446e5cda882e0", "commitAfterChange": "9e8e57522752c19d172b764350480e0d7b69c112", "methodNumberBeforeChange": 34, "methodNumberAfterChange": 22, "signatureBeforeChange": "     public void execute()         throws TaskException", "signatureAfterChange": "     public void execute()         throws TaskException", "diff": ["-        if( _srcDir == null )", "+        if( null == m_srcDir )", "-            _srcDir = getBaseDirectory();", "+            m_srcDir = getBaseDirectory();", "-        NetCommand command = new NetCommand( this, \"CSC\", csc_exe_name );", "-        command.setFailOnError( getFailFailOnError() );", "-        //DEBUG helper", "-        command.setTraceCommandLine( true );", "-        //fill in args", "-        command.addArgument( \"/nologo\" );", "-        command.addArgument( getAdditionalModulesParameter() );", "-        command.addArgument( getDefinitionsParameter() );", "-        command.addArgument( getDebugParameter() );", "-        command.addArgument( getDocFileParameter() );", "-        command.addArgument( getIncrementalParameter() );", "-        command.addArgument( getMainClassParameter() );", "-        command.addArgument( getOptimizeParameter() );", "-        command.addArgument( getReferencesParameter() );", "-        command.addArgument( getTargetTypeParameter() );", "-        command.addArgument( getUnsafeParameter() );", "-        command.addArgument( getWarnLevelParameter() );", "-        command.addArgument( getWin32IconParameter() );", "-        command.addArgument( getOutputFileParameter() );", "-        command.addArgument( getIncludeDefaultReferencesParameter() );", "-        command.addArgument( getDefaultReferenceParameter() );", "-        command.addArgument( getWin32ResParameter() );", "-        command.addArgument( getUtf8OutpuParameter() );", "-        command.addArgument( getNoConfigParameter() );", "-        command.addArgument( getFullPathsParameter() );", "-        command.addArgument( getExtraOptionsParameter() );", "+        final ExecManager execManager = (ExecManager)getService( ExecManager.class );", "+        final Execute exe = new Execute( execManager );", "+        exe.setReturnCode( 0 );", "+", "+        final Commandline cmd = exe.getCommandline();", "+        cmd.setExecutable( EXE_NAME );", "+", "+        addArgument( cmd, \"/nologo\" );", "+        addArgument( cmd, getAdditionalModulesParameter() );", "+        addArgument( cmd, getDefinitionsParameter() );", "+        addArgument( cmd, getDebugParameter() );", "+        addArgument( cmd, getDocFileParameter() );", "+        addArgument( cmd, getIncrementalParameter() );", "+        addArgument( cmd, getMainClassParameter() );", "+        addArgument( cmd, getOptimizeParameter() );", "+        addArgument( cmd, getReferencesParameter() );", "+        addArgument( cmd, getTargetTypeParameter() );", "+        addArgument( cmd, getUnsafeParameter() );", "+        addArgument( cmd, getWarnLevelParameter() );", "+        addArgument( cmd, getWin32IconParameter() );", "+        addArgument( cmd, getOutputFileParameter() );", "+        addArgument( cmd, getIncludeDefaultReferencesParameter() );", "+        addArgument( cmd, getDefaultReferenceParameter() );", "+        addArgument( cmd, getWin32ResParameter() );", "+        addArgument( cmd, getUtf8OutpuParameter() );", "+        addArgument( cmd, getFullPathsParameter() );", "+        addArgument( cmd, getExtraOptionsParameter() );", "-        DirectoryScanner scanner = super.getDirectoryScanner( _srcDir );", "-        String[] dependencies = scanner.getIncludedFiles();", "-        getLogger().info( \"compiling \" + dependencies.length + \" file\" + ( ( dependencies.length == 1 ) ? \"\" : \"s\" ) );", "-        String baseDir = scanner.getBasedir().toString();", "+        final DirectoryScanner scanner = super.getDirectoryScanner( m_srcDir );", "+        final String[] dependencies = scanner.getIncludedFiles();", "+        final String message = \"compiling \" + dependencies.length + \" file\" +", "+            ( ( dependencies.length == 1 ) ? \"\" : \"s\" );", "+        getLogger().info( message );", "+        final String baseDir = scanner.getBasedir().toString();", "-            String targetFile = dependencies[ i ];", "-            targetFile = baseDir + File.separator + targetFile;", "-            command.addArgument( targetFile );", "+            final String targetFile = baseDir + File.separator + dependencies[ i ];", "+            addArgument( cmd, targetFile );", "-        command.runCommand();", "+        exe.execute();"]}]}