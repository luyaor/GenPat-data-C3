{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "968bbdbf967453cc69c4772442980021", "detectedBy": ["AST_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "39983d4331c0f3745d24accc2dbeb4f0", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/ant/taskdefs/email/EmailTask.java", "commitBeforeChange": "de47901582d1675358fd4b55e68c0fdc241dfd53", "commitAfterChange": "b5b99c769a21d3602ee35948cf004925f03464ba", "methodNumberBeforeChange": 22, "methodNumberAfterChange": 22, "signatureBeforeChange": "     public void execute()", "signatureAfterChange": "     public void execute()", "diff": ["+        Message savedMessage = message;", "+        Vector savedFiles = (Vector) files.clone();", "-            if( encoding.equals( MIME ) || ( encoding.equals( AUTO ) && !autoFound ) )", "+            if( encoding.equals( MIME ) ", "+                || ( encoding.equals( AUTO ) && !autoFound ) )", "-                    mailer = (Mailer)Class.forName( \"org.apache.tools.ant.taskdefs.email.MimeMailer\" ).newInstance();", "+                    mailer = ", "+                        (Mailer) Class.forName( \"org.apache.tools.ant.taskdefs.email.MimeMailer\" )", "+                        .newInstance();", "-            if( encoding.equals( UU ) || ( encoding.equals( AUTO ) && !autoFound ) )", "+            if( encoding.equals( UU ) ", "+                || ( encoding.equals( AUTO ) && !autoFound ) )", "-                    mailer = (Mailer)Class.forName( \"org.apache.tools.ant.taskdefs.email.UUMailer\" ).newInstance();", "+                    mailer = ", "+                        (Mailer)Class.forName( \"org.apache.tools.ant.taskdefs.email.UUMailer\" )", "+                        .newInstance();", "-            if( encoding.equals( PLAIN ) || ( encoding.equals( AUTO ) && !autoFound ) )", "+            if( encoding.equals( PLAIN ) ", "+                || ( encoding.equals( AUTO ) && !autoFound ) )", "-                throw new BuildException( \"Failed to initialise encoding: \" + encoding );", "+                throw new BuildException( \"Failed to initialise encoding: \" ", "+                                          + encoding );", "-                throw new BuildException( \"At least one of to,cc or bcc must be supplied\" );", "+                throw new BuildException( \"At least one of to,cc or bcc must \"", "+                                          + \"be supplied\" );", "-                    throw new BuildException( \"The mime type can only be specified in one location\" );", "+                    throw new BuildException( \"The mime type can only be \"", "+                                              + \"specified in one location\" );", "-            log( \"Sent email with \" + count + \" attachment\" + ( count == 1?\"\":\"s\" ), Project.MSG_INFO );", "+            log( \"Sent email with \" + count + \" attachment\" ", "+                 + ( count == 1?\"\":\"s\" ), Project.MSG_INFO );", "+        } finally {", "+            message = savedMessage;", "+            files = savedFiles;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "68a6e7d05b32816ca5290a8e66e46ed5", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/ant/taskdefs/WaitFor.java", "commitBeforeChange": "2cd5cfabd458ab9d92e045a32d6831f72a4e2940", "commitAfterChange": "b7443f2b77a8daeba5f4b36a14ef34d1fb7fe931", "methodNumberBeforeChange": 5, "methodNumberAfterChange": 5, "signatureBeforeChange": "     public void execute() throws BuildException", "signatureAfterChange": "     public void execute() throws BuildException", "diff": ["-            throw new BuildException(\"You must not nest more than one condition into <waitfor>\");", "+            throw new BuildException(\"You must not nest more than one \"", "+                                     + \"condition into <waitfor>\");", "-            throw new BuildException(\"You must nest a condition into <waitfor>\");", "+            throw new BuildException(\"You must nest a condition into \"", "+                                     + \"<waitfor>\");", "-        maxWaitMillis *= maxWaitMultiplier;", "-        checkEveryMillis *= checkEveryMultiplier;", "-        long start = System.currentTimeMillis();", "-        long end = start + maxWaitMillis;", "+        long savedMaxWaitMillis = maxWaitMillis;", "+        long savedCheckEveryMillis = checkEveryMillis;", "+        try {", "+            maxWaitMillis *= maxWaitMultiplier;", "+            checkEveryMillis *= checkEveryMultiplier;", "+            long start = System.currentTimeMillis();", "+            long end = start + maxWaitMillis;", "-        while (System.currentTimeMillis() < end) {", "-            if (c.eval()) {", "-                return;", "+            while (System.currentTimeMillis() < end) {", "+                if (c.eval()) {", "+                    return;", "+                }", "+                try {", "+                    Thread.sleep(checkEveryMillis);", "+                } catch (InterruptedException e) {", "+                }", "-            try {", "-                Thread.sleep(checkEveryMillis);", "-            } catch (InterruptedException e) {", "-            }", "-        }", "-        if (timeoutProperty != null) {", "-            project.setNewProperty(timeoutProperty, \"true\");", "+            if (timeoutProperty != null) {", "+                project.setNewProperty(timeoutProperty, \"true\");", "+            }", "+        } finally {", "+            maxWaitMillis = savedMaxWaitMillis;", "+            checkEveryMillis = savedCheckEveryMillis;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "8046a3a97822a47793f51a4db4c31a02", "repository": "https://git-wip-us.apache.org/repos/asf/ant.git", "fileName": "src/main/org/apache/tools/ant/taskdefs/Tar.java", "commitBeforeChange": "3518a35d4755b8d411ac9b8e54ed5ab43248b2fc", "commitAfterChange": "7efc06af49ac85c35b17dff638c8f28ca73eba78", "methodNumberBeforeChange": 6, "methodNumberAfterChange": 6, "signatureBeforeChange": "      public void execute() throws BuildException", "signatureAfterChange": "      public void execute() throws BuildException", "diff": ["-        if (baseDir != null) {", "-            if (!baseDir.exists()) {", "-                throw new BuildException(\"basedir does not exist!\", location);", "-            }", "-", "-            // add the main fileset to the list of filesets to process.", "-            TarFileSet mainFileSet = new TarFileSet(fileset);", "-            mainFileSet.setDir(baseDir);", "-            filesets.addElement(mainFileSet);", "-        }", "-", "-        if (filesets.size() == 0) {", "-            throw new BuildException(\"You must supply either a basdir attribute or some nested filesets.\",", "-                                     location);", "-        }", "-", "-        // check if tr is out of date with respect to each", "-        // fileset", "-        boolean upToDate = true;", "-        for (Enumeration e = filesets.elements(); e.hasMoreElements();) {", "-            TarFileSet fs = (TarFileSet)e.nextElement();", "-            String[] files = fs.getFiles(project);", "-", "-            if (!archiveIsUpToDate(files)) {", "-                upToDate = false;", "-            }", "-", "-            for (int i = 0; i < files.length; ++i) {", "-                if (tarFile.equals(new File(fs.getDir(project), files[i]))) {", "-                    throw new BuildException(\"A tar file cannot include itself\", location);", "-                }", "-            }", "-        }", "-", "-        if (upToDate) {", "-            log(\"Nothing to do: \"+tarFile.getAbsolutePath()+\" is up to date.\",", "-                Project.MSG_INFO);", "-            return;", "-        }", "-", "-        log(\"Building tar: \"+ tarFile.getAbsolutePath(), Project.MSG_INFO);", "-", "-        TarOutputStream tOut = null;", "+        Vector savedFileSets = (Vector) filesets.clone();", "-            tOut = new TarOutputStream(new FileOutputStream(tarFile));", "-            tOut.setDebug(true);", "-            if (longFileMode.isTruncateMode()) {", "-                tOut.setLongFileMode(TarOutputStream.LONGFILE_TRUNCATE);", "-            }", "-            else if (longFileMode.isFailMode() ||", "-                     longFileMode.isOmitMode()) {", "-                tOut.setLongFileMode(TarOutputStream.LONGFILE_ERROR);", "-            }", "-            else {", "-                // warn or GNU", "-                tOut.setLongFileMode(TarOutputStream.LONGFILE_GNU);", "+            if (baseDir != null) {", "+                if (!baseDir.exists()) {", "+                    throw new BuildException(\"basedir does not exist!\", ", "+                                             location);", "+                }", "+", "+                // add the main fileset to the list of filesets to process.", "+                TarFileSet mainFileSet = new TarFileSet(fileset);", "+                mainFileSet.setDir(baseDir);", "+                filesets.addElement(mainFileSet);", "-            longWarningGiven = false;", "+            if (filesets.size() == 0) {", "+                throw new BuildException(\"You must supply either a basedir \"", "+                                         + \"attribute or some nested filesets.\",", "+                                         location);", "+            }", "+            ", "+            // check if tar is out of date with respect to each", "+            // fileset", "+            boolean upToDate = true;", "-                if (files.length > 1 && fs.getFullpath().length() > 0) {", "-                    throw new BuildException(\"fullpath attribute may only be specified for \" +", "-                                             \"filesets that specify a single file.\");", "+", "+                if (!archiveIsUpToDate(files)) {", "+                    upToDate = false;", "-                for (int i = 0; i < files.length; i++) {", "-                    File f = new File(fs.getDir(project), files[i]);", "-                    String name = files[i].replace(File.separatorChar,'/');", "-                    tarFile(f, tOut, name, fs);", "+", "+                for (int i = 0; i < files.length; ++i) {", "+                    if (tarFile.equals(new File(fs.getDir(project), ", "+                                                files[i]))) {", "+                        throw new BuildException(\"A tar file cannot include \"", "+                                                 + \"itself\", location);", "+                    }", "-        } catch (IOException ioe) {", "-            String msg = \"Problem creating TAR: \" + ioe.getMessage();", "-            throw new BuildException(msg, ioe, location);", "+", "+            if (upToDate) {", "+                log(\"Nothing to do: \"+tarFile.getAbsolutePath()", "+                    +\" is up to date.\", Project.MSG_INFO);", "+                return;", "+            }", "+", "+            log(\"Building tar: \"+ tarFile.getAbsolutePath(), Project.MSG_INFO);", "+", "+            TarOutputStream tOut = null;", "+            try {", "+                tOut = new TarOutputStream(new FileOutputStream(tarFile));", "+                tOut.setDebug(true);", "+                if (longFileMode.isTruncateMode()) {", "+                    tOut.setLongFileMode(TarOutputStream.LONGFILE_TRUNCATE);", "+                }", "+                else if (longFileMode.isFailMode() ||", "+                         longFileMode.isOmitMode()) {", "+                    tOut.setLongFileMode(TarOutputStream.LONGFILE_ERROR);", "+                }", "+                else {", "+                    // warn or GNU", "+                    tOut.setLongFileMode(TarOutputStream.LONGFILE_GNU);", "+                }", "+", "+                longWarningGiven = false;", "+                for (Enumeration e = filesets.elements(); ", "+                     e.hasMoreElements();) {", "+                    TarFileSet fs = (TarFileSet)e.nextElement();", "+                    String[] files = fs.getFiles(project);", "+                    if (files.length > 1 && fs.getFullpath().length() > 0) {", "+                        throw new BuildException(\"fullpath attribute may only \"", "+                                                 + \"be specified for \" ", "+                                                 + \"filesets that specify a \"", "+                                                 + \"single file.\");", "+                    }", "+                    for (int i = 0; i < files.length; i++) {", "+                        File f = new File(fs.getDir(project), files[i]);", "+                        String name = files[i].replace(File.separatorChar,'/');", "+                        tarFile(f, tOut, name, fs);", "+                    }", "+                }", "+            } catch (IOException ioe) {", "+                String msg = \"Problem creating TAR: \" + ioe.getMessage();", "+                throw new BuildException(msg, ioe, location);", "+            } finally {", "+                if (tOut != null) {", "+                    try {", "+                        // close up", "+                        tOut.close();", "+                    }", "+                    catch (IOException e) {}", "+                }", "+            }", "-            if (tOut != null) {", "-                try {", "-                    // close up", "-                    tOut.close();", "-                }", "-                catch (IOException e) {}", "-            }", "+            filesets = savedFileSets;"]}]}