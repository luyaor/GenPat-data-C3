{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "8b5b782f773f3bd806c26d3f5ac1b416", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "3cc67c4bf70496722dc862782b7781ad", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/definitions/DefinitionsDocument.java", "commitBeforeChange": "4128354c8729a4a5df76a578d72103228145ae8d", "commitAfterChange": "aa287bbb1c9881659edc121fbb5e7531149b5808", "methodNumberBeforeChange": 24, "methodNumberAfterChange": 54, "signatureBeforeChange": "   protected void _storeInCache(String key, Object result)", "signatureAfterChange": "      protected void endCompoundEdit(int key)", "diff": ["-   */", "-  protected void _storeInCache(String key, Object result) {", "-    throwErrorHuh();", "-    _cacheInUse = true;", "-", "-    // Prevent going over max size", "-    if (_helperCache.size() >= MAX_CACHE_SIZE) {", "-      if (_helperCacheHistory.size() > 0) {", "-        _helperCache.remove( _helperCacheHistory.get(0) );", "-        _helperCacheHistory.remove(0);", "-      }", "-      else {", "-        // Shouldn't happen", "-        throw new RuntimeException(\"Cache larger than cache history!\");", "-      }", "-    }", "-    Object prev = _helperCache.put(key, result);", "-    // Add to history if the insert increased the size of the table", "-    if (prev == null) {", "-      _helperCacheHistory.add(key);", "-    }", "-", "-    /*", "-    long end = System.currentTimeMillis();", "-    Long start = (Long)_helperCache.get(key+\"|time\");", "-    if (start != null) {", "-      _helperCache.remove(key+\"|time\");", "-      long delay = end - start.longValue();", "-      if (delay > maxHelpDelay) {", "-        maxHelpDelay = delay;", "-        maxKey = key;", "-        //DrJava.consoleOut().println(\"   Longest: \" + maxHelpDelay + \"ms from \" + maxKey +", "-        //                            \", line \" + getCurrentLine());", "-      }", "-    }", "-    else {", "-      DrJava.consoleOut().println(\"  CACHE MISS: \" + key);", "-    }", "-    */", "-  }", "+  ", "+  protected void endCompoundEdit(int key) {", "+    _undoManager.endCompoundEdit(key);", "+  }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "f6a3bb62ebfcd7f9be44e30beac312fe", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/AbstractDJDocument.java", "commitBeforeChange": "69d4590eff40914052a36cc82d8a74c43211028e", "commitAfterChange": "46bddad84804814dd0241cc4f939b2c8bb524e79", "methodNumberBeforeChange": 34, "methodNumberAfterChange": 37, "signatureBeforeChange": "   protected void _storeInCache(String key, Object result)", "signatureAfterChange": "   protected void _storeInCache(String key, Object result)", "diff": ["-    throwErrorHuh();", "-    _cacheInUse = true;", "-    ", "-    // Prevent going over max size", "-    if (_helperCache.size() >= MAX_CACHE_SIZE) {", "-      if (_helperCacheHistory.size() > 0) {", "-        _helperCache.remove( _helperCacheHistory.get(0) );", "-        _helperCacheHistory.remove(0);", "+    // throwErrorHuh();", "+    synchronized (_helperCache) {", "+      ", "+      _cacheInUse = true;", "+      ", "+      // Prevent going over max size", "+      if (_helperCache.size() >= MAX_CACHE_SIZE) {", "+        if (_helperCacheHistory.size() > 0) {", "+          _helperCache.remove( _helperCacheHistory.get(0) );", "+          _helperCacheHistory.remove(0);", "+        }", "+        else {", "+          // Shouldn't happen", "+          throw new RuntimeException(\"Cache larger than cache history!\");", "+        }", "-      else {", "-        // Shouldn't happen", "-        throw new RuntimeException(\"Cache larger than cache history!\");", "+      Object prev = _helperCache.put(key, result);", "+      // Add to history if the insert increased the size of the table", "+      if (prev == null) {", "+        _helperCacheHistory.add(key);", "-    Object prev = _helperCache.put(key, result);", "-    // Add to history if the insert increased the size of the table", "-    if (prev == null) {", "-      _helperCacheHistory.add(key);", "-    }", "-    ", "-    /*", "-     long end = System.currentTimeMillis();", "-     Long start = (Long)_helperCache.get(key+\"|time\");", "-     if (start != null) {", "-     _helperCache.remove(key+\"|time\");", "-     long delay = end - start.longValue();", "-     if (delay > maxHelpDelay) {", "-     maxHelpDelay = delay;", "-     maxKey = key;", "-     //DrJava.consoleOut().println(\"   Longest: \" + maxHelpDelay + \"ms from \" + maxKey +", "-     //                            \", line \" + getCurrentLine());", "-     }", "-     }", "-     else {", "-     DrJava.consoleOut().println(\"  CACHE MISS: \" + key);", "-     }", "-     */", "-  }"]}], "num": 21990}