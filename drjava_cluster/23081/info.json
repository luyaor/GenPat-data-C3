{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "c8b5700021f43355cfb5c1ead0ba1ab6", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "6b413c864140b46d02585293b7e749a8", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/util/swing/FindReplaceMachine.java", "commitBeforeChange": "a2b28a9213fa3cc634db7fda88e14ebb0a103974", "commitAfterChange": "56df485f00337d373f1f0b94fc58f7c7b8b714d4", "methodNumberBeforeChange": 22, "methodNumberAfterChange": 23, "signatureBeforeChange": "   public boolean replaceCurrent()", "signatureAfterChange": "     public boolean replaceCurrent()", "diff": ["+    */", "+    public boolean replaceCurrent() {", "+        return _state.replaceCurrent();", "-  */", "-  public boolean replaceCurrent() {", "-    try {", "-      if (isOnMatch()) {", "-        boolean atStart = false;", "-        int position = getCurrentOffset();", "-        if(!_searchBackwards) {", "-          position -= _findWord.length();", "-        }", "-        _doc.remove(position, _findWord.length());", "-        if (position == 0){", "-          atStart = true;", "-        }", "-        _doc.insertString(getCurrentOffset(), _replaceWord, null);", "-", "-        // the current offset will be the end of the inserted word", "-        //since we keep track of current as a Position.", "-        //The exception is if we are at the beginning of the document,", "-        //in which case the text is inserted AFTER the current position", "-        //So, current offset is correct for forwards searching unless", "-        //we were at the start of the document, in which case it is", "-        //correct for backwards searching.", "-        if(atStart && !_searchBackwards) {", "-          setPosition(_replaceWord.length());", "-        }", "-        if(!atStart && _searchBackwards){", "-          setPosition(getCurrentOffset() - _replaceWord.length());", "-        }", "-", "-        return true;", "-      }", "-      else {", "-        return false;", "-      }", "-    catch (BadLocationException e) {", "-      throw new UnexpectedException(e);", "-    }", "-  }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "7b85196820f57348ba5038aaf8033bc7", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/util/swing/FindReplaceMachine.java", "commitBeforeChange": "cd663e9bf0c95c5bb5b12db38fbcd366660d665e", "commitAfterChange": "22cb21cbc806aa257284ccfb5bed593a93cc9671", "methodNumberBeforeChange": 14, "methodNumberAfterChange": 16, "signatureBeforeChange": "   public boolean replaceCurrent()", "signatureAfterChange": "   public boolean replaceCurrent()", "diff": ["-        _doc.remove(getCurrentOffset() - _findWord.length(),", "-                    _findWord.length());", "-        // the current offset will be correct since we keep track", "-        // of it as a Position.", "+        boolean atStart = false;", "+        int position = getCurrentOffset();", "+        if(!_searchBackwards) {", "+          position -= _findWord.length();", "+        }", "+        _doc.remove(position, _findWord.length());", "+        if (position == 0){", "+          atStart = true;", "+        }", "+", "+        // the current offset will be the end of the inserted word", "+        //since we keep track of current as a Position.", "+        //The exception is if we are at the beginning of the document,", "+        //in which case the text is inserted AFTER the current position", "+        //So, current offset is correct for forwards searching unless", "+        //we were at the start of the document, in which case it is", "+        //correct for backwards searching.", "+        if(atStart && !_searchBackwards) {", "+          setPosition(_replaceWord.length());", "+        }", "+        if(!atStart && _searchBackwards){", "+          setPosition(getCurrentOffset() - _replaceWord.length());", "+        }", "+"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "b717ea4eb98a4e474fe1cf35c6a17eed", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/util/swing/FindReplaceMachine.java", "commitBeforeChange": "37e723fa34df1bc3afa5f0896241b32a56e4dde5", "commitAfterChange": "46e11d94aab488b0f851c712b65caea9a087e829", "methodNumberBeforeChange": 23, "methodNumberAfterChange": 23, "signatureBeforeChange": "     public boolean replaceCurrent()", "signatureAfterChange": "   public boolean replaceCurrent()", "diff": ["-    /** If we're on a match for the find word, replace it with the replace word. */", "-    public boolean replaceCurrent() { return _state.replaceCurrent(); }", "+  /** If we're on a match for the find word, replace it with the replace word. */", "+  public boolean replaceCurrent() {", "+    _doc.acquireWriteLock();", "+    try {", "+      if (isOnMatch()) {", "+        boolean atStart = false;", "+        int position = getCurrentOffset();", "+        if (!_searchBackwards) position -= _findWord.length();", "+        _doc.remove(position, _findWord.length());", "+        if (position == 0) atStart = true;", "+        _doc.insertString(getCurrentOffset(), _replaceWord, null);", "+        // the current offset will be the end of the inserted word", "+        //since we keep track of current as a Position.", "+        //The exception is if we are at the beginning of the document,", "+        //in which case the text is inserted AFTER the current position", "+        //So, current offset is correct for forwards searching unless", "+        //we were at the start of the document, in which case it is", "+        //correct for backwards searching.", "+        if (atStart && !_searchBackwards) setPosition(_replaceWord.length());", "+        else if (!atStart && _searchBackwards) setPosition(getCurrentOffset() - _replaceWord.length());", "+", "+        return true;", "+      }", "+      return false;", "+    }", "+    catch (BadLocationException e) { throw new UnexpectedException(e); }", "+    finally { _doc.releaseWriteLock(); }", "+  }"]}], "num": 23081}