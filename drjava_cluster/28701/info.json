{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "954d8f63845183fa2ecc1140e8b75e3f", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "0d91c96b699a03240beca1755845378c", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/definitions/DefinitionsDocument.java", "commitBeforeChange": "6d55d86705248616cac5b324a7c528485ceb6104", "commitAfterChange": "d9483f6c228cd09f3431ad6b50a3d96bdaf83832", "methodNumberBeforeChange": 56, "methodNumberAfterChange": 56, "signatureBeforeChange": "   public synchronized void setWrappedPositionOffsets(WeakHashMap<WrappedPosition, Integer> whm) throws BadLocationException", "signatureAfterChange": "   public void setWrappedPositionOffsets(WeakHashMap<WrappedPosition, Integer> whm) throws BadLocationException", "diff": ["-   */", "-  public synchronized void setWrappedPositionOffsets(WeakHashMap<WrappedPosition, Integer> whm) throws BadLocationException {", "-    if (_wrappedPosList==null) { _wrappedPosList = new LinkedList<WeakReference<WrappedPosition>>(); }", "-    _wrappedPosList.clear();", "-    ", "-    for(Map.Entry<WrappedPosition, Integer> entry: whm.entrySet()) {", "-      if (entry.getKey()!=null) {", "-        // hasn't been garbage-collected yet", "-        WrappedPosition wp = entry.getKey();", "-        wp.setWrapped(super.createPosition(entry.getValue()));", "-        _wrappedPosList.add(new WeakReference<WrappedPosition>(wp));", "+    */", "+  public void setWrappedPositionOffsets(WeakHashMap<WrappedPosition, Integer> whm) throws BadLocationException {", "+    synchronized(_wrappedPosListLock) {", "+      if (_wrappedPosList == null) { _wrappedPosList = new LinkedList<WeakReference<WrappedPosition>>(); }", "+      _wrappedPosList.clear();", "+      ", "+      for(Map.Entry<WrappedPosition, Integer> entry: whm.entrySet()) {", "+        if (entry.getKey() != null) {", "+          // hasn't been garbage-collected yet", "+          WrappedPosition wp = entry.getKey();", "+          wp.setWrapped(createPosition(entry.getValue()));", "+          _wrappedPosList.add(new WeakReference<WrappedPosition>(wp));", "+        }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "b19c876d56192fb94ffbfc07fb227610", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/definitions/DefinitionsDocument.java", "commitBeforeChange": "6d55d86705248616cac5b324a7c528485ceb6104", "commitAfterChange": "d9483f6c228cd09f3431ad6b50a3d96bdaf83832", "methodNumberBeforeChange": 55, "methodNumberAfterChange": 55, "signatureBeforeChange": "   public synchronized WeakHashMap<WrappedPosition, Integer> getWrappedPositionOffsets()", "signatureAfterChange": "   public WeakHashMap<WrappedPosition, Integer> getWrappedPositionOffsets()", "diff": ["-   */", "-  public synchronized WeakHashMap<WrappedPosition, Integer> getWrappedPositionOffsets() {", "+    */", "+  public WeakHashMap<WrappedPosition, Integer> getWrappedPositionOffsets() {", "-    if (_wrappedPosList==null) { _wrappedPosList = new LinkedList<WeakReference<WrappedPosition>>(); }", "-    WeakHashMap<WrappedPosition, Integer> ret = new WeakHashMap<WrappedPosition, Integer>(_wrappedPosList.size());", "-    ", "-    for (WeakReference<WrappedPosition> wr: _wrappedPosList) {", "-      if (wr.get()!=null)  {", "-        // hasn't been garbage-collected yet", "-        newList.add(wr);", "-        ret.put(wr.get(), wr.get().getOffset());", "+    synchronized(_wrappedPosListLock) {", "+      if (_wrappedPosList == null) { _wrappedPosList = new LinkedList<WeakReference<WrappedPosition>>(); }", "+      WeakHashMap<WrappedPosition, Integer> ret = new WeakHashMap<WrappedPosition, Integer>(_wrappedPosList.size());", "+      ", "+      for (WeakReference<WrappedPosition> wr: _wrappedPosList) {", "+        if (wr.get() != null)  {", "+          // hasn't been garbage-collected yet", "+          newList.add(wr);", "+          ret.put(wr.get(), wr.get().getOffset());", "+        }", "-    }", "-    _wrappedPosList.clear();", "-    _wrappedPosList = newList;", "-    ", "+      _wrappedPosList.clear();", "+      _wrappedPosList = newList;  ", "+    }"]}], "num": 28701}