{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "8c6a5ff1edd0be3c505060dda8587db5", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "3a53ef860bff8ebdfa869db94ddf27ab", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/util/swing/FindReplaceMachine.java", "commitBeforeChange": "d999f0af23b00e87ee091cf6b7f8d16576621e4d", "commitAfterChange": "634bad3816e5a89c71c174f08f33c3f80727cfeb", "methodNumberBeforeChange": 25, "methodNumberAfterChange": 25, "signatureBeforeChange": "   public boolean replaceCurrent()", "signatureAfterChange": "   public boolean replaceCurrent()", "diff": ["+", "+    if (! isOnMatch()) return false;", "-      if (isOnMatch()) {", "-        boolean atStart = false;", "-        int position = getCurrentOffset();", "-        if (!_searchBackwards) position -= _findWord.length();", "-        _doc.remove(position, _findWord.length());", "-        if (position == 0) atStart = true;", "-        _doc.insertString(getCurrentOffset(), _replaceWord, null);", "-", "-        // the current offset will be the end of the inserted word", "-        //since we keep track of current as a Position.", "-        //The exception is if we are at the beginning of the document,", "-        //in which case the text is inserted AFTER the current position", "-        //So, current offset is correct for forwards searching unless", "-        //we were at the start of the document, in which case it is", "-        //correct for backwards searching.", "-        if (atStart && !_searchBackwards) setPosition(_replaceWord.length());", "-        else if (!atStart && _searchBackwards) setPosition(getCurrentOffset() - _replaceWord.length());", "-", "-        return true;", "-      }", "-      return false;", "+      boolean atStart = false;", "+      int position = getCurrentOffset();", "+      if (!_searchBackwards) position -= _findWord.length();", "+      _doc.remove(position, _findWord.length());", "+      if (position == 0) atStart = true;", "+      _doc.insertString(getCurrentOffset(), _replaceWord, null);", "+      ", "+      // the current offset will be the end of the inserted word", "+      //since we keep track of current as a Position.", "+      //The exception is if we are at the beginning of the document,", "+      //in which case the text is inserted AFTER the current position", "+      //So, current offset is correct for forwards searching unless", "+      //we were at the start of the document, in which case it is", "+      //correct for backwards searching.", "+      if (atStart && !_searchBackwards) setPosition(_replaceWord.length());", "+      else if (!atStart && _searchBackwards) setPosition(getCurrentOffset() - _replaceWord.length());", "+      ", "+      return true;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "c709044eaca99817955ff03941c1d4f2", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/FindReplaceMachine.java", "commitBeforeChange": "db8f0cb26e31432f350747ff5cceb39c84bddf2e", "commitAfterChange": "09ee5df535fa7711165b559136b85b4d08379671", "methodNumberBeforeChange": 26, "methodNumberAfterChange": 23, "signatureBeforeChange": "   public boolean replaceCurrent()", "signatureAfterChange": "   public boolean replaceCurrent()", "diff": ["-    _doc.acquireWriteLock();", "+    _doc.modifyLock();", "-      boolean atStart = false;", "-      int position = getCurrentOffset();", "-      if (!_searchBackwards) position -= _findWord.length();", "-      _doc.remove(position, _findWord.length());", "-      if (position == 0) atStart = true;", "+//      boolean atStart = false;", "+      int offset = getCurrentOffset();", "+      if (_isForward) offset -= _findWord.length();  // position is now on left edge of match", "+//      assert _findWord.equals(_doc.getText(offset, _findWord.length()));", "+      ", "+//      Utilities.show(\"ReplaceCurrent called. _doc = \" + _doc.getText() + \" offset = \" + offset + \" _findWord = \" + _findWord);", "+      ", "+      _doc.remove(offset, _findWord.length());", "+", "+//      if (position == 0) atStart = true;", "-      // The current offset will be the end of the inserted word since we keep track of current as a Position. The ", "-      // exception is if we are at the beginning of the document, in which case the text is inserted AFTER the current ", "-      // position.  So, current offset is correct for forwards searching unless we were at the start of the document, ", "-      // in which case it is correct for backwards searching.", "-      if (atStart && !_searchBackwards) setPosition(_replaceWord.length());", "-      else if (! atStart && _searchBackwards) setPosition(getCurrentOffset() - _replaceWord.length());", "+      // update _current Position", "+      if (_isForward) setPosition(offset + _replaceWord.length());", "+      else setPosition(offset);", "-    finally { _doc.releaseWriteLock(); }", "+    finally { _doc.modifyUnlock(); }"]}], "num": 6664}