{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "b3e94e0ec77d94ef057c39f205ad894e", "detectedBy": ["AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "1f6701e7ab88b38c1294ff8482ac70a6", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/JUnitPanel.java", "commitBeforeChange": "1313de8815d48e0a1c60eb5bee6900b6b7af3993", "commitAfterChange": "802c4acbf71daa5d149dbcd67d1f360241574951", "methodNumberBeforeChange": 12, "methodNumberAfterChange": 18, "signatureBeforeChange": "     public void testStarted(String name)", "signatureAfterChange": "     public synchronized void testStarted(String name)", "diff": ["-    public void testStarted(String name) {", "-//      Document doc = getDocument();", "-//      try {", "-//        doc.insertString(doc.getLength(),", "-//                         \"  \" + name,", "-//                         NORMAL_ATTRIBUTES);", "-//      }", "-//      catch (BadLocationException ble) {", "-//        // Inserting at end, shouldn't happen", "-//        throw new UnexpectedException(ble);", "-//      }", "+    public synchronized void testStarted(String name) {", "+      String testName = _getTestFromName(name);", "+      String className = _getClassFromName(name);", "+      String fullName = className + \".\" + testName;", "+      if (fullName.equals(JUNIT_WARNING)) {", "+        return;", "+      }", "+      Document doc = getDocument();", "+      int index = doc.getLength();", "+      ", "+      try {", "+        // Insert the classname if it has changed", "+        if (!className.equals(_runningTestName)) {", "+          _runningTestName = className;", "+          doc.insertString(index, \"  \" + className + \"\\n\", NORMAL_ATTRIBUTES);", "+          index = doc.getLength();", "+        }", "+        ", "+        // Insert the test name, remembering its position", "+        doc.insertString(index, \"    \", NORMAL_ATTRIBUTES);", "+        index = doc.getLength();", "+        doc.insertString(index, testName + \"\\n\", NORMAL_ATTRIBUTES);", "+        Position pos = doc.createPosition(index);", "+        _runningTestNamePositions.put(fullName, pos);", "+        setCaretPosition(index);", "+      }", "+      catch (BadLocationException ble) {", "+        // Inserting at end, shouldn't happen", "+        throw new UnexpectedException(ble);", "+      }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "f1811a4947333e1f0234169c5284cea3", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/JUnitPanel.java", "commitBeforeChange": "1313de8815d48e0a1c60eb5bee6900b6b7af3993", "commitAfterChange": "802c4acbf71daa5d149dbcd67d1f360241574951", "methodNumberBeforeChange": 13, "methodNumberAfterChange": 19, "signatureBeforeChange": "     public void testEnded(String name, boolean wasSuccessful, boolean causedError)", "signatureAfterChange": "     public synchronized void testEnded(String name, boolean wasSuccessful, boolean causedError)", "diff": ["-    public void testEnded(String name, boolean wasSuccessful, boolean causedError) {", "-//      Document doc = getDocument();", "-//      String status = \"ok\";", "-//      if (!wasSuccessful) {", "-//        status = (causedError) ? \"error\" : \"failed\";", "-//      }", "-//      try {", "-//        doc.insertString(doc.getLength(),", "-//                         \"  [\" + status + \"]\\n\",", "-//                         NORMAL_ATTRIBUTES);", "-//      }", "-//      catch (BadLocationException ble) {", "-//        // Inserting at end, shouldn't happen", "-//        throw new UnexpectedException(ble);", "-//      }", "+    public synchronized void testEnded(String name, boolean wasSuccessful, boolean causedError) {", "+      String testName = _getTestFromName(name);", "+      String fullName = _getClassFromName(name) + \".\" + testName;", "+      if (fullName.equals(JUNIT_WARNING)) {", "+        return;", "+      }", "+      Document doc = getDocument();", "+      Position namePos = _runningTestNamePositions.get(fullName);", "+      AttributeSet set;", "+      if (!wasSuccessful || causedError) {", "+        set = TEST_FAIL_ATTRIBUTES;", "+      }", "+      else {", "+        set = TEST_PASS_ATTRIBUTES;", "+      }", "+      if (namePos != null) {", "+        int index = namePos.getOffset();", "+        int length = testName.length();", "+        if (doc instanceof StyledDocument) {", "+          ((StyledDocument)doc).setCharacterAttributes(index, length, set, false);", "+        }", "+      }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "face165e5107216463a9f396b214060b", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/AbstractGlobalModel.java", "commitBeforeChange": "e97d669e5368c283be3ec2a94ca1c792daab5138", "commitAfterChange": "d75bb4144501a8419376e0dc8dbe054c7511983f", "methodNumberBeforeChange": 306, "methodNumberAfterChange": 305, "signatureBeforeChange": "     public File getSourceRoot() throws InvalidPackageException", "signatureAfterChange": "     public File getSourceRoot() throws InvalidPackageException", "diff": ["-    public File getSourceRoot() throws InvalidPackageException { return _getSourceRoot(_packageName); }", "+    public File getSourceRoot() throws InvalidPackageException { ", "+      if (isUntitled())", "+        throw new InvalidPackageException(-1, \"Can not get source root for unsaved file. Please save.\");", "+      ", "+      try {", "+        String[] packages = _packageName.split(\"\\\\.\");", "+        if (packages.length == 1 && packages[0].equals(\"\")) {", "+          packages = new String[0]; // split should do this, but it doesn't", "+        }", "+        File dir = getFile().getParentFile();", "+        for (String p : IterUtil.reverse(IterUtil.asIterable(packages))) {", "+          if (dir == null || !dir.getName().equals(p)) {", "+            String m = \"File is in the wrong directory or is declared part of the wrong package.  \" +", "+            \"Directory name \" + ((dir == null) ? \"(root)\" : \"'\" + dir.getName() + \"'\") +", "+            \" does not match package name '\" + p + \"'.\";", "+            throw new InvalidPackageException(-1, m);", "+          }", "+          dir = dir.getParentFile();", "+        }", "+        if (dir == null) {", "+          // should not happen in typical cases -- requires the first package name to match the root's name,", "+          // which is usually not a valid identifier (like \"\" or \"C:\")", "+          throw new InvalidPackageException(-1, \"File is in a directory tree with a null root\");", "+        }", "+        return dir;", "+      }", "+      catch (FileMovedException fme) {", "+        throw new", "+          InvalidPackageException(-1, \"File has been moved or deleted from its previous location. Please save.\");", "+      }", "+    }"]}], "num": 10852}