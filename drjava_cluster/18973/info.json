{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "f79944d9404257d9e100f879cccf07aa", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "1defb16bbd2653d95ff9b70b6e5e76ef", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/DefaultSingleDisplayModel.java", "commitBeforeChange": "7d20b14faca1d500f599ed54f40d60f42cf8097e", "commitAfterChange": "78f246144dd1abf21f8f40c370cff42a944129aa", "methodNumberBeforeChange": 17, "methodNumberAfterChange": 17, "signatureBeforeChange": "   public boolean closeAllFiles()", "signatureAfterChange": "   public boolean closeAllFiles()", "diff": ["-    boolean success = super.closeAllFiles();", "+    //Bug when the first document, in list view, is selected:", "+    //When \"close all\" documents is selected, each document in turn is set active", "+    //Workaround: begin to close the active document, then close all other documents, then remove the ", "+    //active doc from the navigator pane", "+    final OpenDefinitionsDocument toClose = getActiveDocument();", "+    boolean canClose = toClose.canAbandonFile();", "+    if(canClose) {", "+      INavigatorItem idoc = _documentsRepos.removeKey(toClose);      ", "+      boolean success = super.closeAllFiles();", "+      if (idoc != null) {", "+        getDocumentNavigator().removeDocument(idoc);", "+        _notifier.fileClosed(toClose);", "+        toClose.close();", "+      }", "+      _isClosingAllDocs = false;", "+      ", "+      _ensureNotEmpty();", "+      setActiveFirstDocument();", "+      return success;", "+    }", "-    ", "-    _ensureNotEmpty();", "-    setActiveFirstDocument();", "-    return success;", "+    return false; ", "+  }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "a137531aad1f9cec61d9f66e49547c4a", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/DefaultSingleDisplayModel.java", "commitBeforeChange": "ce392e05d418567d3a904ab1014f959de3b94789", "commitAfterChange": "015a587e3c75bdcf4fec55c8e43c23b1966c68b5", "methodNumberBeforeChange": 20, "methodNumberAfterChange": 20, "signatureBeforeChange": "   public boolean closeAllFiles()", "signatureAfterChange": "   public boolean closeAllFiles()", "diff": ["-    //Bug when the first document, in list view, is selected:", "-    //When \"close all\" documents is selected, each document in turn is set active", "-    //Workaround: begin to close the active document, then close all other documents, then remove the ", "-    //active doc from the navigator pane", "-    final OpenDefinitionsDocument toClose = getActiveDocument();", "-    boolean canClose = toClose.canAbandonFile();", "-    if(canClose) {", "-      INavigatorItem idoc = _documentsRepos.removeKey(toClose);      ", "-      boolean success = super.closeAllFiles();", "-      if (idoc != null) {", "-        getDocumentNavigator().removeDocument(idoc);", "-        _notifier.fileClosed(toClose);", "-        toClose.close();", "+    ", "+    List<OpenDefinitionsDocument> docs = getDefinitionsDocuments();", "+    OpenDefinitionsDocument active = getActiveDocument();", "+    boolean keepClosing = true;", "+    for(OpenDefinitionsDocument d: docs){", "+      if(d != active && keepClosing){", "+        keepClosing = closeFile(d);", "-      _isClosingAllDocs = false;", "-      ", "-      _ensureNotEmpty();", "-      setActiveFirstDocument();", "-      return success;", "+    }", "+    if(keepClosing){", "+      closeFile(active);", "-    return false; ", "+    _ensureNotEmpty();", "+    setActiveFirstDocument();", "+    return keepClosing;"]}], "num": 18973}