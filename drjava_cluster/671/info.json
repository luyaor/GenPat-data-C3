{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "ed5c5e11cc0399374f091daf11cdbdd4", "detectedBy": ["AST_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "2f3175efd18dbb7b614e86b058076aa2", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/GlobalModelJUnitTest.java", "commitBeforeChange": "fe10ec3049d7833e404492f382e59e4a2bb44b0e", "commitAfterChange": "ac147bfd47d7e558bfd3f0afa39ad091a35b6f6f", "methodNumberBeforeChange": 15, "methodNumberAfterChange": 17, "signatureBeforeChange": "   public void testUnsavedAndUnCompiledChanges() throws Exception", "signatureAfterChange": "   public void testUnsavedAndUnCompiledChanges() throws Exception", "diff": ["-    if (printMessages) System.out.println(\"----testUnsavedAndUnCompiledChanges-----\");", "+    if (printMessages) System.out.println(\"-----testUnsavedAndUnCompiledChanges-----\");", "-    JUnitTestListener listener = new JUnitTestListener(true);", "+    ", "+    List<OpenDefinitionsDocument> docs = _model.getOpenDefinitionsDocuments();", "+    ", "+    OpenDefinitionsDocument untitled = docs.get(0);", "+    ", "+    System.out.println(\"Untitled file is named: \" + untitled.getName());", "+    ", "+    _model.closeFileOnQuitHelper(untitled);", "+    ", "+    // set up test listener for compile command; automatically checks that compilation is performed", "+    JUnitTestListener listener = new JUnitCompileBeforeTestListener();", "-    if (printMessages) System.out.println(\"before compile\");", "+    ", "-    if (printMessages) System.out.println(\"after compile\");", "-    changeDocumentText(MONKEYTEST_FAIL_TEXT, doc);", "-    if (printMessages) System.out.println(\"after document change\");", "+    ", "+//    System.err.println(\"Ordinary compile completed\");", "+    ", "+    listener.resetCompileCounts();", "+    ", "+    changeDocumentText(MONKEYTEST_PASS_ALT_TEXT, doc);", "+//    System.err.println(\"document changed; modifiedSinceSave = \" + doc.isModifiedSinceSave());", "+    ", "+//    System.err.println(\"JUnit completed\");", "+    ", "+    /* Unsaved document forces both saveBeforeCompile and compileBeforeTest */", "+    ", "+    listener.assertSaveBeforeCompileCount(1);", "+    listener.assertCompileBeforeJUnitCount(1);", "+    listener.assertNonTestCaseCount(0);", "+    listener.assertJUnitStartCount(1);", "+    listener.assertJUnitEndCount(1);", "+    listener.assertJUnitSuiteStartedCount(1);", "+    listener.assertJUnitTestStartedCount(1);", "+    listener.assertJUnitTestEndedCount(1);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "2f4aed2ff2c7a52e524cc3f6d6b336f8", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "platform/src-eclipse/edu/rice/cs/drjava/model/compiler/EclipseCompiler.java", "commitBeforeChange": "2fe669ecac7f016397cbb10e5377e9e8c54b0471", "commitAfterChange": "f6644ed8bacb691af161dd2a81bf7ef2eb6ae97e", "methodNumberBeforeChange": 8, "methodNumberAfterChange": 8, "signatureBeforeChange": "\r   \r   private Iterable<String> _getOptions(List<? extends File> classPath, List<? extends File> sourcePath, File destination, \r                                        List<? extends File> bootClassPath, String sourceVersion, boolean showWarnings)", "signatureAfterChange": "      private Iterable<String> _getOptions(StandardJavaFileManager fileManager,                                        List<? extends File> classPath, List<? extends File> sourcePath, File destination,                                         List<? extends File> bootClassPath, String sourceVersion, boolean showWarnings)", "diff": ["-  \r", "-  private Iterable<String> _getOptions(List<? extends File> classPath, List<? extends File> sourcePath, File destination, \r", "-                                       List<? extends File> bootClassPath, String sourceVersion, boolean showWarnings) {\r", "-\r", "-    if (bootClassPath == null) { bootClassPath = _defaultBootClassPath; }\r", "-    \r", "-    List<String> options = new ArrayList<String>();\r", "-    for (Map.Entry<String, String> e : CompilerOptions.getOptions(showWarnings).entrySet()) {\r", "-      addOption(options,e.getKey());\r", "-      addOption(options,e.getValue());\r", "-    }\r", "-    \r", "-    //Should be setable some day?\r", "-    addOption(options,\"-g\");\r", "-    \r", "-    if (classPath != null) {\r", "-      addOption(options,\"-classpath\");\r", "-      addOption(options,IOUtil.pathToString(classPath));\r", "-    }\r", "-    if (sourcePath != null) {\r", "-      addOption(options,\"-sourcepath\");\r", "-      addOption(options,IOUtil.pathToString(sourcePath));\r", "-    }\r", "-    if (destination != null) {\r", "-      addOption(options,\"-d\");\r", "-      addOption(options,destination.getPath());\r", "-    }\r", "-    if (bootClassPath != null) {\r", "-      addOption(options,\"-bootclasspath\");\r", "-      addOption(options,IOUtil.pathToString(bootClassPath));\r", "-    }\r", "-    if (sourceVersion != null) {\r", "-      addOption(options,\"-source\");\r", "-      addOption(options,sourceVersion);\r", "-    }\r", "-    if (!showWarnings) {\r", "-      addOption(options,\"-nowarn\");\r", "-    }\r", "-\r", "-    return options;\r", "-  }\r", "+  ", "+  private Iterable<String> _getOptions(StandardJavaFileManager fileManager,", "+                                       List<? extends File> classPath, List<? extends File> sourcePath, File destination, ", "+                                       List<? extends File> bootClassPath, String sourceVersion, boolean showWarnings) {", "+    ", "+//    System.err.println(\"classPath: \"+classPath);", "+//    System.err.println(\"sourcePath: \"+sourcePath);", "+//    System.err.println(\"destination: \"+destination);", "+//    System.err.println(\"bootClassPath: \"+bootClassPath);", "+    ", "+    if (bootClassPath == null) { bootClassPath = _defaultBootClassPath; }", "+    ", "+    List<String> options = new ArrayList<String>();", "+    for (Map.Entry<String, String> e : CompilerOptions.getOptions(showWarnings).entrySet()) {", "+      addOption(options,e.getKey());", "+      addOption(options,e.getValue());", "+    }", "+    ", "+    //Should be setable some day?", "+    addOption(options,\"-g\");", "+    ", "+    if (classPath != null) {", "+      addOption(options,\"-classpath\");", "+      addOption(options,IOUtil.pathToString(classPath));", "+      try {", "+        fileManager.setLocation(StandardLocation.CLASS_PATH, classPath);", "+      }", "+      catch(IOException ioe) { /* ignore, just don't set the path */ }", "+    }", "+    if (sourcePath != null) {", "+      addOption(options,\"-sourcepath\");", "+      addOption(options,IOUtil.pathToString(sourcePath));", "+      try {", "+        fileManager.setLocation(StandardLocation.SOURCE_PATH, sourcePath);", "+      }", "+      catch(IOException ioe) { /* ignore, just don't set the path */ }        ", "+    }", "+    if (destination != null) {", "+      addOption(options,\"-d\");", "+      addOption(options,destination.getPath());", "+      try {", "+        fileManager.setLocation(StandardLocation.CLASS_OUTPUT, IterUtil.asIterable(destination));", "+      }", "+      catch(IOException ioe) { /* ignore, just don't set the path */ }", "+    }", "+    if (bootClassPath != null) {", "+      addOption(options,\"-bootclasspath\");", "+      addOption(options,IOUtil.pathToString(bootClassPath));", "+      try {", "+        fileManager.setLocation(StandardLocation.PLATFORM_CLASS_PATH, bootClassPath);", "+      }", "+      catch(IOException ioe) { /* ignore, just don't set the path */ }", "+    }", "+    if (sourceVersion != null) {", "+      addOption(options,\"-source\");", "+      addOption(options,sourceVersion);", "+    }", "+    if (!showWarnings) {", "+      addOption(options,\"-nowarn\");", "+    }", "+    ", "+    return options;", "+  }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "b2489f4bd1ead0787f4d87c3db31a4b5", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/DefaultGlobalModel.java", "commitBeforeChange": "420215825e681a0b291c00f3cf7aa39a982faffe", "commitAfterChange": "c657da4404f6681bffc368045343d4bc04e51744", "methodNumberBeforeChange": 77, "methodNumberAfterChange": 85, "signatureBeforeChange": "     public DefinitionsDocument getDocument()", "signatureAfterChange": "     public DefinitionsDocument getDocument()", "diff": ["-        return _doc;", "+      try{", "+        return _cache.get(this);", "+      }catch(FileMovedException e){", "+        System.out.println(\"DefaultGlobalModel: 1430: FileMovedException should be handled by box that fixes everything.\");", "+      }catch(IOException e){", "+        System.out.println(\"DefaultGlobalModel: 1432: IOException should be handled by box that fixes everything.\");", "+      }", "+      ", "+      ", "+      try{", "+        System.out.println(\"DefaultGlobalModel: 1435: creating blank doc.\");", "+        _cache.update(this, makeReconstructor());", "+        return _cache.get(this);", "+      }catch(FileMovedException e){", "+        System.out.println(\"DefaultGlobalModel: 1440: this should NEVER happen\");", "+      }catch(IOException e){", "+        System.out.println(\"DefaultGlobalModel: 1442: this should NEVER happen\");", "+      }", "+      return null;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "ba67281bc9d7e0dcfaef1ad07ab5cb74", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/MainFrame.java", "commitBeforeChange": "85ed1aa237c32b1787aaceb2ddec6d2f0e4c80e0", "commitAfterChange": "e2dcf9bc2cf7370066c5a6486905b66439f74f74", "methodNumberBeforeChange": 129, "methodNumberAfterChange": 129, "signatureBeforeChange": "   private void _openProjectHelper(File projectFile)", "signatureAfterChange": "   private void _openProjectHelper(File projectFile)", "diff": ["+    System.err.println(\"opening\");", "+", "-    _closeAll();", "-    _resetNavigatorPane();", "+    /**", "+     * now the model", "+     */", "+    List<OpenDefinitionsDocument> nonProjDocs = _model.getNonProjectDocuments();", "+    List<OpenDefinitionsDocument> projDocs = _model.getProjectDocuments();", "+    ", "+    ", "+    /**", "+     * close all project files", "+     */", "+    for(OpenDefinitionsDocument d: projDocs){", "+      System.err.println(\"closing \" + d);", "+      _model.closeFile(d);", "+      System.err.println(\"closed\");", "+    }", "+      ", "+    /**", "+     * keep all nonproject files open", "+     */", "+    IDocumentNavigator nav = _model.getDocumentNavigator();", "+//    nav.clear();", "+", "+//    for(OpenDefinitionsDocument d: nonProjDocs){", "+//      System.err.println(\"adding\" + d);", "+//      try{", "+//        /* transfer docs with files to new navigator */", "+//        nav.addDocument(_model.getIDocGivenODD(d), d.getFile().getParentFile().getAbsolutePath());", "+//      }catch(IllegalStateException e){", "+//        /* transfer untitled docs to new navigator */", "+//        nav.addDocument(_model.getIDocGivenODD(d));", "+//      }catch(FileMovedException e){", "+//        /* if the file has moved or been deleted,", "+//         * then add it to external files, since it's", "+//         * \"no longer in the project directory\"", "+//         */", "+//        nav.addDocument(_model.getIDocGivenODD(d));", "+//      }", "+//    }", "+    ", "+    System.err.println(\"done adding\");", "+    ", "+    System.err.println(\"about to set close project action\");", "+    ", "+", "+    System.err.println(\"done opening\");", "+    ", "+    _resetNavigatorPane();"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "d12dbd36aa67ac779c3cb3306a9116a9", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "platform/src-jdk7/edu/rice/cs/drjava/model/compiler/Javac170Compiler.java", "commitBeforeChange": "ac40c3972879cd0ae692485b72f8c40bbd1968d9", "commitAfterChange": "e3aa74ce1fa8ce4d59f29e9f6e97ca23385b706a", "methodNumberBeforeChange": 2, "methodNumberAfterChange": 2, "signatureBeforeChange": "\r   public List<? extends DJError> compile(List<? extends File> files, List<? extends File> classPath, \r                                                List<? extends File> sourcePath, File destination, \r                                                List<? extends File> bootClassPath, String sourceVersion, boolean showWarnings)", "signatureAfterChange": "\r   public List<? extends DJError> compile(List<? extends File> files, List<? extends File> classPath, \r                                                List<? extends File> sourcePath, File destination, \r                                                List<? extends File> bootClassPath, String sourceVersion, boolean showWarnings)", "diff": ["-    \r", "-    JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();\r", "+\r", "+    // This is the class that javax.tools.ToolProvider.getSystemJavaCompiler() uses.\r", "+    // We create an instance of that class directly, bypassing ToolProvider, because ToolProvider returns null\r", "+    // if DrJava is started with just the JRE, instead of with the JDK, even if tools.jar is later made available\r", "+    // to the class loader.\r", "+    JavaCompiler compiler = null;\r", "+    try {\r", "+      compiler = (JavaCompiler)(Class.forName(\"com.sun.tools.javac.api.JavacTool\").newInstance());\r", "+    }\r", "+    catch(ClassNotFoundException e) {\r", "+      errors.addFirst(new DJError(\"Compile exception: \" + e, false));\r", "+      error.log(e);\r", "+      return errors;\r", "+    }\r", "+    catch(InstantiationException e) {\r", "+      errors.addFirst(new DJError(\"Compile exception: \" + e, false));\r", "+      error.log(e);\r", "+      return errors;\r", "+    }\r", "+    catch(IllegalAccessException e) {\r", "+      errors.addFirst(new DJError(\"Compile exception: \" + e, false));\r", "+      error.log(e);\r", "+      return errors;\r", "+    }\r"]}], "num": 671}