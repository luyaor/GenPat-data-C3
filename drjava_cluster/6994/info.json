{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "6346017d15679821628874eaf8f96e04", "detectedBy": ["AST_HIERARCHICAL", "AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "034a7ae51ce66628bec82e96649356a8", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/util/StreamRedirectThread.java", "commitBeforeChange": "b68b258fee7c24e8a8c68fc2e7d3d99ccd585753", "commitAfterChange": "ec06880aa408b928b2f252538b208a76154d8334", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 4, "signatureBeforeChange": "     public void run()", "signatureAfterChange": "     public void run()", "diff": ["-            while ((count = in.read(cbuf, 0, BUFFER_SIZE)) >= 0) {", "-                out.write(cbuf, 0, count);", "-                out.flush();", "+            while ((!stop) && ((count = in.read(cbuf, 0, BUFFER_SIZE)) >= 0)) {", "+                try {", "+                    out.write(cbuf, 0, count);", "+                    out.flush();", "+                }", "+                catch (IOException exc) {", "+                    GeneralProcessCreator.LOG.log(\"StreamRedirectThread \"+getName()+\" had IOException while writing: \"+exc);", "+                    throw new StreamRedirectException(\"An error occurred during stream redirection, while piping data into a process.\",", "+                                                      exc);", "+                }", "+            GeneralProcessCreator.LOG.log(\"StreamRedirectThread \"+getName()+\" finished copying\");", "+            if (close) {", "+              out.close();", "+              in.close();", "+            }", "-          // ignore", "+          GeneralProcessCreator.LOG.log(\"StreamRedirectThread \"+getName()+\" had IOException: \"+exc);", "+          throw new StreamRedirectException(\"An error occurred during stream redirection, while piping data out of a process.\",", "+                                            exc);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "33ef87a135833633ec693d446c11fd35", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/util/StreamRedirectThread.java", "commitBeforeChange": "08dc50acc6315b4a29619a0eb44a9574f8e58999", "commitAfterChange": "fdb0eba529d65804f971cdb52c673713ef0d4616", "methodNumberBeforeChange": 4, "methodNumberAfterChange": 8, "signatureBeforeChange": "     public void run()", "signatureAfterChange": "   public void run()", "diff": ["-     */", "-    public void run() {", "-        try {", "-            char[] cbuf = new char[BUFFER_SIZE];", "-            int count;", "-            while ((!stop) && ((count = in.read(cbuf, 0, BUFFER_SIZE)) >= 0)) {", "-                try {", "-                    out.write(cbuf, 0, count);", "-                    out.flush();", "-                }", "-                catch (IOException exc) {", "-                    GeneralProcessCreator.LOG.log(\"StreamRedirectThread \"+getName()+\" had IOException while writing: \"+exc);", "-                    throw new StreamRedirectException(\"An error occurred during stream redirection, while piping data into a process.\",", "-                                                      exc);", "-                }", "-            }", "-            GeneralProcessCreator.LOG.log(\"StreamRedirectThread \"+getName()+\" finished copying\");", "+   */", "+  public void run() {", "+    do {", "+      try {", "+        char[] cbuf = new char[BUFFER_SIZE];", "+        int count;", "+        while ((!stop) && ((count = in.read(cbuf, 0, BUFFER_SIZE)) >= 0)) {", "+          try {", "+            out.write(cbuf, 0, count);", "-            if (close) {", "-              out.close();", "-              in.close();", "-            }", "+          }", "+          catch (IOException exc) {", "+            GeneralProcessCreator.LOG.log(\"StreamRedirectThread \"+getName()+\" had IOException while writing: \"+exc);", "+            throw new StreamRedirectException(\"An error occurred during stream redirection, while piping data into a process.\",", "+                                              exc);", "+          }", "-        catch (IOException exc) {", "-          GeneralProcessCreator.LOG.log(\"StreamRedirectThread \"+getName()+\" had IOException: \"+exc);", "-          throw new StreamRedirectException(\"An error occurred during stream redirection, while piping data out of a process.\",", "-                                            exc);", "+        GeneralProcessCreator.LOG.log(\"StreamRedirectThread \"+getName()+\" finished copying\");", "+        out.flush();", "+        if (close) {", "+          in.close();", "+      }", "+      catch (IOException exc) {", "+        GeneralProcessCreator.LOG.log(\"StreamRedirectThread \"+getName()+\" had IOException: \"+exc);", "+        throw new StreamRedirectException(\"An error occurred during stream redirection, while piping data out of a process.\",", "+                                          exc);", "+      }", "+      if (keepRunning) {", "+        // wait for a new input stream", "+        while(!cm.waitOne());", "+        cm.reset();", "+      }", "+    } while(keepRunning && !close);", "+    if (close) {", "+      try {", "+        out.close();", "+      }", "+      catch (IOException exc) {", "+        GeneralProcessCreator.LOG.log(\"StreamRedirectThread \"+getName()+\" had IOException: \"+exc);", "+        throw new StreamRedirectException(\"An error occurred during stream redirection, while piping data out of a process.\",", "+                                          exc);", "+      }", "+  }"]}], "num": 6994}