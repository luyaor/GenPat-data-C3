{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "a67e9bef7fb27af73b54e6158d419a16", "detectedBy": ["AST_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "2d1c742b9173502039d4626d10b3827a", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/cache/DocumentCache.java", "commitBeforeChange": "25d973a9f45bdba84ad4514eba518ee94f041daf", "commitAfterChange": "fa5a46f3cc65ec85b9fa37599dc6542e75cee25e", "methodNumberBeforeChange": 11, "methodNumberAfterChange": 9, "signatureBeforeChange": "     public DefinitionsDocument getDocument() throws IOException, FileMovedException", "signatureAfterChange": "     public DefinitionsDocument getDocument() throws IOException, FileMovedException", "diff": ["-      boolean isResident = false;", "-      boolean makeUnmanaged = false;  // makeUnmanaged -> isResident", "-      synchronized(_dmLock) { // lock the document manageer so that its state can be updated", "-        isResident = _doc != null;", "-        if (isResident) {  // Document is in queue or \"unmanaged\" (a modified doc or a new doc with no file)", "-          if (isUnmanagedOrUntitled()) return _doc;", "-          makeUnmanaged = _doc.isModifiedSinceSave();", "-          if (makeUnmanaged)  { setUnmanaged(); }", "-        }", "-      }", "-      if (makeUnmanaged) remove(this); // remove this from queue", "-      if (isResident) return _doc;", "-        ", "-      boolean isUntitled = false;", "-      synchronized(_dmLock) {      // Lock dm so that the _doc field can be updated.", "-        isUntitled = isUntitled();  // This locking may be overkill; once titled, always titled", "+//      Utilities.showDebug(\"getDocument called on \" + this + \" with _stat = \" + _stat);", "+      DefinitionsDocument doc = _doc;", "+      if (doc != null) return doc;", "+      synchronized(_cacheLock) { // lock the cache so that this DocManager's state can be updated", "+        if (_doc != null) return _doc;  // _doc may have changed since test outside of _cacheLock", "-          if (_doc == null) throw new IllegalStateException(\"the reconstructor made a null document\");", "+          assert _doc != null;", "+//        Utilities.showDebug(\"Document \" + _doc + \" reconstructed; _stat = \" + _stat);", "+        if (_stat == NOT_IN_QUEUE) add();       // add this to queue ", "+        return _doc;", "-//      Utilities.showDebug(\"Document \" + _doc + \" reconstructed; _stat = \" + _stat);", "-      if (! isUntitled) addToQueue();  // add this to queue if corresponds to a disk file", "-      return _doc;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "82796c3c5afa5fb411540086e65b7660", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/DrJava.java", "commitBeforeChange": "47c398bb655e51c115c8c0eb3d0935db42834771", "commitAfterChange": "62776e907e3e6dddd6b4161559ae3b70f27cc2e5", "methodNumberBeforeChange": 28, "methodNumberAfterChange": 11, "signatureBeforeChange": "   public static boolean promptForToolsJar(boolean needCompiler,                                           boolean needDebugger)", "signatureAfterChange": "   public static void promptForToolsJar(boolean needCompiler, boolean needDebugger)", "diff": ["+   */", "+  public static void promptForToolsJar(boolean needCompiler, boolean needDebugger) {", "+    final String[] text  = new String[] {", "+      \"DrJava cannot find a 'tools.jar' file for the version of Java \",", "+        \"that is being used to run DrJava.  Would you like to specify the \",", "+        \"location of the requisite 'tools.jar' file?   If you say 'No', \",", "+        \"DrJava might be unable to compile or debug Java programs.)\"", "+    };", "+    ", "+    int result = JOptionPane.showConfirmDialog(null, text, \"Locate 'tools.jar'?\", JOptionPane.YES_NO_OPTION);", "+", "+    if (result == JOptionPane.YES_OPTION) {", "+      JFileChooser chooser = new JFileChooser();", "+      chooser.setFileFilter(new ClassPathFilter() {", "+        public boolean accept(File f) {", "+          if (f.isDirectory()) return true;", "+          String ext = getExtension(f);", "+          return ext != null && ext.equals(\"jar\");", "+        }", "+        public String getDescription() { return \"Jar Files\"; }", "+      });", "+", "+      // Loop until we find a good tools.jar or the user gives up", "+      do {", "+        if (chooser.showOpenDialog(null) == JFileChooser.APPROVE_OPTION) {", "+          File jar = chooser.getSelectedFile();", "+", "+          if (jar != null) {", "+            // set the tools.jar property", "+            getConfig().setSetting(JAVAC_LOCATION, jar);", "+", "+            // Adjust if we needed a compiler", "+            if (needCompiler && classLoadersCanFind(TEST_COMPILER_CLASS)) needCompiler = false;", "+", "+            // Adjust if we need a debugger", "+            if (needDebugger && classLoadersCanFind(TEST_DEBUGGER_CLASS)) needDebugger = false;", "+          }", "+        }", "+//        Utilities.showDebug(\"need Compiler = \" + needCompiler + \"; needDebugger = \" + needDebugger);", "+      }", "+      while ((needCompiler || needDebugger) && _userWantsToPickAgain());", "+      ", "+      // Save config with good tools.jar if available", "+      if ((! needCompiler) && (! needDebugger)) _saveConfig();", "+    }", "+  }", "-   */", "-  public static boolean promptForToolsJar(boolean needCompiler,", "-                                          boolean needDebugger) {", "-    boolean restartRequired = false;", "-    final String[] text;", "-    if (needDebugger && !needCompiler) {", "-      text = new String[]{", "-        \"DrJava cannot get the necessary information from the\",", "-        \"current Java SDK's 'tools.jar' file to start the\",", "-        \"debugger. Would you like to specify the 'tools.jar'\",", "-        \"file for the version of java you are using to run\",", "-        \"DrJava at this time?\",", "-        \"(If you say 'No', DrJava might be unable to debug\",", "-        \"programs and the debug menu will not appear.)\"", "-      };", "-    }", "-    else {", "-      text = new String[]{", "-        \"DrJava cannot find the Java SDK's 'tools.jar' file. \",", "-        \"This file is necessary to compile files and use the \",", "-        \"debugger.  It is generally located in the 'lib' \",", "-        \"subdirectory of your Java installation directory. \",", "-        \"Would you like to specify its location? \",", "-        \"(If you say 'No', DrJava might be unable to compile \",", "-        \"or debug programs.)\"", "-      };", "-    }", "-", "-    int result = JOptionPane.showConfirmDialog(null, text, \"Locate 'tools.jar'?\",", "-                                               JOptionPane.YES_NO_OPTION);", "-", "-    if (result == JOptionPane.YES_OPTION) {", "-      JFileChooser chooser = new JFileChooser();", "-      chooser.setFileFilter(new ClassPathFilter() {", "-        public boolean accept(File f) {", "-          if (f.isDirectory()) {", "-            return true;", "-          }", "-          String ext = getExtension(f);", "-          return ext != null && ext.equals(\"jar\");", "-        }", "-        public String getDescription() {", "-          return \"Jar Files\";", "-        }", "-      });", "-", "-      // Loop until we find a good tools.jar or the user gives up", "-      do {", "-        if (chooser.showOpenDialog(null) == JFileChooser.APPROVE_OPTION) {", "-          File jar = chooser.getSelectedFile();", "-", "-          if (jar != null) {", "-            // set the tools.jar property", "-            getConfig().setSetting(JAVAC_LOCATION, jar);", "-", "-            // Adjust if we needed a compiler", "-            if (needCompiler) {", "-              // need to re-call getAvailable for it to re-check availability", "-              CompilerInterface[] compilers = CompilerRegistry.ONLY.getAvailableCompilers();", "-", "-              if (compilers[0] != NoCompilerAvailable.ONLY) {", "-                needCompiler = false;", "-                CompilerRegistry.ONLY.setActiveCompiler(compilers[0]);", "-                _saveConfig();", "-              }", "-            }", "-", "-            // Adjust if we need a debugger", "-            if (needDebugger) {", "-              if (classLoadersCanFindDebugger()) {", "-                needDebugger = false;", "-                restartRequired = true;", "-                _saveConfig();", "-              }", "-            }", "-          }", "-        }", "-      }", "-      while ((needCompiler || needDebugger) && ", "-             _userWantsToPickAgain(needDebugger && !needCompiler));", "-    }", "-", "-    return restartRequired;", "-  }"]}], "num": 24029}