{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "4e148577f812b20224124e7ff5c9b4dc", "detectedBy": ["AST_HIERARCHICAL", "AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "071e3bedcb4a8e3a35626075c8c5291a", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/AbstractDJDocument.java", "commitBeforeChange": "5497ac60fa563e6e67c580081d99fbd842e52332", "commitAfterChange": "5fa866685226be5aebbebdfba9d7d34d29108e50", "methodNumberBeforeChange": 57, "methodNumberAfterChange": 57, "signatureBeforeChange": "   public boolean posInParenPhrase()", "signatureAfterChange": "   public boolean posInParenPhrase()", "diff": ["-    synchronized(_reduced) {", "-      info = _reduced.getIndentInformation();", "-    }", "+    readLock();", "+    try { synchronized(_reduced) { info = _reduced.getIndentInformation(); } }", "+    finally { readUnlock(); }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "6fd9e1b374294de0a2e5825a4786836b", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/AbstractDJDocument.java", "commitBeforeChange": "5497ac60fa563e6e67c580081d99fbd842e52332", "commitAfterChange": "5fa866685226be5aebbebdfba9d7d34d29108e50", "methodNumberBeforeChange": 48, "methodNumberAfterChange": 48, "signatureBeforeChange": "   public int getLineEndPos(final int pos)", "signatureAfterChange": "   public int getLineEndPos(final int pos)", "diff": ["-    synchronized(_reduced) {", "-      int location = _currentLocation;", "-      _reduced.move(pos - location);", "-      dist = _reduced.getDistToNextNewline();", "-      _reduced.move(location - pos);", "+    readLock();", "+    try {", "+      synchronized(_reduced) {", "+        int location = _currentLocation;", "+        _reduced.move(pos - location);", "+        dist = _reduced.getDistToNextNewline();", "+        _reduced.move(location - pos);", "+      }", "+    finally { readUnlock(); }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "94a926781e4750d4eb6e4a351e2d6b14", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/AbstractDJDocument.java", "commitBeforeChange": "5497ac60fa563e6e67c580081d99fbd842e52332", "commitAfterChange": "5fa866685226be5aebbebdfba9d7d34d29108e50", "methodNumberBeforeChange": 27, "methodNumberAfterChange": 27, "signatureBeforeChange": "   public IndentInfo getIndentInformation()", "signatureAfterChange": "   public IndentInfo getIndentInformation()", "diff": ["-    synchronized(_reduced) { info = _reduced.getIndentInformation(); }", "+    readLock();", "+    try { synchronized(_reduced) { info = _reduced.getIndentInformation(); } }", "+    finally { readUnlock(); }  "]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "980497a21d25d7a27d51eac8534ae8a3", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/AbstractDJDocument.java", "commitBeforeChange": "5497ac60fa563e6e67c580081d99fbd842e52332", "commitAfterChange": "5fa866685226be5aebbebdfba9d7d34d29108e50", "methodNumberBeforeChange": 47, "methodNumberAfterChange": 47, "signatureBeforeChange": "   public int getLineStartPos(final int pos)", "signatureAfterChange": "   public int getLineStartPos(final int pos)", "diff": ["-    synchronized(_reduced) {", "-      int location = _currentLocation;", "-      _reduced.move(pos - location);", "-      dist = _reduced.getDistToPreviousNewline(0);", "-      _reduced.move(location - pos);", "+    readLock();", "+    try {", "+      synchronized(_reduced) {", "+        int location = _currentLocation;", "+        _reduced.move(pos - location);", "+        dist = _reduced.getDistToPreviousNewline(0);", "+        _reduced.move(location - pos);", "+      }", "+    finally { readUnlock(); }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "ac01fcb8998dea98076bb876df635870", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/AbstractDJDocument.java", "commitBeforeChange": "5497ac60fa563e6e67c580081d99fbd842e52332", "commitAfterChange": "5fa866685226be5aebbebdfba9d7d34d29108e50", "methodNumberBeforeChange": 56, "methodNumberAfterChange": 56, "signatureBeforeChange": "   public boolean posInParenPhrase(int pos)", "signatureAfterChange": "   public boolean posInParenPhrase(int pos)", "diff": ["-    synchronized(_reduced) {", "-      int here = _currentLocation;", "-      _reduced.move(pos - here);", "-      inParenPhrase = posInParenPhrase();", "-      _reduced.move(here - pos);", "+    readLock();", "+    try {", "+      synchronized(_reduced) {", "+        int here = _currentLocation;", "+        _reduced.move(pos - here);", "+        inParenPhrase = posInParenPhrase();", "+        _reduced.move(here - pos);", "+      }", "+    finally { readUnlock(); }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "c2e2c7725e37887dee7453ec52c2e59a", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/AbstractDJDocument.java", "commitBeforeChange": "a8db062e8dfd667df6324c059f7a6725afc99a1b", "commitAfterChange": "35da9b77b7d75aca3d6277e27e3ba3dc86f3eaa9", "methodNumberBeforeChange": 35, "methodNumberAfterChange": 35, "signatureBeforeChange": "   public int findPrevCharPos(int pos, char[] whitespace)     throws BadLocationException", "signatureAfterChange": "   public int findPrevCharPos(int pos, char[] whitespace) throws BadLocationException", "diff": ["-  public int findPrevCharPos(int pos, char[] whitespace)", "-    throws BadLocationException {", "-    // throwErrorHuh();", "+  public int findPrevCharPos(int pos, char[] whitespace) throws BadLocationException {", "-    String text = getText(0, pos);", "-    ", "-    synchronized(_reduced) {", "-      ", "-      final int origLocation = _currentLocation;", "-      // Move reduced model to location pos", "-      _reduced.move(pos - origLocation);  // reduced model points to pos == reducedPos", "-      ", "-      // Walk backward from specified position", "-      ", "-      while (i >= 0) { ", "-        /* Invariant: reduced model points to reducedPos, i < reducedPos <= pos, ", "-         * text[i+1:pos-1] contains invalid chars */", "+    readLock();", "+    try {", "+      String text = getText(0, pos);", "+      synchronized(_reduced) {", "-        if (match(text.charAt(i), whitespace)) {", "-          // ith char is whitespace", "-          i--;", "-          continue;", "+        final int origLocation = _currentLocation;", "+        // Move reduced model to location pos", "+        _reduced.move(pos - origLocation);  // reduced model points to pos == reducedPos", "+        ", "+        // Walk backward from specified position", "+        ", "+        while (i >= 0) { ", "+          /* Invariant: reduced model points to reducedPos, i < reducedPos <= pos, ", "+           * text[i+1:pos-1] contains invalid chars */", "+          ", "+          if (match(text.charAt(i), whitespace)) {", "+            // ith char is whitespace", "+            i--;", "+            continue;", "+          }", "+          ", "+          // Found a non-whitespace char;  move reduced model to location i", "+          _reduced.move(i - reducedPos);", "+          reducedPos = i;                  // reduced model points to i == reducedPos", "+          ", "+          // Check if matching char is within a comment (not including opening two characters)", "+          if ((_reduced.getStateAtCurrent().equals(ReducedModelState.INSIDE_LINE_COMMENT)) ||", "+              (_reduced.getStateAtCurrent().equals(ReducedModelState.INSIDE_BLOCK_COMMENT))) {", "+            i--;", "+            continue;", "+          }", "+          ", "+          if (_isEndOfComment(text, i)) { /* char is second character is opening comment market */  ", "+            // Move i past the first comment character and continue searching", "+            i = i - 2;", "+            continue;", "+          }", "+          ", "+          // Found valid previous character", "+          break;", "-        // Found a non-whitespace char;  move reduced model to location i", "-        _reduced.move(i - reducedPos);", "-        reducedPos = i;                  // reduced model points to i == reducedPos", "-        ", "-        // Check if matching char is within a comment (not including opening two characters)", "-        if ((_reduced.getStateAtCurrent().equals(ReducedModelState.INSIDE_LINE_COMMENT)) ||", "-            (_reduced.getStateAtCurrent().equals(ReducedModelState.INSIDE_BLOCK_COMMENT))) {", "-          i--;", "-          continue;", "-        }", "-        ", "-        if (_isEndOfComment(text, i)) { /* char is second character is opening comment market */  ", "-          // Move i past the first comment character and continue searching", "-          i = i - 2;", "-          continue;", "-        }", "-        ", "-        // Found valid previous character", "-        break;", "+        /* Exit invariant same as for loop except that i <= reducedPos because at break i = reducedPos */", "+        _reduced.move(origLocation - reducedPos);", "-      ", "-      /* Exit invariant same as for loop except that i <= reducedPos because at break i = reducedPos */", "-      _reduced.move(origLocation - reducedPos);", "+    finally { readUnlock(); }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "d62dc24414931f9d36d2cfa512b9c7f8", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/AbstractDJDocument.java", "commitBeforeChange": "5497ac60fa563e6e67c580081d99fbd842e52332", "commitAfterChange": "5fa866685226be5aebbebdfba9d7d34d29108e50", "methodNumberBeforeChange": 12, "methodNumberAfterChange": 12, "signatureBeforeChange": "   public Vector<HighlightStatus> getHighlightStatus(int start, int end)", "signatureAfterChange": "   public Vector<HighlightStatus> getHighlightStatus(int start, int end)", "diff": ["-// locking commented out because highlightStatus is not visible to swing; it is protected by the _reduced lock", "-//    readLock();", "-//    try {", "+", "+    readLock();", "+    try {", "-        // Now ask reduced model for highlight status for chars till end", "+        /* Now ask reduced model for highlight status for chars till end */", "-        // Go through and find any NORMAL blocks", "-        // Within them check for keywords", "+        /* Go through and find any NORMAL blocks. Within them check for keywords. */", "-//    }", "-//    finally { readUnlock(); }", "+    }", "+    finally { readUnlock(); }"]}], "num": 20345}