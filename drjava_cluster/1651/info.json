{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "0695d348df2f362e03896f02412a5cc2", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "42d4129a97bc97a02f9c168ca9c90f41", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/RegionsTreePanel.java", "commitBeforeChange": "11e630b08382faca40628146b7f40625d89f190c", "commitAfterChange": "4742de9e9abcc9abfbe963657e41dfd407aaaeee", "methodNumberBeforeChange": 16, "methodNumberAfterChange": 16, "signatureBeforeChange": "   public void addRegion(final R r)", "signatureAfterChange": "   public void addRegion(final R r)", "diff": ["-        // Sort regions by line number.", "+        // Sort regions by start offset.", "-        Enumeration lineNumbers = doc.children();", "-        while (lineNumbers.hasMoreElements()) {", "-          DefaultMutableTreeNode lineNumber = (DefaultMutableTreeNode)lineNumbers.nextElement();", "+        Enumeration existingRegions = doc.children();", "+        while (existingRegions.hasMoreElements()) {", "+          DefaultMutableTreeNode existing = (DefaultMutableTreeNode)existingRegions.nextElement();", "-          // if line number of indexed regions is less than new region, continue", "-          int lnr = r.getDocument().getLineOfOffset(r.getStartOffset())+1;", "-          if (((RegionTreeUserObj)lineNumber.getUserObject()).lineNumber() == lnr) {", "+          // if start offset of indexed regions is less than new region, continue", "+          int ofs = r.getStartOffset();", "+          if (((RegionTreeUserObj)existing.getUserObject()).region().getStartOffset() == ofs) {", "-            _regTree.scrollPathToVisible(new TreePath(lineNumber));", "+            _regTree.scrollPathToVisible(new TreePath(existing));", "-          else if (((RegionTreeUserObj)lineNumber.getUserObject()).lineNumber() > lnr) {", "+          else if (((RegionTreeUserObj)existing.getUserObject()).region().getStartOffset() > ofs) {", "-            _regTreeModel.insertNodeInto(newRegion, doc, doc.getIndex(lineNumber));", "+            _regTreeModel.insertNodeInto(newRegion, doc, doc.getIndex(existing));"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "7383d68b2c1e83b1c8daf749ded29f7c", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/RegionsTreePanel.java", "commitBeforeChange": "2b371f46cbe5fba581bc2ddd38ce1509ce9a6d65", "commitAfterChange": "44c6b68dcb4045b67b8248b43a9b998505409543", "methodNumberBeforeChange": 8, "methodNumberAfterChange": 6, "signatureBeforeChange": "   protected void updatePanel()", "signatureAfterChange": "   protected void updatePanel()", "diff": ["-    Enumeration docNodes = _rootNode.children();", "-    while (docNodes.hasMoreElements()) {", "-      DefaultMutableTreeNode docNode = (DefaultMutableTreeNode) docNodes.nextElement();          ", "-      // Find the correct start offset node for this region", "-      Enumeration regionNodes = docNode.children();", "-      while (regionNodes.hasMoreElements()) {", "-        DefaultMutableTreeNode regionNode = (DefaultMutableTreeNode) regionNodes.nextElement();", "-        _regTreeModel.nodeChanged(regionNode);", "-      }", "-      _regTreeModel.nodeChanged(docNode);  // file name may have changed", "-      _lastUpdateTime = System.currentTimeMillis();", "-      _frame._changed = false;", "-    }", "+//    Enumeration docNodes = _rootNode.children();", "+//    while (docNodes.hasMoreElements()) {", "+//      DefaultMutableTreeNode docNode = (DefaultMutableTreeNode) docNodes.nextElement();          ", "+//      // Find the correct start offset node for this region", "+//      Enumeration regionNodes = docNode.children();", "+//      while (regionNodes.hasMoreElements()) {", "+//        DefaultMutableTreeNode regionNode = (DefaultMutableTreeNode) regionNodes.nextElement();", "+//        _regTreeModel.nodeChanged(regionNode);", "+//      }", "+    revalidate();", "+    repaint();", "+//      _regTreeModel.nodeChanged(docNode);  // file name may have changed", "+    _lastUpdateTime = System.currentTimeMillis();", "+    _frame.resetChanged();", "+//    }"]}], "num": 1651}