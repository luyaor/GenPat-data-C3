{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "0d4e7b0571bef26dce3bf730154d0565", "detectedBy": ["AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "83d8e82badf6637d9e1512eb8f1f027c", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/cache/DocumentCache.java", "commitBeforeChange": "ff2e70871791df593185a62b1085ea613a30f1d1", "commitAfterChange": "aef1425a6103fe62ee23d162065d6ac1d8b40238", "methodNumberBeforeChange": 5, "methodNumberAfterChange": 5, "signatureBeforeChange": "   private void updatelru(OpenDefinitionsDocument odd, Pair<DefinitionsDocument,DDReconstructor> pair)", "signatureAfterChange": "   private void updatelru(OpenDefinitionsDocument odd, Pair<DefinitionsDocument,DDReconstructor> pair)", "diff": ["-    if(!lru.isEmpty() && lru.getFirst() == odd){", "-      //System.out.println(\"updatelru: \" + odd + \" is first in list\");", "-      return;", "+    synchronized(lru) {", "+      if(!lru.isEmpty() && lru.getFirst() == odd){", "+        //System.out.println(\"updatelru: \" + odd + \" is first in list\");", "+        return;", "+      }", "+      lru.remove(odd);", "-    lru.remove(odd);", "-      lru.addFirst(odd);", "+      synchronized(lru) {", "+        lru.addFirst(odd);", "+      }", "-    ", "+", "-      odd = lru.removeLast();", "+      synchronized(lru) {", "+        odd = lru.removeLast();", "+      }", "-      }else{", "+      } else {", "-        update(odd, removedPair.getSecond());", "+          update(odd, removedPair.getSecond());"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "a5ece0d6f3f1236a17f13df7ee1d139a", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/util/docnavigation/JTreeSortNavigator.java", "commitBeforeChange": "d9483f6c228cd09f3431ad6b50a3d96bdaf83832", "commitAfterChange": "f998596e58db467638fd2c5025aacbfb31d4199f", "methodNumberBeforeChange": 16, "methodNumberAfterChange": 16, "signatureBeforeChange": "   public void refreshDocument(ItemT doc, String path)", "signatureAfterChange": "   public void refreshDocument(ItemT doc, String path)", "diff": ["-   */", "+    */", "-//    synchronized (_model) {", "-      LeafNode<ItemT> node = getNodeForDoc(doc);", "+//    synchronized(_model) {", "+      LeafNode<ItemT> node = _doc2node.get(doc);", "-      if (node == null) {", "+      if (node == null) { // document has not yet been entered in tree", "-        oldParent = null;", "+//        oldParent = null;", "+        return; // inserted because the sequel simply removes node and adds it back again!", "-      else {", "-        InnerNode<?, ?> p = (InnerNode<?, ?>) node.getParent();", "-        oldParent = p;", "-      }", "+//      else { // commented out after insertion of return above", "+      InnerNode<?, ?> p = (InnerNode<?, ?>) node.getParent();", "+      oldParent = p;", "+//      }", "-        if (!newPath.substring(newPath.length()-1).equals(\"/\")) newPath = newPath + \"/\";", "+        if (! newPath.substring(newPath.length() - 1).equals(\"/\")) newPath = newPath + \"/\";", "-      if (newParent == oldParent) { ", "-        if (!node.toString().equals(doc.getName())) {", "-          LeafNode<ItemT> newLeaf= new LeafNode<ItemT>(doc);", "-          _doc2node.put(doc,newLeaf);", "-          insertNodeSortedInto(newLeaf, newParent);", "-          _model.removeNodeFromParent(node);", "+      if (newParent == oldParent) { // no mutation has occurred before this point because oldParent != null", "+        if (! node.toString().equals(doc.getName())) { // document has changed name?", "+          synchronized(_model) {", "+            LeafNode<ItemT> newLeaf= new LeafNode<ItemT>(doc);", "+            _doc2node.put(doc, newLeaf);", "+            insertNodeSortedInto(newLeaf, newParent);", "+            _model.removeNodeFromParent(node);", "+          }", "-      else {", "-        removeNode(node);", "-        addDocument(doc, path);", "+      else { // document has moved within tree", "+        synchronized(_model) {", "+          removeNode(node);", "+          addDocument(doc, path);", "+        }"]}], "num": 25396}