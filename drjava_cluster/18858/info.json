{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "3a660e67eebaf25f2f9964d35d276620", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "2351102e2cb9d76e6318f63a390982cd", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/DefinitionsPane.java", "commitBeforeChange": "aabf32dfcb159caa0bf37490cd0936b3ae5f1fb6", "commitAfterChange": "32543485a6c30402f49deaf8c43253937744fd6f", "methodNumberBeforeChange": 49, "methodNumberAfterChange": 49, "signatureBeforeChange": "   public void notifyActive()", "signatureAfterChange": "   public void notifyActive()", "diff": ["-    ", "-    setCaretPosition(_position);", "-    if(_position == _selStart){", "-      setCaretPosition(_selEnd);", "-      moveCaretPosition(_selStart);", "-    }else{", "-      setCaretPosition(_selStart);", "-      moveCaretPosition(_selEnd);", "+//    setCaretPosition(_position);", "+    Object _lock = new Object();", "+    synchronized(_lock) {", "+      if(_position == _selStart){", "+        setCaretPosition(_selEnd);", "+        moveCaretPosition(_selStart);", "+        _doc.setCurrentLocation(_selStart);", "+      }else{", "+        setCaretPosition(_selStart);", "+        moveCaretPosition(_selEnd);", "+        _doc.setCurrentLocation(_selEnd);", "+      }", "-    _doc.setCurrentLocation(_position);", "-    _scrollPane.getVerticalScrollBar().setValue(_savedVScroll);", "-    _scrollPane.getHorizontalScrollBar().setValue(_savedHScroll);", "+    synchronized(_lock) {", "+      _scrollPane.getVerticalScrollBar().setValue(_savedVScroll);", "+      _scrollPane.getHorizontalScrollBar().setValue(_savedHScroll);", "+    }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "7b0af20fbd5c2943e9dff6a9c0bdef1f", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/DefinitionsPane.java", "commitBeforeChange": "8f8a64864bd9c3c9658401188aaec5c9c0dfe4f7", "commitAfterChange": "9e1a29777c7e5973840e817aca59ceea66af7a9c", "methodNumberBeforeChange": 50, "methodNumberAfterChange": 50, "signatureBeforeChange": "   public void notifyActive()", "signatureAfterChange": "   public void notifyActive()", "diff": ["-    if(_doc.getUndoableEditListeners().length == 0) {", "-      _resetUndo();", "-    }", "+    if(_doc.getUndoableEditListeners().length == 0) _resetUndo();", "-    Object _lock = new Object();", "-    synchronized(_lock) {", "-      if(_position == _selStart) {", "+//    Object _lock = new Object();", "+//    synchronized(_lock) {  // What was the rationale for a local lock here?", "+//                              It appears that legacy versions executed this code from non-event context    ", "+    _doc.acquireWriteLock();", "+    try {", "+      if (_position == _selStart) {", "-      }else{", "+      }", "+      else {", "-    synchronized(_lock) {", "-      _scrollPane.getVerticalScrollBar().setValue(_savedVScroll);", "-      _scrollPane.getHorizontalScrollBar().setValue(_savedHScroll);", "-    }", "+    finally { _doc.releaseWriteLock(); }", "+//    synchronized(_lock) {  // Why synchronize?  This code now runs in the event thread, but was not in legacy code", "+    _scrollPane.getVerticalScrollBar().setValue(_savedVScroll);", "+    _scrollPane.getHorizontalScrollBar().setValue(_savedHScroll);", "+//    }"]}], "num": 18858}