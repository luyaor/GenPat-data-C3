{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "9af4d480758fc149eb08786204a960f3", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "5cee7b3e17f88e8af073459006f4bbd9", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/MainFrame.java", "commitBeforeChange": "f01da19eef180264e50ee938eb35e69c8d092f3e", "commitAfterChange": "fbaecba32a4936f7aab208313b312f73181698a7", "methodNumberBeforeChange": 189, "methodNumberAfterChange": 189, "signatureBeforeChange": "   private void _close()", "signatureAfterChange": "   private void _close()", "diff": ["-    _model.closeFile(_model.getActiveDocument());", "+    ", "+    try{", "+      if(_model.getActiveDocument().isAuxiliaryFile() || ", "+         _model.getActiveDocument().isProjectFile()){", "+        String text = \"Closing this file will permanently remove it from the current project.\" + ", "+          \"\\nAre you sure that you want to close this file?\";", "+        ", "+        int rc = JOptionPane.showConfirmDialog(MainFrame.this,", "+                                             text,", "+                                             \"Close \" + ", "+                                               _model.getActiveDocument().getFile().getName() + ", "+                                               \"?\",", "+                                             JOptionPane.YES_NO_OPTION);", "+        if(rc != JOptionPane.YES_OPTION)", "+          return;", "+      }", "+      ", "+      //Either this is an external file or user actually wants to close it", "+      _model.closeFile(_model.getActiveDocument());", "+        ", "+    }", "+    catch(FileMovedException e){", "+      //Not sure what exactly should be done.", "+      //For now, let's just say the error is unexpected.", "+      throw new UnexpectedException(e);", "+    }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "6b65fa1f2869d0e22b5b9a93cc7c2202", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/MainFrame.java", "commitBeforeChange": "11baa8cf53a286506909ee582997234b834f9358", "commitAfterChange": "f9b63c51c7bc39c2ca858a18aa7508745f80cf7d", "methodNumberBeforeChange": 372, "methodNumberAfterChange": 372, "signatureBeforeChange": "   private void _warnFileOpen()", "signatureAfterChange": "   private boolean _warnFileOpen(File f)", "diff": ["-  private void _warnFileOpen() {", "-    // If we'd like to change to an error message for this, instead", "-    // of a warning, change both incidents of WARNING to ERROR.", "-    JOptionPane.showMessageDialog(MainFrame.this,", "-                                  \"This file is open in DrJava.  You may not overwrite it.\",", "-                                  \"File Open Warning\", JOptionPane.WARNING_MESSAGE);", "+  private boolean _warnFileOpen(File f) {", "+    Object[] options = {\"Yes\",\"No\"};", "+    int choice = JOptionPane.showOptionDialog(MainFrame.this,", "+                                  \"This file already exists and is open in DrJava.  Do you wish to overwrite it?\",", "+                                  \"File Open Warning\",", "+                                 JOptionPane.YES_NO_OPTION,", "+                                 JOptionPane.QUESTION_MESSAGE,", "+                                 null,", "+                                 options,", "+                                 options[1]);", "+    if(choice == JOptionPane.YES_OPTION) {", "+      List<OpenDefinitionsDocument> l = new LinkedList<OpenDefinitionsDocument>();", "+      try {", "+        l.add(_model.getDocumentForFile(f));", "+      }", "+      catch(IOException ioe) {", "+        _showIOError(ioe);", "+      }", "+      _model.closeFiles(l);", "+      return true;", "+    }", "+    return false;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "a16e0708400298e228db222fbdea0669", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/MainFrame.java", "commitBeforeChange": "d1a5d27cb22a5cf8891a6811cdc476b60834d1c0", "commitAfterChange": "eb9337b4d6e2d2de4c1774413f08dfb947ae389c", "methodNumberBeforeChange": 422, "methodNumberAfterChange": 422, "signatureBeforeChange": "   private boolean _warnFileOpen(File f)", "signatureAfterChange": "   private boolean _warnFileOpen(File f)", "diff": ["-    if(d == null) return false;", "-    int choice = JOptionPane.showOptionDialog(MainFrame.this,", "-                                              \"This file is already open in DrJava\" + (d.isModifiedSinceSave() ? \" and has been modified\" : \"\") ", "-                                                + \".  Do you wish to overwrite it?\",", "-                                                \"File Open Warning\",", "-                                              JOptionPane.YES_NO_OPTION,", "-                                              JOptionPane.QUESTION_MESSAGE,", "-                                              null,", "-                                              options,", "-                                              options[1]);", "-    if (choice == JOptionPane.YES_OPTION)  return _model.closeFileWithoutPrompt(d);", "+    if (d == null) return false;", "+    boolean dMod = d.isModifiedSinceSave();", "+    String msg = \"This file is already open in DrJava\" + (dMod ? \" and has been modified\" : \"\") + ", "+      \".  Do you wish to overwrite it?\";", "+    int choice = JOptionPane.showOptionDialog(MainFrame.this, msg, \"File Open Warning\", JOptionPane.YES_NO_OPTION,", "+                                              JOptionPane.QUESTION_MESSAGE, null, options, options[1]);", "+    if (choice == JOptionPane.YES_OPTION) return _model.closeFileWithoutPrompt(d);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "de8993b7c8c6fa665eef437cd3824ce1", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/MainFrame.java", "commitBeforeChange": "b555b0cfcc7bbb9f082899ce815305f8a985343e", "commitAfterChange": "aafaf7b848d738e58eee48a6cbc4b800c8027685", "methodNumberBeforeChange": 219, "methodNumberAfterChange": 219, "signatureBeforeChange": "   private void _close()", "signatureAfterChange": "   private void _close()", "diff": ["-      String filename = null;", "+      String fileName = null;", "-        if (doc.isUntitled()) filename = \"File\";", "-        else filename = _model.getActiveDocument().getFile().getName();", "+        if (doc.isUntitled()) fileName = \"File\";", "+        else fileName = _model.getActiveDocument().getFile().getName();", "-      catch(FileMovedException e) { filename = e.getFile().getName(); }", "+      catch(FileMovedException e) { fileName = e.getFile().getName(); }", "-      int rc = JOptionPane.showOptionDialog(MainFrame.this,", "-                                            text,", "-                                            \"Close \" + filename + \"?\",", "-                                            JOptionPane.YES_NO_OPTION,", "-                                            JOptionPane.QUESTION_MESSAGE,", "-                                            null,", "-                                            options,", "-                                            options[1]);", "+      int rc = ", "+        JOptionPane.showOptionDialog(MainFrame.this, text,\"Close \" + fileName + \"?\", JOptionPane.YES_NO_OPTION,", "+                                     JOptionPane.QUESTION_MESSAGE, null, options, options[1]);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "ebd91c4553c680c92aa2f52b0295ff72", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/MainFrame.java", "commitBeforeChange": "8d95a1805c723dadaf6966cff05bf6e39d55fe5e", "commitAfterChange": "830fa457bd100a306754098db963a55c0d92d71e", "methodNumberBeforeChange": 407, "methodNumberAfterChange": 407, "signatureBeforeChange": "   private boolean _warnFileOpen(File f)", "signatureAfterChange": "   private boolean _warnFileOpen(File f)", "diff": ["+    OpenDefinitionsDocument d = null;", "+    try {", "+      d = _model.getDocumentForFile(f);", "+    }", "+    catch(IOException ioe) {", "+      // this means the file has been deleted. If they're saving over it, don't show an I/O Error", "+    }", "-                                  \"This file already exists and is open in DrJava.  Do you wish to overwrite it?\",", "-                                  \"File Open Warning\",", "-                                 JOptionPane.YES_NO_OPTION,", "-                                 JOptionPane.QUESTION_MESSAGE,", "-                                 null,", "-                                 options,", "-                                 options[1]);", "-    if(choice == JOptionPane.YES_OPTION) {", "-      List<OpenDefinitionsDocument> l = new LinkedList<OpenDefinitionsDocument>();", "-      try {", "-        l.add(_model.getDocumentForFile(f));", "-      }", "-      catch(IOException ioe) {", "-        _showIOError(ioe);", "-      }", "-      _model.closeFiles(l);", "-      return true;", "+                                              \"This file is already open in DrJava\" + (d.isModifiedSinceSave() ? \" and has been modified\" : \"\") ", "+                                                + \".  Do you wish to overwrite it?\",", "+                                                \"File Open Warning\",", "+                                              JOptionPane.YES_NO_OPTION,", "+                                              JOptionPane.QUESTION_MESSAGE,", "+                                              null,", "+                                              options,", "+                                              options[1]);", "+    if(choice == JOptionPane.YES_OPTION && d != null) {", "+      return _model.closeFileWithoutPrompt(d);"]}], "num": 18828}