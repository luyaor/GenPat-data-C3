{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "a7da6aee1fffdd949d64947869af010b", "detectedBy": ["AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "0a8897125f69b2eed472887bc3917aa5", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/DefaultGlobalModel.java", "commitBeforeChange": "e64e0f2febfc163cfb04eb35ce1134673166ab50", "commitAfterChange": "71b4e72a1b4feef5a2621bd09e829e0108d8d893", "methodNumberBeforeChange": 101, "methodNumberAfterChange": 101, "signatureBeforeChange": "   public synchronized void saveProject(String filename, Hashtable<OpenDefinitionsDocument,DocumentInfoGetter> info)      throws IOException", "signatureAfterChange": "   public void saveProject(String filename, Hashtable<OpenDefinitionsDocument,DocumentInfoGetter> info)      throws IOException", "diff": ["-  public synchronized void saveProject(String filename, Hashtable<OpenDefinitionsDocument,DocumentInfoGetter> info) ", "+  public void saveProject(String filename, Hashtable<OpenDefinitionsDocument,DocumentInfoGetter> info) ", "-//    String base = filename.substring(0, filename.lastIndexOf(File.separator) + 1);", "-    Vector<File> auxFileVector = new Vector<File>();", "-    Iterator<OpenDefinitionsDocument> odds = _documentsRepos.valuesIterator();", "-    while(odds.hasNext()){", "-      OpenDefinitionsDocument doc = odds.next();", "-      ", "-      ", "-      if (!doc.isUntitled() ) {", "-        // could not use doc.isInProjectPath because we may be in flat file view which returns false", "-        String projectPath = new File(filename).getParentFile().getCanonicalPath() + File.separator;", "-        String filePath = doc.getFile().getParentFile().getCanonicalPath() + File.separator;", "-        if (filePath.startsWith(projectPath)){", "-          DocumentInfoGetter g = info.get(doc);", "-          builder.addSourceFile(g);", "-          srcFileVector.add(g.getFile());", "-        }else if(doc.isAuxiliaryFile()){", "-          DocumentInfoGetter g = info.get(doc);", "-          builder.addAuxiliaryFile(g);", "-          auxFileVector.add(g.getFile());", "+    LinkedList<File> auxFileList = new LinkedList<File>();", "+    ", "+    synchronized (_documentsRepos) { ", "+      for (OpenDefinitionsDocument doc: _documentsRepos.values()) {", "+        if (!doc.isUntitled()) {", "+          // could not use doc.isInProjectPath because we may be in flat file view which returns false", "+          String projectPath = new File(filename).getParentFile().getCanonicalPath() + File.separator;", "+          String filePath = doc.getFile().getParentFile().getCanonicalPath() + File.separator;", "+          if (filePath.startsWith(projectPath)){", "+            DocumentInfoGetter g = info.get(doc);", "+            builder.addSourceFile(g);", "+            srcFileVector.add(g.getFile());", "+          }", "+          else if (doc.isAuxiliaryFile()) {", "+            DocumentInfoGetter g = info.get(doc);", "+            builder.addAuxiliaryFile(g);", "+            auxFileList.add(g.getFile());", "+          }", "-", "+      ", "+      ", "-      for (String s : paths) {", "-        builder.addCollapsedPath(s);", "-      }", "+      for (String s : paths) { builder.addCollapsedPath(s); }", "-    for(int i = 0; i<currentclasspaths.size(); i++){", "-      builder.addClasspathFile(currentclasspaths.get(i));", "-    }", "+    for (File f: currentclasspaths) { builder.addClasspathFile(f); }", "-    File f = getBuildDirectory();", "-    //System.out.println(f);", "-    if(f != null)", "-      builder.setBuildDirectory(f);", "+    File d = getBuildDirectory();", "+    if (d != null) builder.setBuildDirectory(d);", "-    //System.out.println(f);", "-    if(mainClass != null){", "-      builder.setMainClass(mainClass);", "-    }", "+    if (mainClass != null) builder.setMainClass(mainClass);", "-", "-  ", "+    ", "-    _auxiliaryFiles.clear();", "-    for(File file: auxFileVector){", "-      _auxiliaryFiles.add(file);", "+    synchronized (_auxiliaryFiles) {", "+      _auxiliaryFiles = auxFileList;", "-    setFileGroupingState(_makeProjectFileGroupingState(mainClass, f, new File(filename), srcFiles));", "+    setFileGroupingState(_makeProjectFileGroupingState(mainClass, d, new File(filename), srcFiles));"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "4c9e650a85e27d82e1c38283eead402a", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/cache/DocumentCache.java", "commitBeforeChange": "d95e05b94bb85b9fefc27bcb5d21a4779fe83bf0", "commitAfterChange": "1b9869851f567b7b6474eabaac96584b4771f5f3", "methodNumberBeforeChange": 3, "methodNumberAfterChange": 3, "signatureBeforeChange": "   public synchronized void setCacheSize(int size)", "signatureAfterChange": "   public void setCacheSize(int size)", "diff": ["-  public synchronized void setCacheSize(int size) {", "+  public void setCacheSize(int size) {", "-    ", "-    CACHE_SIZE = size;", "-    DocManager current;", "-    if (_lru.size() > CACHE_SIZE) {", "-      ListIterator<DocManager> it = _lru.listIterator();", "-      int i = 1;", "-      while (it.hasNext()) {", "-        current = it.next();", "-        if (i > CACHE_SIZE) {", "-          current.kickOut();", "-          it.remove();", "-        }", "-        i++;", "+    int dist;", "+    DocManager[] removed = null;  // bogus initialization makes javac happy", "+    synchronized (this) {", "+      CACHE_SIZE = size;", "+      dist = _residentQueue.size() - CACHE_SIZE;", "+      if (dist > 0) { ", "+        removed = new DocManager[dist];", "+        for (int i = 0; i < dist; i++) removed[i] = _residentQueue.remove(0);", "+    if (dist > 0) kickOut(removed);"]}], "num": 14223}