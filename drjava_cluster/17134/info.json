{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "3317be2526685321d8a907e668fd95df", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "4298adc55a158e6557e8ca0828fc1041", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/definitions/indent/QuestionStartAfterOpenBrace.java", "commitBeforeChange": "6cf6212d2242fc41ac00a6496c1e1ba3b53de977", "commitAfterChange": "04e763507593a06a56de16c4b3641de0dbca16f7", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": "   boolean applyRule(DefinitionsDocument doc)", "signatureAfterChange": "   boolean applyRule(DefinitionsDocument doc)", "diff": ["-", "-    int here = doc.getCurrentLocation();", "-    int origin = doc.getReduced().absOffset();", "+    ", "+    int origin = doc.getCurrentLocation();", "+    //int origin = doc.getReduced().absOffset();", "-    doc.getReduced().move(lineStart - origin);", "-    IndentInfo info = doc.getReduced().getIndentInformation();", "-    doc.getReduced().move(origin - lineStart);", "-    ", "-    if ((!info.braceType.equals(IndentInfo.openSquiggly)) ||", "-        (info.distToBrace < 0)) {", "-      // Precondition not met: we should have a brace", "-      return false;", "+    synchronized(doc){", "+      doc.move(lineStart - origin);", "+      IndentInfo info = doc.getIndentInformation();", "+      doc.move(origin - lineStart);    ", "+      ", "+      if ((!info.braceType.equals(IndentInfo.openSquiggly)) ||", "+          (info.distToBrace < 0)) {", "+        // Precondition not met: we should have a brace", "+        return false;", "+      }", "+      int bracePos = lineStart - info.distToBrace;    ", "+      ", "+      // Get brace's end of line", "+      int braceEndLinePos = doc.getLineEndPos(bracePos);", "+      ", "+      // Get position of next non-WS char (not in comments)", "+      int nextNonWS = -1;", "+      try {", "+        nextNonWS = doc.getFirstNonWSCharPos(braceEndLinePos);", "+      }", "+      catch (BadLocationException e) {", "+        // This shouldn't happen", "+        throw new UnexpectedException(e);", "+      }", "+      ", "+      if (nextNonWS == DefinitionsDocument.ERROR_INDEX) {", "+        return true;", "+      }", "+      ", "+      return (nextNonWS >= lineStart);", "-    int bracePos = lineStart - info.distToBrace;    ", "-    ", "-    // Get brace's end of line", "-    int braceEndLinePos = doc.getLineEndPos(bracePos);", "-    ", "-    // Get position of next non-WS char (not in comments)", "-    int nextNonWS = -1;", "-    try {", "-      nextNonWS = doc.getFirstNonWSCharPos(braceEndLinePos);", "-    }", "-    catch (BadLocationException e) {", "-      // This shouldn't happen", "-      throw new UnexpectedException(e);", "-    }", "-    ", "-    if (nextNonWS == DefinitionsDocument.ERROR_INDEX) {", "-      return true;", "-    }", "-    ", "-    return (nextNonWS >= lineStart);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "d7609523e650544be2259df5f53135e6", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/definitions/indent/QuestionStartAfterOpenBrace.java", "commitBeforeChange": "6bfab9f5cad6f12d0935dd59b83d99bfc86909eb", "commitAfterChange": "5aacfadc90765b33349d6f9aff91d50fefd76986", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": "   boolean applyRule(AbstractDJDocument doc, int reason)", "signatureAfterChange": "   boolean applyRule(AbstractDJDocument doc, int reason)", "diff": ["-  boolean applyRule(AbstractDJDocument doc, int reason)", "-  {", "+  boolean applyRule(AbstractDJDocument doc, int reason)  {", "-    synchronized(doc){", "-      doc.move(lineStart - origin);", "-      IndentInfo info = doc.getIndentInformation();", "-      doc.move(origin - lineStart);    ", "-      ", "-      if ((!info.braceType.equals(IndentInfo.openSquiggly)) ||", "-          (info.distToBrace < 0)) {", "-        // Precondition not met: we should have a brace", "-        return false;", "-      }", "-      int bracePos = lineStart - info.distToBrace;    ", "-      ", "-      // Get brace's end of line", "-      int braceEndLinePos = doc.getLineEndPos(bracePos);", "-      ", "-      // Get position of next non-WS char (not in comments)", "-      int nextNonWS = -1;", "-      try {", "-        nextNonWS = doc.getFirstNonWSCharPos(braceEndLinePos);", "-      }", "-      catch (BadLocationException e) {", "-        // This shouldn't happen", "-        throw new UnexpectedException(e);", "-      }", "-      ", "-      if (nextNonWS == AbstractDJDocument.ERROR_INDEX) {", "-        return true;", "-      }", "-      ", "-      return (nextNonWS >= lineStart);", "+    doc.move(lineStart - origin);", "+    IndentInfo info = doc.getIndentInformation();", "+    doc.move(origin - lineStart);    ", "+    ", "+    if ((!info.braceType.equals(IndentInfo.openSquiggly)) ||", "+        (info.distToBrace < 0))", "+      // Precondition not met: we should have a brace", "+      return false;", "+    int bracePos = lineStart - info.distToBrace;    ", "+    ", "+    // Get brace's end of line", "+    int braceEndLinePos = doc.getLineEndPos(bracePos);", "+    ", "+    // Get position of next non-WS char (not in comments)", "+    int nextNonWS = -1;", "+    try { nextNonWS = doc.getFirstNonWSCharPos(braceEndLinePos); }", "+    catch (BadLocationException e) {", "+      // This shouldn't happen", "+      throw new UnexpectedException(e);", "+    ", "+    if (nextNonWS == AbstractDJDocument.ERROR_INDEX) return true;", "+    ", "+    return (nextNonWS >= lineStart);"]}], "num": 17134}