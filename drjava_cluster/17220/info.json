{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "75964a377e8d2a70971e8821b08be347", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "0d00197457c907a1f0994350b169e6c3", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/AbstractGlobalModel.java", "commitBeforeChange": "2df95ba3878ef76250864f343b7eb7cab010d660", "commitAfterChange": "be44bac66621552ed24a3cc6153888ca3b23f74f", "methodNumberBeforeChange": 247, "methodNumberAfterChange": 251, "signatureBeforeChange": "   public synchronized void addToBrowserHistory()", "signatureAfterChange": "   public synchronized void addToBrowserHistory()", "diff": ["+    int startPos = 0;  // required by javac", "+    int endPos = 0;    // required by javac", "+    File file = null;  // required by javac", "+    ", "-        final Position startPos = doc.createPosition(doc.getCaretPosition());", "-        final Position endPos = doc.createPosition(doc.getLineEndPos(doc.getCaretPosition()));", "-        getBrowserHistoryManager().addRegion(new SimpleDocumentRegion(doc, doc.getFile(), startPos.getOffset(), endPos.getOffset()));", "+        startPos = doc.createPosition(doc.getCaretPosition()).getOffset();", "+        endPos = doc.createPosition(doc.getLineEndPos(doc.getCaretPosition())).getOffset();", "+        file = doc.getFile();", "+      ", "+      getBrowserHistoryManager().addRegion(new SimpleDocumentRegion(doc, file, startPos, endPos));"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "2b929f5ab4c9f7bd6cb576359286c66f", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/MainFrame.java", "commitBeforeChange": "6d55d86705248616cac5b324a7c528485ceb6104", "commitAfterChange": "d9483f6c228cd09f3431ad6b50a3d96bdaf83832", "methodNumberBeforeChange": 166, "methodNumberAfterChange": 166, "signatureBeforeChange": "   public void toggleBookmark()", "signatureAfterChange": "   public void toggleBookmark()", "diff": ["-      if (r==null) {", "-        final Position startPos = doc.createPosition(startSel);", "-        final Position endPos = doc.createPosition(endSel);", "-        _model.getBookmarkManager().addRegion(new SimpleDocumentRegion(doc, doc.getFile(), startPos.getOffset(), endPos.getOffset()));", "+      if (r == null) {", "+        final Position startPos = doc.createWrappedPosition(startSel);", "+        final Position endPos = doc.createWrappedPosition(endSel);", "+        SimpleDocumentRegion newR = new SimpleDocumentRegion(doc, doc.getFile(), startPos.getOffset(), endPos.getOffset());", "+        _model.getBookmarkManager().addRegion(newR);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "7d9defb1137969f54dddfc9833495f01", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/AbstractGlobalModel.java", "commitBeforeChange": "7c4507413beb0e75cdce1379ffec8d0279bed992", "commitAfterChange": "d1bf0f940bc3d914d8d8293a0e85760984d7b371", "methodNumberBeforeChange": 156, "methodNumberAfterChange": 246, "signatureBeforeChange": "           public File getFile() throws FileMovedException", "signatureAfterChange": "   public synchronized void addToBrowserHistory()", "diff": ["-          public OpenDefinitionsDocument getDocument() { return odd; }", "-          public File getFile() throws FileMovedException { return odd.getFile(); }", "+  /** Add the current location to the browser history. */", "+  public synchronized void addToBrowserHistory() {", "+    final OpenDefinitionsDocument doc = getActiveDocument();", "+    ", "+    if (doc!=null) {", "+      doc.acquireReadLock();", "+      try {", "+        final Position startPos = doc.createPosition(doc.getCaretPosition());", "+        final Position endPos = doc.createPosition(doc.getLineEndPos(doc.getCaretPosition()));", "+        getBrowserHistoryManager().addRegion(new SimpleDocumentRegion(doc, doc.getFile(), startPos.getOffset(), endPos.getOffset()));", "+      }", "+      catch (FileMovedException fme) {", "+        throw new UnexpectedException(fme);", "+      }", "+      catch (BadLocationException ble) {", "+        throw new UnexpectedException(ble);", "+      }", "+      finally { doc.releaseReadLock(); }", "+    }"]}], "num": 17220}