{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "873c58c0fee376390bcc1898fd176a2d", "detectedBy": ["AST_HIERARCHICAL", "AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "7730bdc0d2aaa5131069d53e4917a8a7", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/util/swing/MatchWholeWordState.java", "commitBeforeChange": "82f2ed0c10073d0b45d405a9ea26c9aa3f37c661", "commitAfterChange": "6bfab9f5cad6f12d0935dd59b83d99bfc86909eb", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": "   public FindResult findNext()", "signatureAfterChange": "   public FindResult findNext()", "diff": ["-        if (!_searchBackwards) {", "-          setPosition(getCurrentOffset() + wordLength);", "-        }", "-        else {", "-          setPosition(getCurrentOffset() - wordLength);", "-        }", "+        if (!_searchBackwards) setPosition(getCurrentOffset() + wordLength);", "+        else setPosition(getCurrentOffset() - wordLength);", "-", "+      String searchDocument;", "-      String searchDocument = _doc.getText(0, _doc.getLength());", "+      _doc.acquireReadLock();", "+      try { searchDocument = _doc.getText(0, _doc.getLength()); }", "+      finally { _doc.releaseReadLock(); }", "-      if (indexOf(searchDocument, _findWord) != -1) {", "-        return findNextHelp(searchDocument, searchOriginLocation);", "-      }", "-      else {", "-        return new FindResult(_doc, -1, true);", "-      }", "+      if (indexOf(searchDocument, _findWord) == -1) return new FindResult(_doc, -1, true);", "+      return findNextHelp(searchDocument, searchOriginLocation);", "-    catch (BadLocationException e) {", "-      throw new RuntimeException(e.getMessage());", "-    }", "+    catch (BadLocationException e) { throw new RuntimeException(e.getMessage()); }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "af06889eb4c31398eacdf43094cb86e0", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/util/swing/FindAnyOccurrenceState.java", "commitBeforeChange": "82f2ed0c10073d0b45d405a9ea26c9aa3f37c661", "commitAfterChange": "6bfab9f5cad6f12d0935dd59b83d99bfc86909eb", "methodNumberBeforeChange": 2, "methodNumberAfterChange": 2, "signatureBeforeChange": "   private FindResult _findNextInAllDocs(Document docToSearch) throws BadLocationException", "signatureAfterChange": "   private FindResult _findNextInAllDocs(AbstractDocumentInterface docToSearch) throws BadLocationException", "diff": ["-  private FindResult _findNextInAllDocs(Document docToSearch) throws BadLocationException {", "+  private FindResult _findNextInAllDocs(AbstractDocumentInterface docToSearch) throws BadLocationException {", "-    else {", "-      String text = docToSearch.getText(0, docToSearch.getLength());", "-      String findWord = _findWord;", "-      if (!_matchCase) {", "-        text = text.toLowerCase();", "-        findWord = findWord.toLowerCase();", "-      }", "-      int index = !_searchBackwards ? text.indexOf(findWord) : text.lastIndexOf(findWord);", "-      if (index != -1) {", "-        // We found it in a different document, put the caret at the end of the", "-        // found word (if we're going forward).", "-        if (!_searchBackwards) index += findWord.length();", "-        return new FindResult(docToSearch, index, false);", "-      }", "-      else", "-        return _findNextInAllDocs(!_searchBackwards ? _docIterator.getNextDocument(docToSearch) :", "-                                    _docIterator.getPrevDocument(docToSearch));", "+    ", "+    String text;", "+    docToSearch.acquireReadLock();", "+    try { text = docToSearch.getText(0, docToSearch.getLength()); }", "+    finally { docToSearch.releaseReadLock(); }", "+    String findWord = _findWord;", "+    if (!_matchCase) {", "+      text = text.toLowerCase();", "+      findWord = findWord.toLowerCase();", "+    int index = !_searchBackwards ? text.indexOf(findWord) : text.lastIndexOf(findWord);", "+    ", "+    if (index != -1) {", "+      // We found it in a different document, put the caret at the end of the", "+      // found word (if we're going forward).", "+      if (!_searchBackwards) index += findWord.length();", "+      return new FindResult(docToSearch, index, false);", "+    }", "+    return _findNextInAllDocs(!_searchBackwards ? _docIterator.getNextDocument(docToSearch) :", "+                                _docIterator.getPrevDocument(docToSearch));"]}], "num": 22475}