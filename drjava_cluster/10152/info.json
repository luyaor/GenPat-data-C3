{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "924cfb271d1b0f1f6c885f60f8b2d803", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "171fe3b940723fe25fefb7c220c28ee0", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/DefaultGlobalModel.java", "commitBeforeChange": "9c56cd9d9775329b3a5e6a7701ab0c05369850af", "commitAfterChange": "a7a439f9a53360ece86e113cdb8203e5c8b2acda", "methodNumberBeforeChange": 153, "methodNumberAfterChange": 158, "signatureBeforeChange": "   public File[] getSourceRootSet()", "signatureAfterChange": "   public File[] getSourceRootSet()", "diff": ["-    synchronized (_documentsRepos) {", "-      for (OpenDefinitionsDocument doc: _documentsRepos.values()) {", "-        try {", "-          File root = doc.getSourceRoot();", "-          if (!roots.contains(root)) { roots.add(root); } // Don't add duplicate Files, based on path", "-        }", "-        catch (InvalidPackageException e) { /* file has invalid package statement; ignore it */ }", "+    OpenDefinitionsDocument[] docs;", "+    ", "+    synchronized (_documentsRepos) { docs =  _documentsRepos.valuesArray(new OpenDefinitionsDocument[0]); }", "+    for (OpenDefinitionsDocument doc: docs) {", "+      try {", "+        File root = doc.getSourceRoot();", "+        if (!roots.contains(root)) { roots.add(root); } // Don't add duplicate Files, based on path", "-      return roots.toArray(new File[0]);", "+      catch (InvalidPackageException e) { /* file has invalid package statement; ignore it */ }", "+    return roots.toArray(new File[0]);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "986780e1d24cabdea7c385c6c64092b0", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/DefaultGlobalModel.java", "commitBeforeChange": "e64e0f2febfc163cfb04eb35ce1134673166ab50", "commitAfterChange": "71b4e72a1b4feef5a2621bd09e829e0108d8d893", "methodNumberBeforeChange": 111, "methodNumberAfterChange": 111, "signatureBeforeChange": "   public boolean closeAllFiles()", "signatureAfterChange": "   public boolean closeAllFiles()", "diff": ["-    boolean keepClosing = true;", "-    Iterator<OpenDefinitionsDocument> odds = _documentsRepos.valuesIterator();", "-    while (odds.hasNext() &&  keepClosing) {", "-      OpenDefinitionsDocument next = odds.next();", "-      keepClosing = closeFile(next);", "-      odds = _documentsRepos.valuesIterator(); // call to closeFile can mutate Iterator, so generate a new \"current\" Iterator on each loop ", "-    }", "-    return keepClosing;", "+    Object[] docs; // Erasure bites! Should be: OpenDefinitionsDocument[] docs; ", "+    ", "+    synchronized (_documentsRepos) { docs = _documentsRepos.valuesArray(); }", "+    // cannot use values() method because loop removes elements", "+    ", "+    for (Object d : docs) {", "+      OpenDefinitionsDocument doc = (OpenDefinitionsDocument) d;", "+      boolean closed = closeFile(doc);  // modifies _documentRepos; cast forced by erasure", "+      if (! closed) return false;", "+    }", "+    return true;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "c81bdfede2c51e580fa36e481f884f0a", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/DefaultGlobalModel.java", "commitBeforeChange": "9c56cd9d9775329b3a5e6a7701ab0c05369850af", "commitAfterChange": "a7a439f9a53360ece86e113cdb8203e5c8b2acda", "methodNumberBeforeChange": 115, "methodNumberAfterChange": 120, "signatureBeforeChange": "   public boolean closeAllFiles()", "signatureAfterChange": "   public boolean closeAllFiles()", "diff": ["-    Object[] docs; // Erasure bites! Should be: OpenDefinitionsDocument[] docs; ", "+    OpenDefinitionsDocument[] docs;", "-    synchronized (_documentsRepos) { docs = _documentsRepos.valuesArray(); }", "-    // cannot use values() method because loop removes elements", "+    synchronized (_documentsRepos) { docs = _documentsRepos.valuesArray(new OpenDefinitionsDocument[0]); }", "-    for (Object d : docs) {", "-      OpenDefinitionsDocument doc = (OpenDefinitionsDocument) d;", "-      boolean closed = closeFile(doc);  // modifies _documentRepos; cast forced by erasure", "+    for (OpenDefinitionsDocument doc : docs) {", "+      boolean closed = closeFile(doc);  // modifies _documentsRepos"]}], "num": 10152}