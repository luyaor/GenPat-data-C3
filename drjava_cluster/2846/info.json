{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "01a75061edffd82ead792e5d13a96578", "detectedBy": ["AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "8bfe6128f7c5d3e743b8377ed41c326a", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/model/GlobalModelTestCase.java", "commitBeforeChange": "6e00bd0fe78b22f9b84f30182d050c16081947ef", "commitAfterChange": "d6801eea8d321f3e0015cdd20a1cba75837384cb", "methodNumberBeforeChange": 19, "methodNumberAfterChange": 14, "signatureBeforeChange": "   protected String interpret(String input) throws EditDocumentException", "signatureAfterChange": "   protected String interpret(String input) throws EditDocumentException", "diff": ["+    ", "-    interactionsDoc.insertText(interactionsDoc.getLength(), input, InteractionsDocument.DEFAULT_STYLE);", "+    Utilities.clearEventQueue();", "+    ", "+    interactionsDoc.setInProgress(false);  // for some reason, the inProgress state can be true when interpret is invoked", "+    interactionsDoc.append(input, InteractionsDocument.DEFAULT_STYLE);", "+    ", "+    Utilities.clearEventQueue();", "-    int newLineLen = System.getProperty(\"line.separator\").length();", "+    final int newLineLen = System.getProperty(\"line.separator\").length();", "-    TestListener listener = new TestListener() {", "-      public void interactionStarted() { interactionStartCount++; }", "-", "-      public void interactionEnded() {", "-        assertInteractionStartCount(1);", "-", "-        synchronized(this) {", "-          interactionEndCount++;", "-          this.notify();", "-        }", "-      }", "-", "-    };", "+    InteractionListener listener = new InteractionListener();", "+    listener.logInteractionStart();", "-      synchronized(listener) {", "-        _model.interpretCurrentInteraction();", "-        listener.wait();  // TODO: fix this naked wait which depends on being executed before interpreter finishes!", "-        ", "- /**///In previous versions of 1.5.0-beta compiler, several tests hang right here, because ", "- /////in DebugContextTest and JavaDebugInterpreterTest, the files that were being tested, ", "- /////for example, MonkeyStuff.java, was being compiled without the -g flag, so debugging was ", "- /////impossible. This happened because of a bug in the 1.5 compiler, which is now fixed in the new", "- /////version.", "-      }", "+      _model.interpretCurrentInteraction();", "+      listener.waitInteractionDone();", "-    catch (InterruptedException ie) {", "-      throw new UnexpectedException(ie);", "-    }", "+    catch (InterruptedException ie) { throw new UnexpectedException(ie); }", "+    Utilities.clearEventQueue();", "+    ", "-    final int resultsEndLocation = interactionsDoc.getLength() - newLineLen -", "-                                   interactionsDoc.getPrompt().length();", "-", "-    final int resultsLen = resultsEndLocation - resultsStartLocation;", "-    //System.out.println(\"resultsStartLoc = \" + resultsStartLocation + \" resultsEndLocation = \" + resultsEndLocation);", "-    // There was no output from this interaction", "-    if (resultsLen <= 0)", "-      return \"\";", "-    return interactionsDoc.getDocText(resultsStartLocation, resultsLen);", "+    interactionsDoc.acquireReadLock();", "+    try {", "+      final int resultsEndLocation = interactionsDoc.getLength() - newLineLen - interactionsDoc.getPrompt().length();", "+      ", "+      final int resultsLen = resultsEndLocation - resultsStartLocation;", "+      //System.out.println(\"resultsStartLoc = \" + resultsStartLocation + \" resultsEndLocation = \" + resultsEndLocation);", "+      // There was no output from this interaction", "+      if (resultsLen <= 0) return \"\";", "+      return interactionsDoc.getDocText(resultsStartLocation, resultsLen);", "+    }", "+    finally { interactionsDoc.releaseReadLock(); }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "bc9fcc090ba1b20da24817409ceae908", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/config/ConfigFrame.java", "commitBeforeChange": "034592db30d33c0ac1a392bea16579d041875914", "commitAfterChange": "35d9365226ba0771f8b6c75f7ce46695407e7805", "methodNumberBeforeChange": 24, "methodNumberAfterChange": 23, "signatureBeforeChange": "   private void _setupMiscPanel(ConfigPanel panel)", "signatureAfterChange": "   private void _setupMiscPanel(ConfigPanel panel)", "diff": ["+    // Working directory chooser and component", "+    JFileChooser dirChooser = new JFileChooser(_getWorkDir());", "+    dirChooser.setDialogTitle(\"Select\");", "+    dirChooser.setApproveButtonText(\"Select\");", "+    dirChooser.setFileSelectionMode(JFileChooser.FILES_AND_DIRECTORIES);", "+    dirChooser.setMultiSelectionEnabled(false);", "-                              _fileOptionChooser);", "-    workDir.setFileFilter(new FileFilter() {", "-      public boolean accept(File f) {", "-        if (f.isDirectory()) {", "-          return true;", "-        }", "-        return false;", "-      }", "-", "-      /**", "-       * @return A description of this filter to display", "-       */", "-      public String getDescription() {", "-        return \"Directories\";", "-      }", "-    });", "+                              dirChooser);", "+    workDir.setFileFilter(new DirectoryFilter());", "+    "]}], "num": 2846}