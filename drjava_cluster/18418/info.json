{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "aa07f3125a9fea635eccc9fc1a635842", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "a155b19ff6848276fbab8b1f8e5ed191", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/ExecuteExternalDialog.java", "commitBeforeChange": "fb852ee67c669f40a587804216508a1dfbe1be4b", "commitAfterChange": "f938008597ce54d16e4a865d30f8ef062ea55d2f", "methodNumberBeforeChange": 21, "methodNumberAfterChange": 19, "signatureBeforeChange": "      private JPanel makeCommandPane()", "signatureAfterChange": "      private JPanel makeCommandPane()", "diff": ["-            _tabbedPane.requestFocus();", "+            _cancelCommandButton.requestFocus();", "-    ", "+", "+    // work directory", "-            _insertCommandButton.setEnabled(false);", "-            if (_editMode) {", "-              _saveCommandButton.requestFocus();", "-            }", "-            else {", "-              _runCommandButton.requestFocus();", "-            }", "+            _commandDrJavaJarFileLine.requestFocus();", "+", "+    // .drjavajar file", "+    c.weightx = 0.0;", "+    c.weighty = 0.0;", "+    c.gridwidth = 1;", "+    c.insets = labelInsets;", "+    JLabel drJavaJarFileLabel = new JLabel(\".drjavajar file:\");", "+    gridbag.setConstraints(drJavaJarFileLabel, c);", "+    main.add(drJavaJarFileLabel);", "+    c.weightx = 1.0;", "+    c.weighty = 8.0;", "+    c.gridwidth = GridBagConstraints.RELATIVE;", "+    c.insets = compInsets;", "+    ", "+    _commandDrJavaJarFileLine = new JTextPane();", "+    // do not allow a newline", "+    _commandDrJavaJarFileLine.addKeyListener(new KeyListener() {", "+      public void keyPressed(KeyEvent e) {", "+        if (e.getKeyCode() == KeyEvent.VK_ENTER) {", "+          e.consume();", "+        }", "+        else if (e.getKeyCode() == KeyEvent.VK_TAB) {", "+          e.consume();", "+          if (e.isShiftDown()) {", "+            _commandWorkDirLine.requestFocus();", "+          }", "+          else {", "+            _insertCommandButton.setEnabled(false);", "+            if (_editMode) {", "+              _saveCommandButton.requestFocus();", "+            }", "+            else {", "+              _runCommandButton.requestFocus();", "+            }", "+          }", "+        }", "+      }", "+      public void  keyReleased(KeyEvent e) { }", "+      public void  keyTyped(KeyEvent e) { }", "+    });", "+    JScrollPane commandDrJavaJarFileLineSP = new JScrollPane(_commandDrJavaJarFileLine);", "+    commandDrJavaJarFileLineSP.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED);", "+    gridbag.setConstraints(commandDrJavaJarFileLineSP, c);", "+    main.add(commandDrJavaJarFileLineSP);", "+    ", "+    c.weightx = 0.0;", "+    c.weighty = 0.0;", "+    c.gridwidth = GridBagConstraints.REMAINDER;", "+    c.insets = compInsets;", "+    ", "+    _commandDrJavaJarFileBtn = new JButton(\"...\");", "+    _commandDrJavaJarFileBtn.addActionListener(new ActionListener() {", "+      public void actionPerformed(ActionEvent e) { chooseFile(_commandDrJavaJarFileLine); }", "+    });", "+    gridbag.setConstraints(_commandDrJavaJarFileBtn, c);", "+    main.add(_commandDrJavaJarFileBtn);", "+    ", "+    c.weightx = 0.0;", "+    c.weighty = 0.0;", "+    c.gridwidth = 1;", "+    c.insets = labelInsets;", "+    JLabel commandDrJavaJarFileLinePreviewLabel = new JLabel(\".drjavajar file preview:\");", "+    commandDrJavaJarFileLinePreviewLabel.setToolTipText(STALE_TOOLTIP);", "+    gridbag.setConstraints(commandDrJavaJarFileLinePreviewLabel, c);", "+    main.add(commandDrJavaJarFileLinePreviewLabel);", "+    ", "+    c.weightx = 1.0;", "+    c.weighty = 8.0;", "+    c.gridwidth = GridBagConstraints.REMAINDER;", "+    c.insets = compInsets;", "+    ", "+    _commandDrJavaJarFileLinePreview = new JTextPane();", "+    _commandDrJavaJarFileLinePreview.setToolTipText(STALE_TOOLTIP);", "+    _commandDrJavaJarFileLineDoc = (StyledDocument)_commandDrJavaJarFileLinePreview.getDocument();", "+    ", "+    _commandDrJavaJarFileLinePreview.setEditable(false);", "+    _commandDrJavaJarFileLinePreview.setBackground(Color.LIGHT_GRAY);", "+    _commandDrJavaJarFileLinePreview.setSelectedTextColor(Color.LIGHT_GRAY);", "+    JScrollPane commandDrJavaJarFileLinePreviewSP = new JScrollPane(_commandDrJavaJarFileLinePreview);", "+    commandDrJavaJarFileLinePreviewSP.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED);", "+    gridbag.setConstraints(commandDrJavaJarFileLinePreviewSP, c);", "+    main.add(commandDrJavaJarFileLinePreviewSP);", "+    ", "+    // bottom panel", "-          String text = StringOps.replaceVariables(_commandLine.getText(), PropertyMaps.ONLY, PropertyMaps.TO_STRING);", "+          String text = StringOps.replaceVariables(_commandLine.getText(), _props, PropertyMaps.GET_LAZY);", "-          _commandLineDoc.insertString(_commandLineDoc.getLength(), StringOps.unescapeSpacesWith1bHex(text), null);", "+          _commandLineDoc.insertString(_commandLineDoc.getLength(), StringOps.unescapeFileName(text), null);", "-                         PropertyMaps.ONLY,", "+                         _props,", "-    // update the preview of the actual command line post substitution", "+    // update the preview of the actual work directory post substitution", "-          String text = StringOps.replaceVariables(_commandWorkDirLine.getText(), PropertyMaps.ONLY, PropertyMaps.TO_STRING);", "-          _commandWorkDirLineDoc.insertString(0, StringOps.unescapeSpacesWith1bHex(text), null);", "+          String text = StringOps.replaceVariables(_commandWorkDirLine.getText(), _props, PropertyMaps.GET_LAZY);", "+          _commandWorkDirLineDoc.insertString(0, StringOps.unescapeFileName(text), null);", "-                         PropertyMaps.ONLY,", "+                         _props,", "-    DrJava.getConfig().addOptionListener(DEFINITIONS_COMMENT_COLOR, new OptionListener<Color>() {", "-      public void optionChanged(OptionEvent<Color> oce) {", "-        StyleConstants.setForeground(_javaCommandLineExecutableStyle, oce.value);", "-        _documentListener.changedUpdate(null);", "-        _workDirDocumentListener.changedUpdate(null);", "+    // update the preview of the actual .drjavajar file post substitution", "+    _drJavaJarFileDocumentListener = new DocumentListener() {", "+      public void update(DocumentEvent e) {", "+        try {", "+          // preview", "+          _commandDrJavaJarFileLineDoc.remove(0,_commandDrJavaJarFileLineDoc.getLength());", "+          String text = StringOps.replaceVariables(_commandDrJavaJarFileLine.getText(), _props, PropertyMaps.GET_LAZY);", "+          _commandDrJavaJarFileLineDoc.insertString(0, StringOps.unescapeFileName(text), null);", "+          ", "+          // command line", "+          colorVariables(_commandDrJavaJarFileLine,", "+                         _props,", "+                         this,", "+                         _commandLineCmdAS,", "+                         _varCommandLineCmdStyle,", "+                         _varErrorCommandLineCmdStyle);", "+        }", "+        catch(BadLocationException ble) {", "+          _commandLinePreview.setText(\"Error: \"+ble);", "+        }", "-    });", "-    DrJava.getConfig().addOptionListener(DEFINITIONS_KEYWORD_COLOR, new OptionListener<Color>() {", "-      public void optionChanged(OptionEvent<Color> oce) {", "-        StyleConstants.setForeground(_javaCommandLineJVMStyle, oce.value);", "-        _documentListener.changedUpdate(null);", "-        _workDirDocumentListener.changedUpdate(null);", "-      }", "-    });", "+      public void changedUpdate(DocumentEvent e) { update(e); }", "+      public void insertUpdate(DocumentEvent e) { update(e); }", "+      public void removeUpdate(DocumentEvent e)  { update(e); }", "+    };", "+    _commandDrJavaJarFileLine.getDocument().addDocumentListener(_drJavaJarFileDocumentListener);", "+    _commandDrJavaJarFileLine.setText(\"\");", "+    _drJavaJarFileDocumentListener.changedUpdate(null);", "-        }", "-      }", "-    });", "-    ", "-    return panel;", "-  }"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "c3d83edc5aa7537129b132df79d5c5be", "repository": "http://git.code.sf.net/p/drjava/git_repo", "fileName": "drjava/src/edu/rice/cs/drjava/ui/ExecuteExternalDialog.java", "commitBeforeChange": "51e8f4cbce06d140e9a09dd38237b848b4f27d8a", "commitAfterChange": "d350dd729092f66f8ad737ae377c54d2ad394fbf", "methodNumberBeforeChange": 19, "methodNumberAfterChange": 19, "signatureBeforeChange": "      private JPanel makeCommandPane()", "signatureAfterChange": "      private JPanel makeCommandPane()", "diff": ["-            _commandDrJavaJarFileLine.requestFocus();", "+            _commandEnclosingFileLine.requestFocus();", "-    // .drjavajar file", "+    // enclosing .djapp file", "-    JLabel drJavaJarFileLabel = new JLabel(\".drjavajar file:\");", "-    gridbag.setConstraints(drJavaJarFileLabel, c);", "-    main.add(drJavaJarFileLabel);", "+    JLabel enclosingFileLabel = new JLabel(\"Enclosing .djapp file:\");", "+    gridbag.setConstraints(enclosingFileLabel, c);", "+    main.add(enclosingFileLabel);", "-    _commandDrJavaJarFileLine = new JTextPane();", "+    _commandEnclosingFileLine = new JTextPane();", "-    _commandDrJavaJarFileLine.addKeyListener(new KeyListener() {", "+    _commandEnclosingFileLine.addKeyListener(new KeyListener() {", "-    JScrollPane commandDrJavaJarFileLineSP = new JScrollPane(_commandDrJavaJarFileLine);", "-    commandDrJavaJarFileLineSP.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED);", "-    gridbag.setConstraints(commandDrJavaJarFileLineSP, c);", "-    main.add(commandDrJavaJarFileLineSP);", "+    JScrollPane commandEnclosingFileLineSP = new JScrollPane(_commandEnclosingFileLine);", "+    commandEnclosingFileLineSP.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED);", "+    gridbag.setConstraints(commandEnclosingFileLineSP, c);", "+    main.add(commandEnclosingFileLineSP);", "-    _commandDrJavaJarFileBtn = new JButton(\"...\");", "-    _commandDrJavaJarFileBtn.addActionListener(new ActionListener() {", "-      public void actionPerformed(ActionEvent e) { chooseFile(_commandDrJavaJarFileLine); }", "+    _commandEnclosingFileBtn = new JButton(\"...\");", "+    _commandEnclosingFileBtn.addActionListener(new ActionListener() {", "+      public void actionPerformed(ActionEvent e) { chooseFile(_commandEnclosingFileLine); }", "-    gridbag.setConstraints(_commandDrJavaJarFileBtn, c);", "-    main.add(_commandDrJavaJarFileBtn);", "+    gridbag.setConstraints(_commandEnclosingFileBtn, c);", "+    main.add(_commandEnclosingFileBtn);", "-    JLabel commandDrJavaJarFileLinePreviewLabel = new JLabel(\".drjavajar file preview:\");", "-    commandDrJavaJarFileLinePreviewLabel.setToolTipText(STALE_TOOLTIP);", "-    gridbag.setConstraints(commandDrJavaJarFileLinePreviewLabel, c);", "-    main.add(commandDrJavaJarFileLinePreviewLabel);", "+    JLabel commandEnclosingFileLinePreviewLabel = new JLabel(\"Enclosing .djapp file preview:\");", "+    commandEnclosingFileLinePreviewLabel.setToolTipText(STALE_TOOLTIP);", "+    gridbag.setConstraints(commandEnclosingFileLinePreviewLabel, c);", "+    main.add(commandEnclosingFileLinePreviewLabel);", "-    _commandDrJavaJarFileLinePreview = new JTextPane();", "-    _commandDrJavaJarFileLinePreview.setToolTipText(STALE_TOOLTIP);", "-    _commandDrJavaJarFileLineDoc = (StyledDocument)_commandDrJavaJarFileLinePreview.getDocument();", "+    _commandEnclosingFileLinePreview = new JTextPane();", "+    _commandEnclosingFileLinePreview.setToolTipText(STALE_TOOLTIP);", "+    _commandEnclosingFileLineDoc = (StyledDocument)_commandEnclosingFileLinePreview.getDocument();", "-    _commandDrJavaJarFileLinePreview.setEditable(false);", "-    _commandDrJavaJarFileLinePreview.setBackground(Color.LIGHT_GRAY);", "-    _commandDrJavaJarFileLinePreview.setSelectedTextColor(Color.LIGHT_GRAY);", "-    JScrollPane commandDrJavaJarFileLinePreviewSP = new JScrollPane(_commandDrJavaJarFileLinePreview);", "-    commandDrJavaJarFileLinePreviewSP.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED);", "-    gridbag.setConstraints(commandDrJavaJarFileLinePreviewSP, c);", "-    main.add(commandDrJavaJarFileLinePreviewSP);", "+    _commandEnclosingFileLinePreview.setEditable(false);", "+    _commandEnclosingFileLinePreview.setBackground(Color.LIGHT_GRAY);", "+    _commandEnclosingFileLinePreview.setSelectedTextColor(Color.LIGHT_GRAY);", "+    JScrollPane commandEnclosingFileLinePreviewSP = new JScrollPane(_commandEnclosingFileLinePreview);", "+    commandEnclosingFileLinePreviewSP.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED);", "+    gridbag.setConstraints(commandEnclosingFileLinePreviewSP, c);", "+    main.add(commandEnclosingFileLinePreviewSP);", "-    // update the preview of the actual .drjavajar file post substitution", "-    _drJavaJarFileDocumentListener = new DocumentListener() {", "+    // update the preview of the actual enclosing .djapp file post substitution", "+    _enclosingFileDocumentListener = new DocumentListener() {", "-          _commandDrJavaJarFileLineDoc.remove(0,_commandDrJavaJarFileLineDoc.getLength());", "-          String text = StringOps.replaceVariables(_commandDrJavaJarFileLine.getText(), _props, PropertyMaps.GET_LAZY);", "-          _commandDrJavaJarFileLineDoc.insertString(0, StringOps.unescapeFileName(text), null);", "+          _commandEnclosingFileLineDoc.remove(0,_commandEnclosingFileLineDoc.getLength());", "+          String text = StringOps.replaceVariables(_commandEnclosingFileLine.getText(), _props, PropertyMaps.GET_LAZY);", "+          _commandEnclosingFileLineDoc.insertString(0, StringOps.unescapeFileName(text), null);", "-          colorVariables(_commandDrJavaJarFileLine,", "+          colorVariables(_commandEnclosingFileLine,", "-    _commandDrJavaJarFileLine.getDocument().addDocumentListener(_drJavaJarFileDocumentListener);", "-    _commandDrJavaJarFileLine.setText(\"\");", "-    _drJavaJarFileDocumentListener.changedUpdate(null);", "+    _commandEnclosingFileLine.getDocument().addDocumentListener(_enclosingFileDocumentListener);", "+    _commandEnclosingFileLine.setText(\"\");", "+    _enclosingFileDocumentListener.changedUpdate(null);"]}], "num": 18418}