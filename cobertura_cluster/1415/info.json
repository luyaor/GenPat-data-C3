{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "3f186d6c3725330ce9b2fa97d2d614d8", "detectedBy": ["DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "eb553a699c139ee532d3c414fce2d790", "repository": "https://github.com/cobertura/cobertura.git", "fileName": "cobertura/src/net/sourceforge/cobertura/coveragedata/ProjectData.java", "commitBeforeChange": "5b30351fa9d71ab4016d2fcbdce172b2f16c1c45", "commitAfterChange": "55571e8b292791cc80dd02e2bed0dfd9f206376b", "methodNumberBeforeChange": 11, "methodNumberAfterChange": 12, "signatureBeforeChange": "  \tpublic static void saveGlobalProjectData()", "signatureAfterChange": "  \tpublic static void saveGlobalProjectData()", "diff": ["-\t\tProjectData projectData = getGlobalProjectData();", "-\t\tsynchronized (projectData)", "+\t\tProjectData projectDataToSave = globalProjectData;", "+", "+\t\t/*", "+\t\t * The next statement is not necessary at the moment, because this method is only called", "+\t\t * either at the very beginning or at the very end of a test.  If the code is changed", "+\t\t * to save more frequently, then this will become important.", "+\t\t */", "+\t\tglobalProjectData = new ProjectData();", "+", "+\t\t/*", "+\t\t * Now sleep a bit in case there is a thread still holding a reference to the \"old\"", "+\t\t * globalProjectData (now referenced with projectDataToSave).  ", "+\t\t * We want it to finish its updates.  I assume 2 seconds is plenty of time.", "+\t\t */", "+\t\ttry", "-\t\t\tCoverageDataFileHandler.saveCoverageData(projectData,", "-\t\t\t\t\tCoverageDataFileHandler.getDefaultDataFile());", "+\t\t\tThread.sleep(1000);", "+\t\tcatch (InterruptedException e)", "+\t\t{", "+\t\t}", "+", "+\t\tFile dataFile = CoverageDataFileHandler.getDefaultDataFile();", "+\t\tFileLocker lock = new FileLocker(dataFile);", "+\t\tif (lock.lock())", "+\t\t{", "+\t\t\tProjectData datafileProjectData = loadCoverageDataFromDatafile(dataFile);", "+\t\t\tif (datafileProjectData == null)", "+\t\t\t{", "+\t\t\t\tdatafileProjectData = projectDataToSave;", "+\t\t\t}", "+\t\t\telse", "+\t\t\t{", "+\t\t\t\tdatafileProjectData.merge(projectDataToSave);", "+\t\t\t}", "+\t\t\tCoverageDataFileHandler.saveCoverageData(datafileProjectData, dataFile);", "+\t\t}", "+\t\tlock.release();", "+\t}"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "f4e4fe0bbea4d0d9e519ef0ec5a217dc", "repository": "https://github.com/cobertura/cobertura.git", "fileName": "cobertura/src/net/sourceforge/cobertura/coveragedata/ProjectData.java", "commitBeforeChange": "7ff4cde6cb6b71f99139358732f26e11af99b113", "commitAfterChange": "f90dcd457e7e66ecdf6df44376f8d08fea15db73", "methodNumberBeforeChange": 12, "methodNumberAfterChange": 11, "signatureBeforeChange": "  \tpublic static void saveGlobalProjectData()", "signatureAfterChange": "  \tpublic static void saveGlobalProjectData()", "diff": ["-\t\tProjectData projectDataToSave = null;", "-\t\t", "-\t\tglobalProjectDataLock.lock();", "-\t\ttry", "-\t\t{", "-\t\t\tprojectDataToSave = globalProjectData;", "-\t", "-\t\t\t/*", "-\t\t\t * The next statement is not necessary at the moment, because this method is only called", "-\t\t\t * either at the very beginning or at the very end of a test.  If the code is changed", "-\t\t\t * to save more frequently, then this will become important.", "-\t\t\t */", "-\t\t\tglobalProjectData = new ProjectData();", "-\t\t}", "-\t\tfinally", "-\t\t{", "-\t\t\tglobalProjectDataLock.unlock();", "-\t\t}", "-", "-\t\t/*", "-\t\t * Now sleep a bit in case there is a thread still holding a reference to the \"old\"", "-\t\t * globalProjectData (now referenced with projectDataToSave).  ", "-\t\t * We want it to finish its updates.  I assume 1 second is plenty of time.", "-\t\t */", "-\t\ttry", "-\t\t{", "-\t\t\tThread.sleep(1000);", "-\t\t}", "-\t\tcatch (InterruptedException e)", "-\t\t{", "-\t\t}", "+\t\tProjectData projectDataToSave = new ProjectData();"]}]}