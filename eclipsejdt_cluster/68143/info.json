{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "9d0c8e6ff44f3c07df1d7623228529ea", "detectedBy": ["AST_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "041ceafaa3cf517e3d9341265c94cb6c", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/formatter/org/eclipse/jdt/internal/formatter/Scribe.java", "commitBeforeChange": "4a6b3839c123ba52c0418c6a1716f84ca2fa40ee", "commitAfterChange": "7ab66ec659aff4e2eeafa10fb6d8c45a18f899f6", "methodNumberBeforeChange": 17, "methodNumberAfterChange": 17, "signatureBeforeChange": " \tpublic void printBlockComment(char[] s, int commentStart)", "signatureAfterChange": " \tpublic void printBlockComment(char[] s, int commentStart)", "diff": ["+\t\tint currentTokenStartPosition = this.scanner.getCurrentTokenStartPosition();", "+\t\tint currentTokenEndPosition = this.scanner.getCurrentTokenEndPosition() + 1;", "+\t\t", "-\t\t\t\t// add position mapping", "-\t\t\t\tString reduceLine = lineContents.trim();", "-\t\t\t\tfinal int reduceLineLength = reduceLine.length();", "-\t\t\t\tif (this.positionsToMap != null) {", "-\t\t\t\t\tint start = commentSource.indexOf(reduceLine, startSearchIndex);", "-\t\t\t\t\tmapPositions(start + commentStart, this.buffer.length(), reduceLineLength);", "-\t\t\t\t\tstartSearchIndex = start + reduceLineLength + 1;", "+\t\t\t\t// remove leading whitespaces", "+\t\t\t\tint lineStartPosition = currentTokenStartPosition + commentSource.indexOf(lineContents, startSearchIndex);", "+\t\t\t\tthis.scanner.resetTo(lineStartPosition, this.scannerEndPosition - 1);", "+\t\t\t\tString reduceLine = null;", "+\t\t\t\ttry {", "+\t\t\t\t\tif (this.scanner.getNextToken() == ITerminalSymbols.TokenNameWHITESPACE) {", "+\t\t\t\t\t\tint begin = this.scanner.getCurrentTokenEndPosition() + 1 - lineStartPosition;", "+\t\t\t\t\t\tif (begin < lineContents.length()) {", "+\t\t\t\t\t\t\treduceLine = lineContents.substring(begin);", "+\t\t\t\t\t\t} else {", "+\t\t\t\t\t\t\treduceLine = \"\"; //$NON-NLS-1$", "+\t\t\t\t\t\t}", "+\t\t\t\t\t} else {", "+\t\t\t\t\t\treduceLine = lineContents;", "+\t\t\t\t\t}", "+\t\t\t\t} catch (InvalidInputException e) {", "+\t\t\t\t\t// should not happen", "+\t\t\t\tfinal int reduceLineLength = reduceLine.length();", "+\t\t\t\t// add position mapping", "+\t\t\t\tint start = commentSource.indexOf(reduceLine, startSearchIndex);", "+\t\t\t\tif (this.positionsToMap != null) {", "+\t\t\t\t\tmapPositions(start + commentStart, this.buffer.length(), reduceLineLength);", "+\t\t\t\t}", "+\t\t\t\tstartSearchIndex = start + reduceLineLength + 1;", "+\t\tthis.scanner.resetTo(currentTokenEndPosition, this.scannerEndPosition - 1);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "366517a1c33860d932c697500943dca6", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/dom/org/eclipse/jdt/internal/core/dom/rewrite/ASTRewriteAnalyzer.java", "commitBeforeChange": "ce1a50c038f410b16a75eb29a8e1c64f33a61360", "commitAfterChange": "e0b71f0955015294aa51eae2753decb6574d6e98", "methodNumberBeforeChange": 47, "methodNumberAfterChange": 47, "signatureBeforeChange": "  \t\tpublic final int rewriteList(ASTNode parent, StructuralPropertyDescriptor property, int offset, String keyword)", "signatureAfterChange": "  \t\tpublic final int rewriteList(ASTNode parent, StructuralPropertyDescriptor property, int offset, String keyword)", "diff": ["+\t\t\t\t\t// https://bugs.eclipse.org/bugs/show_bug.cgi?id=306524", "+\t\t\t\t\t// Check for leading comments that are not part of extended range, and prevent them", "+\t\t\t\t\t// from getting removed.", "+\t\t\t\t\ttry {", "+\t\t\t\t\t\tTokenScanner scanner = getScanner();", "+\t\t\t\t\t\tint newOffset = prevEnd;", "+\t\t\t\t\t\tint extendedOffset = getExtendedOffset(node);", "+\t\t\t\t\t\t// Try to find the end of the last comment which is not part of extended source", "+\t\t\t\t\t\t// range of the node.", "+\t\t\t\t\t\twhile (TokenScanner.isComment(scanner.readNext(newOffset, false))) {", "+\t\t\t\t\t\t\tint tempOffset = scanner.getNextEndOffset(newOffset, false);", "+\t\t\t\t\t\t\t// check whether the comment is part of extended source range of the node.", "+\t\t\t\t\t\t\t// If it is then we need to stop.", "+\t\t\t\t\t\t\tif (tempOffset < extendedOffset) {", "+\t\t\t\t\t\t\t\tnewOffset = tempOffset;", "+\t\t\t\t\t\t\t} else {", "+\t\t\t\t\t\t\t\tbreak;", "+\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t}", "+\t\t\t\t\t\tif (currPos < newOffset) {", "+\t\t\t\t\t\t\tcurrPos = extendedOffset;", "+\t\t\t\t\t\t} ", "+\t\t\t\t\t\tprevEnd = newOffset;\t\t", "+\t\t\t\t\t} catch (CoreException e) {", "+\t\t\t\t\t\t// ignore", "+\t\t\t\t\t}", "+\t\t\t\t\t\t// https://bugs.eclipse.org/bugs/show_bug.cgi?id=306524", "+\t\t\t\t\t\t// Check for trailing comments that are not part of extended range, and prevent them", "+\t\t\t\t\t\t// from getting removed.", "+\t\t\t\t\t\ttry {", "+\t\t\t\t\t\t\tTokenScanner scanner = getScanner();", "+\t\t\t\t\t\t\tint nextToken= scanner.readNext(currEnd, false);", "+\t\t\t\t\t\t\tif (TokenScanner.isComment(nextToken)) {", "+\t\t\t\t\t\t\t\t// the separator also has comments that are not part of extended", "+\t\t\t\t\t\t\t\t// source range of this node or the next node. So dont remove the separator", "+\t\t\t\t\t\t\t\tif (end != scanner.getNextStartOffset(currEnd, false)) {", "+\t\t\t\t\t\t\t\t\t// If this condition were true, comments just found as part of the separator would've basically been", "+\t\t\t\t\t\t\t\t\t// part of the extended source range of the next node. So 'end' wud've safely been set to the correct position", "+\t\t\t\t\t\t\t\t\t// and no change is needed.", "+\t\t\t\t\t\t\t\t\tend = currEnd;", "+\t\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t} catch (CoreException e) {", "+\t\t\t\t\t\t\t// ignore", "+\t\t\t\t\t\t}"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "6d060b8a222c6a025e394da75e7c7411", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/dom/org/eclipse/jdt/internal/core/dom/rewrite/ASTRewriteAnalyzer.java", "commitBeforeChange": "3e22d4d529a535a246fe403256ff1dc4151cc248", "commitAfterChange": "14ae0f182797d2ba7f6b9ecff74cd13258c4bc42", "methodNumberBeforeChange": 47, "methodNumberAfterChange": 47, "signatureBeforeChange": "  \t\tpublic final int rewriteList(ASTNode parent, StructuralPropertyDescriptor property, int offset, String keyword)", "signatureAfterChange": "  \t\tpublic final int rewriteList(ASTNode parent, StructuralPropertyDescriptor property, int offset, String keyword)", "diff": ["-\t\t\t\t\t\t", "+\t\t\t\t\t\t// make sure that comments between last modified source position and extended starting position of", "+\t\t\t\t\t\t// node to be replaced are not touched", "+\t\t\t\t\t\ttry {", "+\t\t\t\t\t\t\tTokenScanner scanner = getScanner();", "+\t\t\t\t\t\t\tint newOffset = prevEnd;", "+\t\t\t\t\t\t\tint extendedOffset = getExtendedOffset(node);", "+\t\t\t\t\t\t\t// Try to find the end of the last comment which is not part of extended source", "+\t\t\t\t\t\t\t// range of the node.", "+\t\t\t\t\t\t\twhile (TokenScanner.isComment(scanner.readNext(newOffset, false))) {", "+\t\t\t\t\t\t\t\tint tempOffset = scanner.getNextEndOffset(newOffset, false);", "+\t\t\t\t\t\t\t\t// check whether the comment is part of extended source range of the node.", "+\t\t\t\t\t\t\t\t// If it is then we need to stop.", "+\t\t\t\t\t\t\t\tif (tempOffset < extendedOffset) {", "+\t\t\t\t\t\t\t\t\tnewOffset = tempOffset;", "+\t\t\t\t\t\t\t\t} else {", "+\t\t\t\t\t\t\t\t\tbreak;", "+\t\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\tif (currPos < newOffset) {", "+\t\t\t\t\t\t\t\tcurrPos = extendedOffset;", "+\t\t\t\t\t\t\t} \t\t", "+\t\t\t\t\t\t} catch (CoreException e) {", "+\t\t\t\t\t\t\t// ignore", "+\t\t\t\t\t\t}"]}], "num": 68143}