{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "94aae10c6be3182b9d331f549e2a05dc", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "54c07eb058c4029763f8dead8d80a5b7", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/model/org/eclipse/jdt/internal/core/ProjectReferenceChange.java", "commitBeforeChange": "bf5fdbab3898ef946bf2a56347acd790a3f7a7bd", "commitAfterChange": "bb09a0a12eeeef679eb6c43515683a3f275882d3", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": " \tpublic void updateProjectReferencesIfNecessary() throws JavaModelException", "signatureAfterChange": " \tpublic void updateProjectReferencesIfNecessary() throws JavaModelException", "diff": ["-\t\tString[] oldRequired = this.oldResolvedClasspath == null ? CharOperation.NO_STRINGS : this.project.projectPrerequisites(this.oldResolvedClasspath);", "+\t\tfinal String[] oldRequired = this.oldResolvedClasspath == null ? CharOperation.NO_STRINGS : this.project.projectPrerequisites(this.oldResolvedClasspath);", "-\t\tString[] newRequired = this.project.projectPrerequisites(newResolvedClasspath);", "-\t\ttry {", "-\t\t\tIProject projectResource = this.project.getProject();", "-\t\t\tIProjectDescription description = projectResource.getDescription();", "-\t\t\t ", "-\t\t\tIProject[] projectReferences = description.getDynamicReferences();", "-\t\t\t", "-\t\t\tHashSet oldReferences = new HashSet(projectReferences.length);", "-\t\t\tfor (int i = 0; i < projectReferences.length; i++){", "-\t\t\t\tString projectName = projectReferences[i].getName();", "-\t\t\t\toldReferences.add(projectName);", "-\t\t\t}", "-\t\t\tHashSet newReferences = (HashSet)oldReferences.clone();", "-\t", "-\t\t\tfor (int i = 0; i < oldRequired.length; i++){", "-\t\t\t\tString projectName = oldRequired[i];", "-\t\t\t\tnewReferences.remove(projectName);", "-\t\t\t}", "-\t\t\tfor (int i = 0; i < newRequired.length; i++){", "-\t\t\t\tString projectName = newRequired[i];", "-\t\t\t\tnewReferences.add(projectName);", "-\t\t\t}", "-\t", "-\t\t\tIterator iter;", "-\t\t\tint newSize = newReferences.size();", "-\t\t\t", "-\t\t\tcheckIdentity: {", "-\t\t\t\tif (oldReferences.size() == newSize){", "-\t\t\t\t\titer = newReferences.iterator();", "-\t\t\t\t\twhile (iter.hasNext()){", "-\t\t\t\t\t\tif (!oldReferences.contains(iter.next())){", "-\t\t\t\t\t\t\tbreak checkIdentity;", "-\t\t\t\t\t\t}", "-\t\t\t\t\t}", "-\t\t\t\t\treturn;", "+\t\tfinal String[] newRequired = this.project.projectPrerequisites(newResolvedClasspath);", "+\t\tfinal IProject projectResource = this.project.getProject();", "+\t\tIWorkspaceRunnable runnable = new IWorkspaceRunnable() {", "+\t\t\tpublic void run(IProgressMonitor monitor) throws CoreException {", "+\t\t\t\tIProjectDescription description = projectResource.getDescription();", "+\t\t\t\t ", "+\t\t\t\tIProject[] projectReferences = description.getDynamicReferences();", "+\t\t\t\t", "+\t\t\t\tHashSet oldReferences = new HashSet(projectReferences.length);", "+\t\t\t\tfor (int i = 0; i < projectReferences.length; i++){", "+\t\t\t\t\tString projectName = projectReferences[i].getName();", "+\t\t\t\t\toldReferences.add(projectName);", "+\t\t\t\tHashSet newReferences = (HashSet)oldReferences.clone();", "+\t\t", "+\t\t\t\tfor (int i = 0; i < oldRequired.length; i++){", "+\t\t\t\t\tString projectName = oldRequired[i];", "+\t\t\t\t\tnewReferences.remove(projectName);", "+\t\t\t\t}", "+\t\t\t\tfor (int i = 0; i < newRequired.length; i++){", "+\t\t\t\t\tString projectName = newRequired[i];", "+\t\t\t\t\tnewReferences.add(projectName);", "+\t\t\t\t}", "+\t\t", "+\t\t\t\tIterator iter;", "+\t\t\t\tint newSize = newReferences.size();", "+\t\t\t\t", "+\t\t\t\tcheckIdentity: {", "+\t\t\t\t\tif (oldReferences.size() == newSize){", "+\t\t\t\t\t\titer = newReferences.iterator();", "+\t\t\t\t\t\twhile (iter.hasNext()){", "+\t\t\t\t\t\t\tif (!oldReferences.contains(iter.next())){", "+\t\t\t\t\t\t\t\tbreak checkIdentity;", "+\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t}", "+\t\t\t\t\t\treturn;", "+\t\t\t\t\t}", "+\t\t\t\t}", "+\t\t\t\tString[] requiredProjectNames = new String[newSize];", "+\t\t\t\tint index = 0;", "+\t\t\t\titer = newReferences.iterator();", "+\t\t\t\twhile (iter.hasNext()){", "+\t\t\t\t\trequiredProjectNames[index++] = (String)iter.next();", "+\t\t\t\t}", "+\t\t\t\tUtil.sort(requiredProjectNames); // ensure that if changed, the order is consistent", "+\t\t\t\t", "+\t\t\t\tIProject[] requiredProjectArray = new IProject[newSize];", "+\t\t\t\tIWorkspaceRoot wksRoot = projectResource.getWorkspace().getRoot();", "+\t\t\t\tfor (int i = 0; i < newSize; i++){", "+\t\t\t\t\trequiredProjectArray[i] = wksRoot.getProject(requiredProjectNames[i]);", "+\t\t\t\t}", "+\t\t\t\tdescription.setDynamicReferences(requiredProjectArray);", "+\t\t\t\tprojectResource.setDescription(description, null);", "-\t\t\tString[] requiredProjectNames = new String[newSize];", "-\t\t\tint index = 0;", "-\t\t\titer = newReferences.iterator();", "-\t\t\twhile (iter.hasNext()){", "-\t\t\t\trequiredProjectNames[index++] = (String)iter.next();", "-\t\t\t}", "-\t\t\tUtil.sort(requiredProjectNames); // ensure that if changed, the order is consistent", "-\t\t\t", "-\t\t\tIProject[] requiredProjectArray = new IProject[newSize];", "-\t\t\tIWorkspaceRoot wksRoot = projectResource.getWorkspace().getRoot();", "-\t\t\tfor (int i = 0; i < newSize; i++){", "-\t\t\t\trequiredProjectArray[i] = wksRoot.getProject(requiredProjectNames[i]);", "-\t\t\t}", "-\t\t\tdescription.setDynamicReferences(requiredProjectArray);", "-\t\t\tprojectResource.setDescription(description, null);", "-\t", "+\t\t};", "+\t\ttry {", "+\t\t\t// ensure that a sheduling rule is used so that the project description is not modified by another thread while we update it", "+\t\t\t// see https://bugs.eclipse.org/bugs/show_bug.cgi?id=214981", "+\t\t\tIWorkspace workspace = projectResource.getWorkspace();", "+\t\t\tISchedulingRule rule = workspace.getRuleFactory().modifyRule(projectResource); // sheduling rule for modifying the project", "+\t\t\tworkspace.run(runnable, rule, IWorkspace.AVOID_UPDATE, null);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "de5dc4e6df9fde9a0b47a10abf9c602d", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/model/org/eclipse/jdt/internal/core/ProjectReferenceChange.java", "commitBeforeChange": "8fed2cc02e45d0c02f4805c1a6592bef37ca778a", "commitAfterChange": "454627bbb623962480221601ed9f326a0bd7a777", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": " \tpublic void updateProjectReferencesIfNecessary() throws JavaModelException", "signatureAfterChange": " \tpublic void updateProjectReferencesIfNecessary() throws JavaModelException", "diff": ["-", "-\t\tfinal String[] oldRequired = this.oldResolvedClasspath == null ? CharOperation.NO_STRINGS : this.project.projectPrerequisites(this.oldResolvedClasspath);", "+\t\t", "+\t\tString[] oldRequired = this.oldResolvedClasspath == null ? CharOperation.NO_STRINGS : this.project.projectPrerequisites(this.oldResolvedClasspath);", "-\t\tfinal String[] newRequired = this.project.projectPrerequisites(newResolvedClasspath);", "+\t\tString[] newRequired = this.project.projectPrerequisites(newResolvedClasspath);", "-\t\tIWorkspaceRunnable runnable = new IWorkspaceRunnable() {", "-\t\t\tpublic void run(IProgressMonitor monitor) throws CoreException {", "-\t\t\t\tIProjectDescription description = projectResource.getDescription();", "-", "-\t\t\t\tIProject[] projectReferences = description.getDynamicReferences();", "-", "-\t\t\t\tHashSet oldReferences = new HashSet(projectReferences.length);", "-\t\t\t\tfor (int i = 0; i < projectReferences.length; i++){", "-\t\t\t\t\tString projectName = projectReferences[i].getName();", "-\t\t\t\t\toldReferences.add(projectName);", "-\t\t\t\t}", "-\t\t\t\tHashSet newReferences = (HashSet)oldReferences.clone();", "-", "-\t\t\t\tfor (int i = 0; i < oldRequired.length; i++){", "-\t\t\t\t\tString projectName = oldRequired[i];", "-\t\t\t\t\tnewReferences.remove(projectName);", "-\t\t\t\t}", "-\t\t\t\tfor (int i = 0; i < newRequired.length; i++){", "-\t\t\t\t\tString projectName = newRequired[i];", "-\t\t\t\t\tnewReferences.add(projectName);", "-\t\t\t\t}", "-", "-\t\t\t\tIterator iter;", "-\t\t\t\tint newSize = newReferences.size();", "-", "-\t\t\t\tcheckIdentity: {", "-\t\t\t\t\tif (oldReferences.size() == newSize){", "-\t\t\t\t\t\titer = newReferences.iterator();", "-\t\t\t\t\t\twhile (iter.hasNext()){", "-\t\t\t\t\t\t\tif (!oldReferences.contains(iter.next())){", "-\t\t\t\t\t\t\t\tbreak checkIdentity;", "-\t\t\t\t\t\t\t}", "-\t\t\t\t\t\t}", "-\t\t\t\t\t\treturn;", "-\t\t\t\t\t}", "-\t\t\t\t}", "-\t\t\t\tString[] requiredProjectNames = new String[newSize];", "-\t\t\t\tint index = 0;", "-\t\t\t\titer = newReferences.iterator();", "-\t\t\t\twhile (iter.hasNext()){", "-\t\t\t\t\trequiredProjectNames[index++] = (String)iter.next();", "-\t\t\t\t}", "-\t\t\t\tUtil.sort(requiredProjectNames); // ensure that if changed, the order is consistent", "-", "-\t\t\t\tIProject[] requiredProjectArray = new IProject[newSize];", "-\t\t\t\tIWorkspaceRoot wksRoot = projectResource.getWorkspace().getRoot();", "-\t\t\t\tfor (int i = 0; i < newSize; i++){", "-\t\t\t\t\trequiredProjectArray[i] = wksRoot.getProject(requiredProjectNames[i]);", "-\t\t\t\t}", "-\t\t\t\tdescription.setDynamicReferences(requiredProjectArray);", "-\t\t\t\tprojectResource.setDescription(description, IResource.AVOID_NATURE_CONFIG, null);", "-\t\t\t}", "-\t\t};", "+\t\t", "-\t\t\t// ensure that a sheduling rule is used so that the project description is not modified by another thread while we update it", "+\t\t\tIProject[] projectReferences = projectResource.getDescription().getDynamicReferences();", "+\t\t\t", "+\t\t\tHashSet oldReferences = new HashSet(projectReferences.length);", "+\t\t\tfor (int i = 0; i < projectReferences.length; i++){", "+\t\t\t\tString projectName = projectReferences[i].getName();", "+\t\t\t\toldReferences.add(projectName);", "+\t\t\t}", "+\t\t\tHashSet newReferences = (HashSet)oldReferences.clone();", "+\t", "+\t\t\tfor (int i = 0; i < oldRequired.length; i++){", "+\t\t\t\tString projectName = oldRequired[i];", "+\t\t\t\tnewReferences.remove(projectName);", "+\t\t\t}", "+\t\t\tfor (int i = 0; i < newRequired.length; i++){", "+\t\t\t\tString projectName = newRequired[i];", "+\t\t\t\tnewReferences.add(projectName);", "+\t\t\t}", "+\t", "+\t\t\tIterator iter;", "+\t\t\tint newSize = newReferences.size();", "+\t\t\t", "+\t\t\tcheckIdentity: {", "+\t\t\t\tif (oldReferences.size() == newSize){", "+\t\t\t\t\titer = newReferences.iterator();", "+\t\t\t\t\twhile (iter.hasNext()){", "+\t\t\t\t\t\tif (!oldReferences.contains(iter.next())){", "+\t\t\t\t\t\t\tbreak checkIdentity;", "+\t\t\t\t\t\t}", "+\t\t\t\t\t}", "+\t\t\t\t\treturn;", "+\t\t\t\t}", "+\t\t\t}", "+\t\t\tString[] requiredProjectNames = new String[newSize];", "+\t\t\tint index = 0;", "+\t\t\titer = newReferences.iterator();", "+\t\t\twhile (iter.hasNext()){", "+\t\t\t\trequiredProjectNames[index++] = (String)iter.next();", "+\t\t\t}", "+\t\t\tUtil.sort(requiredProjectNames); // ensure that if changed, the order is consistent", "+\t\t\t", "+\t\t\tfinal IProject[] requiredProjectArray = new IProject[newSize];", "+\t\t\tIWorkspaceRoot wksRoot = projectResource.getWorkspace().getRoot();", "+\t\t\tfor (int i = 0; i < newSize; i++){", "+\t\t\t\trequiredProjectArray[i] = wksRoot.getProject(requiredProjectNames[i]);", "+\t\t\t}", "+\t\t\t\t", "+\t\t\t// ensure that a scheduling rule is used so that the project description is not modified by another thread while we update it", "+\t\t\t// also ensure that if no change (checkIdentify block returned above) we don't reach here", "+\t\t\t// see https://bugs.eclipse.org/bugs/show_bug.cgi?id=241751", "-\t\t\tISchedulingRule rule = workspace.getRuleFactory().modifyRule(projectResource); // sheduling rule for modifying the project", "+\t\t\tISchedulingRule rule = workspace.getRuleFactory().modifyRule(projectResource); // scheduling rule for modifying the project", "+\t\t\tIWorkspaceRunnable runnable = new IWorkspaceRunnable() {", "+\t\t\t\tpublic void run(IProgressMonitor monitor) throws CoreException {", "+\t\t\t\t\tIProjectDescription description = projectResource.getDescription();", "+\t\t\t\t\tdescription.setDynamicReferences(requiredProjectArray);", "+\t\t\t\t\tprojectResource.setDescription(description, IResource.AVOID_NATURE_CONFIG, null);", "+\t\t\t\t}", "+\t\t\t};"]}], "num": 2009}