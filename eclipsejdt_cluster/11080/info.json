{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "4794cb474adee70b1b5282e75ccfb030", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "3c10c4fc0c6d0bbb49941b51efb94101", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.apt.core/src/org/eclipse/jdt/apt/core/internal/generatedfile/GeneratedSourceFolderManager.java", "commitBeforeChange": "c4c0df5e4aeb7d3e8571312c597020a7d0812327", "commitAfterChange": "6fea7eafdd413dccff31028f8da1f1ac6859e6fe", "methodNumberBeforeChange": 12, "methodNumberAfterChange": 13, "signatureBeforeChange": " \tprivate void removeFolder(final IFolder srcFolder)", "signatureAfterChange": " \tprivate void removeFolder()", "diff": ["-\tprivate void removeFolder(final IFolder srcFolder) {", "-\t\tif( srcFolder != null ){", "-\t\t\tfinal IWorkspaceRunnable runnable = new IWorkspaceRunnable(){", "-\t            public void run(IProgressMonitor monitor)", "-\t            {\t\t", "-\t            \tif( srcFolder != null ){", "-\t\t            \ttry{", "-\t\t            \t\tsrcFolder.delete(true, false, null);", "-\t\t            \t}catch(CoreException e){", "-\t\t            \t\tAptPlugin.log(e, \"failed to delete old generated source folder \" + srcFolder.getName() ); //$NON-NLS-1$", "-\t\t            \t}catch(OperationCanceledException cancel){", "-\t\t            \t\tAptPlugin.log(cancel, \"deletion of generated source folder got cancelled\"); //$NON-NLS-1$", "-\t\t            \t}", "-\t            \t}", "-\t            };", "-\t        };", "-\t        IWorkspace ws = _aptProject.getJavaProject().getProject().getWorkspace();", "-\t        try{", "-\t        \tws.run(runnable, ws.getRoot(), IWorkspace.AVOID_UPDATE, null);", "-\t        }catch(CoreException e){", "-\t    \t\tAptPlugin.log(e, \"Runnable for deleting old generated source folder \" + srcFolder.getName() + \" failed.\"); //$NON-NLS-1$ //$NON-NLS-2$", "-\t    \t}", "+\tprivate void removeFolder() {", "+\t\tIFolder srcFolder = null;", "+\t\tsynchronized ( this )", "+\t\t{", "+\t\t\tsrcFolder = _generatedSourceFolder;", "+\t\t\t_generatedSourceFolder = null;", "+\t\tif (srcFolder == null) {", "+\t\t\treturn;", "+\t\t}", "+\t\t", "+\t\t// Clear out the generated file maps", "+\t\t_aptProject.projectClean(false);", "+\t\t", "+\t\t// clean up the classpath first so that when we actually delete the ", "+\t\t// generated source folder we won't cause a classpath error.", "+\t\ttry {\t", "+\t\t\tClasspathUtil.removeFromProjectClasspath( _aptProject.getJavaProject(), srcFolder, null );\t\t", "+\t\t} catch (JavaModelException e) {", "+\t\t\tAptPlugin.log( e, \"Failed to remove classpath entry for old generated src folder \" + srcFolder.getName() ); //$NON-NLS-1$", "+\t\t}", "+\t\t", "+\t\tFileSystemUtil.deleteFolder(srcFolder);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "80bac6431b329ed4d5867e3a28104ecb", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.apt.core/src/org/eclipse/jdt/apt/core/internal/util/FileSystemUtil.java", "commitBeforeChange": "b4f6df5ae08d61af8762ee59e5c247a670be227d", "commitAfterChange": "7007043cae1b12e48764a4ad7f71075181f1dd30", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": " \tpublic static void deleteFolder(final IFolder folder)", "signatureAfterChange": " \tpublic static boolean deleteDerivedResources(final IResource resource) \t\tthrows CoreException", "diff": ["-\tpublic static void deleteFolder(final IFolder folder) {", "-\t\tif( folder != null ){", "-\t\t\tfinal IWorkspaceRunnable runnable = new IWorkspaceRunnable(){", "-\t            public void run(IProgressMonitor monitor)", "-\t            {\t\t", "-\t            \tif( folder != null ){", "-\t\t            \ttry{", "-\t\t            \t\tfolder.delete(true, false, null);", "-\t\t            \t}catch(CoreException e){", "-\t\t            \t\tAptPlugin.log(e, \"failed to delete old generated source folder \" + folder.getName() ); //$NON-NLS-1$", "-\t\t            \t}catch(OperationCanceledException cancel){", "-\t\t            \t\tAptPlugin.log(cancel, \"deletion of generated source folder got cancelled\"); //$NON-NLS-1$", "-\t\t            \t}", "-\t            \t}", "-\t            }", "-\t        };", "-\t        IWorkspace ws = ResourcesPlugin.getWorkspace();", "-\t        try{", "-\t        \tws.run(runnable, ws.getRoot(), IWorkspace.AVOID_UPDATE, null);", "-\t        }catch(CoreException e){", "-\t    \t\tAptPlugin.log(e, \"Runnable for deleting old generated source folder \" + folder.getName() + \" failed.\"); //$NON-NLS-1$ //$NON-NLS-2$", "-\t    \t}", "+\tpublic static boolean deleteDerivedResources(final IResource resource)", "+\t\tthrows CoreException", "+\t{", "+\t\tif (null == resource) {", "+\t\t\treturn false;", "+\t\tif( resource.getType() == IResource.FOLDER ){", "+\t\t\tboolean deleteFolder = resource.isDerived();", "+\t\t\tIResource[] members = ((IFolder)resource).members();", "+\t\t\tfor( int i=0, len=members.length; i<len; i++ ){\t", "+\t\t\t\tdeleteFolder &= deleteDerivedResources(members[i]);", "+\t\t\t}", "+\t\t\tif( deleteFolder ){", "+\t\t\t\tresource.delete(true, null);", "+\t\t\t\treturn true;", "+\t\t\t}", "+\t\t\treturn false; ", "+\t\t}", "+\t\telse if( resource.getType() == IResource.FILE ){", "+\t\t\tif( resource.isDerived() ){", "+\t\t\t\tresource.delete(true, null);", "+\t\t\t\treturn true;", "+\t\t\t}", "+\t\t\treturn false;", "+\t\t}", "+\t\t// will skip pass everything else.", "+\t\telse", "+\t\t\treturn false;"]}], "num": 11080}