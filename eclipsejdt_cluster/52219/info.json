{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "c0f67f9c2d4472b7c972365f9dd78747", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "06ba66b8faf6022067a1be019edc8f18", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.apt.core/src/org/eclipse/jdt/apt/core/internal/generatedfile/GeneratedFileManager.java", "commitBeforeChange": "6cb413dbd992ad73f847d7b4e14e78f1406fa2fc", "commitAfterChange": "8659b871eae5c2008485cfb120ce2c8f8ecbfe04", "methodNumberBeforeChange": 8, "methodNumberAfterChange": 11, "signatureBeforeChange": " \tpublic void parentFileDeleted( IFile parent, IProgressMonitor monitor )  \t\tthrows CoreException", "signatureAfterChange": " \tpublic void fileDeleted(IFile f)", "diff": ["+\t */", "+\tpublic void fileDeleted(IFile f)", "+\t{", "+\t\tSet<ICompilationUnit> toDiscard = new HashSet<ICompilationUnit>();", "+\t\tSet<IFile> toDelete = new HashSet<IFile>();", "+", "+\t\tremoveFileFromMaps(f, toDiscard, toDelete);", "+", "+\t\tfor (IFile fileToDelete : toDelete) {", "+\t\t\tdeletePhysicalFile(fileToDelete);", "+\t\t}", "+\t\tfor (ICompilationUnit wcToDiscard : toDiscard) {", "+\t\t\t_CUHELPER.discardWorkingCopy(wcToDiscard);", "+\t\t}", "+", "+\t}", "-\t */", "-\tpublic void parentFileDeleted( IFile parent, IProgressMonitor monitor ) ", "-\t\tthrows CoreException", "-\t{", "-\t\tSet<IFile> generatedFiles;", "-\t\t", "-\t\tsynchronized( this )", "-\t\t{", "-\t\t\tgeneratedFiles = _parentFile2GeneratedFiles.get( parent );", "-\t\t\t// make a copy to avoid race conditions", "-\t\t\tgeneratedFiles = new HashSet<IFile>( generatedFiles );", "-\t\t}", "-\t\t\t", "-\t\tfor ( IFile generatedFile : generatedFiles )", "-\t\t\tdeleteGeneratedFile( generatedFile, parent, monitor );", "-\t}"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "0a01907a017a4727e72a678a61d7bfc8", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.apt.core/src/org/eclipse/jdt/apt/core/internal/generatedfile/GeneratedFileManager.java", "commitBeforeChange": "57e6ab81c3cf39fecb76455d174c657f7c273f84", "commitAfterChange": "8c4c03ed87f5ba92a46a042a6bd51df21862c6ec", "methodNumberBeforeChange": 13, "methodNumberAfterChange": 13, "signatureBeforeChange": " \tpublic synchronized void parentFileDeleted( IFile parent, IProgressMonitor monitor )  \t\tthrows CoreException", "signatureAfterChange": " \tpublic void parentFileDeleted( IFile parent, IProgressMonitor monitor )  \t\tthrows CoreException", "diff": ["-\tpublic synchronized void parentFileDeleted( IFile parent, IProgressMonitor monitor ) ", "+\tpublic void parentFileDeleted( IFile parent, IProgressMonitor monitor ) ", "-\t\tSet<IFile> derivedFiles = _parentFile2GeneratedFiles.get( parent );", "+\t\tSet<IFile> generatedFiles;", "-\t\tIterator<IFile> it = derivedFiles.iterator(); ", "-\t\twhile ( it.hasNext() )", "+\t\tsynchronized( this )", "-\t\t\tIFile generatedFile = it.next();", "-\t\t\tdeleteGeneratedFile( generatedFile, parent, monitor );", "+\t\t\tgeneratedFiles = _parentFile2GeneratedFiles.get( parent );", "+\t\t\t// make a copy to avoid race conditions", "+\t\t\tgeneratedFiles = new HashSet<IFile>( generatedFiles );", "+\t\t\t", "+\t\tfor ( IFile generatedFile : generatedFiles )", "+\t\t\tdeleteGeneratedFile( generatedFile, parent, monitor );"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "3180435be5083a510c0fce04111f1899", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.apt.core/src/org/eclipse/jdt/apt/core/internal/APTDispatchRunnable.java", "commitBeforeChange": "7edc39e2653921448f7b9423fc48e020671243a7", "commitAfterChange": "4c50a1509b1f29ee2e7f2429bff60734b9f852b8", "methodNumberBeforeChange": 14, "methodNumberAfterChange": 14, "signatureBeforeChange": " \tprivate void reportResult( \t\t\tBuildContext curResult, \t\t\tSet<IFile> generatedFiles, \t\t\tSet<IFile> modifiedGeneratedFiles, \t\t\tList<? extends CategorizedProblem> problems, \t\t\tSet<String> deps, \t\t\tGeneratedFileManager gfm,  \t\t\tBuildEnv processorEnv)", "signatureAfterChange": " \tprivate void reportResult( \t\t\tBuildContext curResult, \t\t\tSet<IFile> java5GeneratedFiles, \t\t\tSet<IFile> modifiedGeneratedFiles, \t\t\tList<? extends CategorizedProblem> problems, \t\t\tSet<String> deps, \t\t\tGeneratedFileManager gfm,  \t\t\tBuildEnv processorEnv)", "diff": ["-\t\t\tSet<IFile> generatedFiles,", "+\t\t\tSet<IFile> java5GeneratedFiles,", "-\t\t\tBuildEnv processorEnv){", "+\t\t\tBuildEnv processorEnv)", "+\t{", "+\t\t// Combine files generated by Java 5 and Java 6 processing phases", "+\t\tSet<IFile> allGeneratedFiles = null;", "+\t\tSet<IFile> java6GeneratedFiles = AptCompilationParticipant.getInstance().getJava6GeneratedFiles();", "+\t\tif (java5GeneratedFiles == null || java5GeneratedFiles.isEmpty()) {", "+\t\t\tif (java6GeneratedFiles == null || java6GeneratedFiles.isEmpty()) {", "+\t\t\t\tallGeneratedFiles = Collections.emptySet();", "+\t\t\t}", "+\t\t\telse {", "+\t\t\t\tallGeneratedFiles = java6GeneratedFiles;", "+\t\t\t}", "+\t\t}", "+\t\telse {", "+\t\t\tif (java6GeneratedFiles == null || java6GeneratedFiles.isEmpty()) {", "+\t\t\t\tallGeneratedFiles = java5GeneratedFiles;", "+\t\t\t}", "+\t\t\telse {", "+\t\t\t\tallGeneratedFiles = new HashSet<IFile>(java6GeneratedFiles);", "+\t\t\t\tallGeneratedFiles.addAll(java5GeneratedFiles);", "+\t\t\t}", "+\t\t}", "-\t\t", "-\t\tif (generatedFiles == null )", "-\t\t\tgeneratedFiles = Collections.emptySet();", "-\t\t\t\tgeneratedFiles, ", "+\t\t\t\tallGeneratedFiles, "]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "3ce62d8b54f3f5a5e0d94b2adc36a9a2", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.apt.core/src/org/eclipse/jdt/apt/core/internal/generatedfile/GeneratedFileManager.java", "commitBeforeChange": "57e6ab81c3cf39fecb76455d174c657f7c273f84", "commitAfterChange": "8c4c03ed87f5ba92a46a042a6bd51df21862c6ec", "methodNumberBeforeChange": 15, "methodNumberAfterChange": 15, "signatureBeforeChange": " \t  \tpublic synchronized void generatedFileDeleted( IFile generatedFile,  IProgressMonitor progressMonitor ) \t\tthrows JavaModelException, CoreException", "signatureAfterChange": " \t \tpublic void generatedFileDeleted( IFile generatedFile,  IProgressMonitor progressMonitor ) \t\tthrows JavaModelException, CoreException", "diff": ["-", "-\tpublic synchronized void generatedFileDeleted( IFile generatedFile,  IProgressMonitor progressMonitor )", "+\tpublic void generatedFileDeleted( IFile generatedFile,  IProgressMonitor progressMonitor )", "-\t\tSet<IFile> parents = _generatedFile2ParentFiles.get( generatedFile );", "-\t\tif ( parents == null || parents.isEmpty() )", "-\t\t\treturn;", "-\t\t\t\t", "-\t\tIterator<IFile> it = parents.iterator();", "-\t\twhile ( it.hasNext() )", "+\t\tSet<IFile> parentFiles;", "+\t\tsynchronized( this )", "-\t\t\tIFile parentFile = it.next();", "+\t\t\tparentFiles = _generatedFile2ParentFiles.get( generatedFile );", "+\t\t\tif ( parentFiles == null || parentFiles.isEmpty() )", "+\t\t\t\treturn;", "+\t\t\t", "+\t\t\t// make a copy to prevent race conditions", "+\t\t\tparentFiles = new HashSet<IFile>( parentFiles );", "+\t\t}", "+\t\t", "+\t\tfor ( IFile parentFile : parentFiles )", "+\t\t{"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "40e32ba961a586b6e670f588d697b7d3", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.apt.core/src/org/eclipse/jdt/apt/core/internal/APTDispatchRunnable.java", "commitBeforeChange": "bfcd45867d04fefcde8c411b2c4f613fed962f2b", "commitAfterChange": "8360857ac96415dcd60ac94fbc284e7801424ade", "methodNumberBeforeChange": 20, "methodNumberAfterChange": 18, "signatureBeforeChange": " \tprivate Set<IFile> cleanupNoLongerGeneratedFiles( \t\t\tIFile parentFile, \t\t\tSet<IFile> lastGeneratedFiles,  \t\t\tSet<IFile> newGeneratedFiles, \t\t\tGeneratedFileManager gfm,\t\t \t\t\tProcessorEnvImpl processorEnv, \t\t\tSet<IFile> deletedFiles)", "signatureAfterChange": " \tprivate void cleanupNoLongerGeneratedFiles( \t\t\tICompilationParticipantResult parent, \t\t\tSet<IFile> lastGeneratedFiles,  \t\t\tSet<IFile> newGeneratedFiles, \t\t\tGeneratedFileManager gfm,\t\t \t\t\tProcessorEnvImpl processorEnv, \t\t\tCollection<IFile> deleted)", "diff": ["-\t// Note: only work under build mode. ", "-\tprivate Set<IFile> cleanupNoLongerGeneratedFiles(", "-\t\t\tIFile parentFile,", "+\t//       Do not call unless caller is sure this is during build phase.", "+\tprivate void cleanupNoLongerGeneratedFiles(", "+\t\t\tICompilationParticipantResult parent,", "-\t\t\tSet<IFile> deletedFiles)", "-\t{", "-\t\tif( deletedFiles == null )", "-\t\t\tdeletedFiles = new HashSet<IFile>();", "-\t\t", "+\t\t\tCollection<IFile> deleted)", "+\t{\t", "+\t\tfinal int numLastGeneratedFiles = lastGeneratedFiles.size();", "-\t\tIFile[] files = lastGeneratedFiles.toArray( new IFile[ lastGeneratedFiles.size() ] );", "+\t\tIFile[] files = lastGeneratedFiles.toArray( new IFile[ numLastGeneratedFiles ] );", "+\t\t", "+\t\t\t\tfinal IFile parentFile = parent.getFile();", "-\t\t\t\t\t\tdeletedFiles.add( f );", "+\t\t\t\t\t\tdeleted.add( f );", "-\t\treturn deletedFiles;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "48bf2169e22021063a78d655e279a1d9", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.apt.core/src/org/eclipse/jdt/apt/core/internal/generatedfile/GeneratedFileManager.java", "commitBeforeChange": "57e6ab81c3cf39fecb76455d174c657f7c273f84", "commitAfterChange": "8c4c03ed87f5ba92a46a042a6bd51df21862c6ec", "methodNumberBeforeChange": 12, "methodNumberAfterChange": 12, "signatureBeforeChange": " \tpublic synchronized void parentWorkingCopyDiscarded( IFile parentFile ) \t\tthrows JavaModelException", "signatureAfterChange": " \tpublic void parentWorkingCopyDiscarded( IFile parentFile ) \t\tthrows JavaModelException", "diff": ["-\tpublic synchronized void parentWorkingCopyDiscarded( IFile parentFile )", "+\tpublic void parentWorkingCopyDiscarded( IFile parentFile )", "-\t\tSet<IFile> derivedFiles = _parentFile2GeneratedFiles.get( parentFile );", "-\t\tif ( derivedFiles == null || derivedFiles.size() == 0 )", "-\t\t\treturn;", "-\t\t", "-\t\tIterator<IFile> it = derivedFiles.iterator();", "-\t\twhile ( it.hasNext() )", "+\t\tSet<IFile> generatedFiles;", "+\t\tsynchronized( this )", "-\t\t\tIFile f = it.next();", "-\t\t\tdiscardGeneratedWorkingCopy( f, parentFile );", "+\t\t\tgeneratedFiles = _parentFile2GeneratedFiles.get( parentFile );", "+\t\t\tif ( generatedFiles == null || generatedFiles.size() == 0 )", "+\t\t\t\treturn;", "+\t\t", "+\t\t\t// make a copy to prevent race conditions", "+\t\t\tgeneratedFiles = new HashSet<IFile>( generatedFiles );", "+\t\t", "+\t\tfor ( IFile generatedFile : generatedFiles )", "+\t\t\tdiscardGeneratedWorkingCopy( generatedFile, parentFile );"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "806332d26ba29a97ffc70000f62e979d", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.apt.core/src/org/eclipse/jdt/apt/core/internal/generatedfile/GeneratedFileManager.java", "commitBeforeChange": "bc5d9b450540dde0f4417c6b10a04ec18aa90f94", "commitAfterChange": "67c55712e5adee92eb685a3f98810e93028c1621", "methodNumberBeforeChange": 17, "methodNumberAfterChange": 14, "signatureBeforeChange": "  \tpublic synchronized void generatedFileDeleted( IFile deletedFile,  IProgressMonitor progressMonitor )", "signatureAfterChange": " \t  \tpublic synchronized void generatedFileDeleted( IFile generatedFile,  IProgressMonitor progressMonitor ) \t\tthrows JavaModelException, CoreException", "diff": ["-\tpublic synchronized void generatedFileDeleted( IFile deletedFile,  IProgressMonitor progressMonitor )", "+\tpublic synchronized void generatedFileDeleted( IFile generatedFile,  IProgressMonitor progressMonitor )", "+\t\tthrows JavaModelException, CoreException", "-\t\tSet<IFile> parents = _derivedFile2Parents.get( deletedFile );", "+\t\tSet<IFile> parents = _generatedFile2ParentFiles.get( generatedFile );", "-\t\t", "-\t\tString typeName = getTypeNameForDerivedFile( deletedFile );", "-\t\t", "+\t\t\t\t", "-\t\t\tIFile parent = it.next();", "-\t\t\tSet<IFile> s = _parent2DerivedFiles.get( parent );", "-\t\t\ts.remove( deletedFile );", "-\t\t\t", "-\t\t\tSet<String> types = _parent2TypeNames.get( parent );", "-\t\t\ttypes.remove( typeName );", "+\t\t\tIFile parentFile = it.next();", "+\t\t\tremoveFromWorkingCopyMaps( generatedFile, parentFile );", "+\t\t\tremoveFromFileMaps( generatedFile, parentFile );", "-\t\t", "-\t\t_derivedFile2Parents.remove( deletedFile );", "-\t\t", "-\t\t_typeName2Parents.remove( typeName );", "-\t\t", "-\t\t_typeName2WorkingCopy.remove( typeName );"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "a87ffc1e8cd1804d1fe26ba94ff6af7a", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.apt.core/src/org/eclipse/jdt/apt/core/internal/generatedfile/GeneratedFileManager.java", "commitBeforeChange": "72643ddaac52d3ea6e2573fbe40b9af5d9586d1e", "commitAfterChange": "965ee55c83771df9f7f21b38b9a78903a86f630d", "methodNumberBeforeChange": 14, "methodNumberAfterChange": 17, "signatureBeforeChange": "  \tpublic void generatedFileDeleted( IFile deletedFile,  IProgressMonitor progressMonitor )", "signatureAfterChange": "  \tpublic synchronized void generatedFileDeleted( IFile deletedFile,  IProgressMonitor progressMonitor )", "diff": ["-\tpublic void generatedFileDeleted( IFile deletedFile,  IProgressMonitor progressMonitor )", "+\tpublic synchronized void generatedFileDeleted( IFile deletedFile,  IProgressMonitor progressMonitor )", "-\t\tSet parents = (Set) _derivedFile2Parents.get( deletedFile );", "+\t\tSet<IFile> parents = _derivedFile2Parents.get( deletedFile );", "-\t\tIterator it = parents.iterator();", "+\t\tIterator<IFile> it = parents.iterator();", "-\t\t\tIFile parent = (IFile) it.next();", "-\t\t\tSet s = (Set)_parent2DerivedFiles.get( parent );", "+\t\t\tIFile parent = it.next();", "+\t\t\tSet<IFile> s = _parent2DerivedFiles.get( parent );", "-\t\t\ts = (Set)_parent2TypeNames.get( parent );", "-\t\t\ts.remove( typeName );", "+\t\t\tSet<String> types = _parent2TypeNames.get( parent );", "+\t\t\ttypes.remove( typeName );"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "f70a68713f5ef8d9519ab8fcf6161910", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.apt.core/src/org/eclipse/jdt/apt/core/internal/generatedfile/GeneratedFileManager.java", "commitBeforeChange": "6cb413dbd992ad73f847d7b4e14e78f1406fa2fc", "commitAfterChange": "8659b871eae5c2008485cfb120ce2c8f8ecbfe04", "methodNumberBeforeChange": 7, "methodNumberAfterChange": 18, "signatureBeforeChange": " \tpublic void parentWorkingCopyDiscarded( IFile parentFile ) \t\tthrows JavaModelException", "signatureAfterChange": " \tpublic void workingCopyDiscarded(ICompilationUnit wc) throws CoreException", "diff": ["-\t */", "-\tpublic void parentWorkingCopyDiscarded( IFile parentFile )", "-\t\tthrows JavaModelException", "-\t{", "-\t\tSet<IFile> generatedFiles;", "-\t\tsynchronized( this )", "-\t\t{", "-\t\t\tgeneratedFiles = _parentFile2GeneratedFiles.get( parentFile );", "-\t\t\tif ( generatedFiles == null || generatedFiles.size() == 0 )", "-\t\t\t\treturn;", "-\t\t", "-\t\t\t// make a copy to prevent race conditions", "-\t\t\tgeneratedFiles = new HashSet<IFile>( generatedFiles );", "-\t\t}", "-\t\t", "-\t\tfor ( IFile generatedFile : generatedFiles )", "-\t\t\tdiscardGeneratedWorkingCopy( generatedFile, parentFile );", "+\t */", "+\tpublic void workingCopyDiscarded(ICompilationUnit wc) throws CoreException", "+\t{", "+\t\tSet<ICompilationUnit> toDiscard = removeWcChildrenFromMaps(wc);", "+\t\tif (AptPlugin.DEBUG_GFM) AptPlugin.trace(", "+\t\t\t\t\"Working copy discarded: \" + wc.getElementName() + //$NON-NLS-1$", "+\t\t\t\t\" removing \" + toDiscard.size() + \" children\");  //$NON-NLS-1$//$NON-NLS-2$", "+\t\tfor (ICompilationUnit obsoleteWC : toDiscard) {", "+\t\t\t_CUHELPER.discardWorkingCopy(obsoleteWC);", "+\t\t}", "+\t}"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "f8bda62f939053746f88015350fdac4c", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.apt.core/src/org/eclipse/jdt/apt/core/internal/generatedfile/GeneratedFileManager.java", "commitBeforeChange": "6cb413dbd992ad73f847d7b4e14e78f1406fa2fc", "commitAfterChange": "8659b871eae5c2008485cfb120ce2c8f8ecbfe04", "methodNumberBeforeChange": 11, "methodNumberAfterChange": 4, "signatureBeforeChange": " \tpublic void generatedFileDeleted( IFile generatedFile,  IProgressMonitor progressMonitor ) \t\tthrows JavaModelException", "signatureAfterChange": " \tpublic void addGeneratedFileDependency(IFile parentFile, IFile generatedFile)", "diff": ["+\t */", "+\tpublic void addGeneratedFileDependency(IFile parentFile, IFile generatedFile)", "+\t\taddBuiltFileToMaps(parentFile, generatedFile);", "+\t}", "-\tpublic void generatedFileDeleted( IFile generatedFile,  IProgressMonitor progressMonitor )", "-\t\tthrows JavaModelException", "-\t\tSet<IFile> parentFiles;", "-\t\tsynchronized( this )", "-\t\t{", "-\t\t\tparentFiles = _generatedFile2ParentFiles.get( generatedFile );", "-\t\t\tif ( parentFiles == null || parentFiles.isEmpty() )", "-\t\t\t\treturn;", "-\t\t\t", "-\t\t\t// make a copy to prevent race conditions", "-\t\t\tparentFiles = new HashSet<IFile>( parentFiles );", "-\t\t", "-\t\tfor ( IFile parentFile : parentFiles )", "-\t\t{", "-\t\t\tremoveFromWorkingCopyMaps( generatedFile, parentFile );", "-\t\t\tremoveFromFileMaps( generatedFile, parentFile );", "-\t\t}"]}], "num": 52219}