{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "797f3881e0bc230eedcd31239a63e462", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "31039e83f558203a9bea687834af9759", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/compiler/org/eclipse/jdt/internal/compiler/ClassFile.java", "commitBeforeChange": "7bf89e29c34a348a2ed388f7cdb6c1016941cf61", "commitAfterChange": "cd5adcef3921beea7df4f6703ab58225bdb4ec39", "methodNumberBeforeChange": 5, "methodNumberAfterChange": 10, "signatureBeforeChange": " \tpublic void addFieldInfo(FieldBinding fieldBinding)", "signatureAfterChange": " \tprivate void addFieldInfo(FieldBinding fieldBinding)", "diff": ["-\t */", "-\tpublic void addFieldInfo(FieldBinding fieldBinding) {", "-\t\tint attributeNumber = 0;", "-\t\t// check that there is enough space to write all the bytes for the field info corresponding", "-\t\t// to the @fieldBinding", "-\t\tif (contentsOffset + 30 >= contents.length) {", "-\t\t\tresizeContents(30);", "-\t\t}", "-\t\t// Now we can generate all entries into the byte array", "-\t\t// First the accessFlags", "-\t\tint accessFlags = fieldBinding.getAccessFlags();", "-\t\tif (targetJDK < ClassFileConstants.JDK1_5) {", "-\t\t    // pre 1.5, synthetic was an attribute, not a modifier", "-\t\t    accessFlags &= ~AccSynthetic;", "-\t\t}\t\t", "-\t\tcontents[contentsOffset++] = (byte) (accessFlags >> 8);", "-\t\tcontents[contentsOffset++] = (byte) accessFlags;", "-\t\t// Then the nameIndex", "-\t\tint nameIndex = constantPool.literalIndex(fieldBinding.name);", "-\t\tcontents[contentsOffset++] = (byte) (nameIndex >> 8);", "-\t\tcontents[contentsOffset++] = (byte) nameIndex;", "-\t\t// Then the descriptorIndex", "-\t\tint descriptorIndex = constantPool.literalIndex(fieldBinding.type.signature());", "-\t\tcontents[contentsOffset++] = (byte) (descriptorIndex >> 8);", "-\t\tcontents[contentsOffset++] = (byte) descriptorIndex;", "-\t\t// leave some space for the number of attributes", "-\t\tint fieldAttributeOffset = contentsOffset;", "-\t\tcontentsOffset += 2;", "-\t\t\tattributeNumber++;", "-\t\t\t\t\t\t\tcontentsOffset = fieldAttributeOffset + 2;", "-\t\t\t\t\t\t\t// +2 is necessary to keep the two byte space for the attribute number", "-\t\t\t\t\t\t\tattributeNumber--;", "-\t\t\tattributeNumber++;", "-\t\t\tattributeNumber++;", "-\t\t\tattributeNumber++;", "-\t\t}\t\t\t\t", "+\t */", "+\tprivate void addFieldInfo(FieldBinding fieldBinding) {", "+\t\t// check that there is enough space to write all the bytes for the field info corresponding", "+\t\t// to the @fieldBinding", "+\t\tif (contentsOffset + 8 >= contents.length) {", "+\t\t\tresizeContents(8);", "+\t\t}", "+\t\t// Now we can generate all entries into the byte array", "+\t\t// First the accessFlags", "+\t\tint accessFlags = fieldBinding.getAccessFlags();", "+\t\tif (targetJDK < ClassFileConstants.JDK1_5) {", "+\t\t    // pre 1.5, synthetic was an attribute, not a modifier", "+\t\t    accessFlags &= ~AccSynthetic;", "+\t\t}\t\t", "+\t\tcontents[contentsOffset++] = (byte) (accessFlags >> 8);", "+\t\tcontents[contentsOffset++] = (byte) accessFlags;", "+\t\t// Then the nameIndex", "+\t\tint nameIndex = constantPool.literalIndex(fieldBinding.name);", "+\t\tcontents[contentsOffset++] = (byte) (nameIndex >> 8);", "+\t\tcontents[contentsOffset++] = (byte) nameIndex;", "+\t\t// Then the descriptorIndex", "+\t\tint descriptorIndex = constantPool.literalIndex(fieldBinding.type.signature());", "+\t\tcontents[contentsOffset++] = (byte) (descriptorIndex >> 8);", "+\t\tcontents[contentsOffset++] = (byte) descriptorIndex;", "+\t\tint fieldAttributeOffset = contentsOffset;", "+\t\tint attributeNumber = 0;", "+\t\t// leave some space for the number of attributes", "+\t\tcontentsOffset += 2;", "+\t\tattributeNumber += addFieldAttributes(fieldBinding, fieldAttributeOffset);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "732e91dc88a684f4196cac8f07eb04a5", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/compiler/org/eclipse/jdt/internal/compiler/ClassFile.java", "commitBeforeChange": "a3376443e7433851c1c9a2be37ee8e7113265608", "commitAfterChange": "de1a896ae0cf9cc7fdee8ce3aebee48242ef244b", "methodNumberBeforeChange": 11, "methodNumberAfterChange": 11, "signatureBeforeChange": "\r \tpublic void addProblemMethod(\r \t\tAbstractMethodDeclaration method,\r \t\tMethodBinding methodBinding,\r \t\tIProblem[] problems)", "signatureAfterChange": "\r \tpublic void addProblemMethod(\r \t\tAbstractMethodDeclaration method,\r \t\tMethodBinding methodBinding,\r \t\tIProblem[] problems)", "diff": ["-\t\t// leave two spaces for the number of attributes\r", "-\t\tint attributeOffset = contentsOffset;\r", "-\t\tcontentsOffset += 2;\r", "-\t\tReferenceBinding[] thrownsExceptions;\r", "-\t\tint attributeNumber = 0;\r", "-\t\tint contentsLength;\r", "-\r", "-\t\tif ((thrownsExceptions = methodBinding.thrownExceptions) != NoExceptions) {\r", "-\t\t\t// The method has a throw clause. So we need to add an exception attribute\r", "-\t\t\t// check that there is enough space to write all the bytes for the exception attribute\r", "-\t\t\tint length = thrownsExceptions.length;\r", "-\t\t\tif (contentsOffset + (8 + length * 2) >= (contentsLength = contents.length)) {\r", "-\t\t\t\tSystem.arraycopy(\r", "-\t\t\t\t\tcontents,\r", "-\t\t\t\t\t0,\r", "-\t\t\t\t\t(contents =\r", "-\t\t\t\t\t\tnew byte[contentsLength + Math.max(INCREMENT_SIZE, (8 + length * 2))]),\r", "-\t\t\t\t\t0,\r", "-\t\t\t\t\tcontentsLength);\r", "-\t\t\t}\r", "-\t\t\tint exceptionNameIndex =\r", "-\t\t\t\tconstantPool.literalIndex(AttributeNamesConstants.ExceptionsName);\r", "-\t\t\tcontents[contentsOffset++] = (byte) (exceptionNameIndex >> 8);\r", "-\t\t\tcontents[contentsOffset++] = (byte) exceptionNameIndex;\r", "-\t\t\t// The attribute length = length * 2 + 2 in case of a exception attribute\r", "-\t\t\tint attributeLength = length * 2 + 2;\r", "-\t\t\tcontents[contentsOffset++] = (byte) (attributeLength >> 24);\r", "-\t\t\tcontents[contentsOffset++] = (byte) (attributeLength >> 16);\r", "-\t\t\tcontents[contentsOffset++] = (byte) (attributeLength >> 8);\r", "-\t\t\tcontents[contentsOffset++] = (byte) attributeLength;\r", "-\t\t\tcontents[contentsOffset++] = (byte) (length >> 8);\r", "-\t\t\tcontents[contentsOffset++] = (byte) length;\r", "-\t\t\tfor (int i = 0; i < length; i++) {\r", "-\t\t\t\tint exceptionIndex = constantPool.literalIndex(thrownsExceptions[i]);\r", "-\t\t\t\tcontents[contentsOffset++] = (byte) (exceptionIndex >> 8);\r", "-\t\t\t\tcontents[contentsOffset++] = (byte) exceptionIndex;\r", "-\t\t\t}\r", "-\t\t\tattributeNumber++;\r", "-\t\t}\r", "-\r", "-\t\t// Deprecated attribute\r", "-\t\t// Check that there is enough space to write the deprecated attribute\r", "-\t\tif (contentsOffset + 6 >= (contentsLength = contents.length)) {\r", "-\t\t\tSystem.arraycopy(\r", "-\t\t\t\tcontents,\r", "-\t\t\t\t0,\r", "-\t\t\t\t(contents = new byte[contentsLength + INCREMENT_SIZE]),\r", "-\t\t\t\t0,\r", "-\t\t\t\tcontentsLength);\r", "-\t\t}\r", "-\t\tif (methodBinding.isDeprecated()) {\r", "-\t\t\tint deprecatedAttributeNameIndex =\r", "-\t\t\t\tconstantPool.literalIndex(AttributeNamesConstants.DeprecatedName);\r", "-\t\t\tcontents[contentsOffset++] = (byte) (deprecatedAttributeNameIndex >> 8);\r", "-\t\t\tcontents[contentsOffset++] = (byte) deprecatedAttributeNameIndex;\r", "-\t\t\t// the length of a deprecated attribute is equals to 0\r", "-\t\t\tcontents[contentsOffset++] = 0;\r", "-\t\t\tcontents[contentsOffset++] = 0;\r", "-\t\t\tcontents[contentsOffset++] = 0;\r", "-\t\t\tcontents[contentsOffset++] = 0;\r", "-\r", "-\t\t\tattributeNumber++;\r", "-\t\t}\r", "-\r", "+\t\tint methodAttributeOffset = contentsOffset;\r", "+\t\tint attributeNumber = generateMethodInfoAttribute(methodBinding);\r", "+\t\t\r", "+\t\t// Code attribute\r", "+\t\tattributeNumber++;\r", "+\t\t\r", "-\t\tattributeNumber++; // code attribute\r", "-\t\tcontents[attributeOffset++] = (byte) (attributeNumber >> 8);\r", "-\t\tcontents[attributeOffset] = (byte) attributeNumber;\r", "+\t\tcompleteMethodInfo(methodAttributeOffset, attributeNumber);\r"]}], "num": 11244}