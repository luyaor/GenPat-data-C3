{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "a893332253e6efb4bb3ba2274c3fbbd8", "detectedBy": ["DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "97bf2cb482bd4bc7f361c4144bc1e518", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/compiler/org/eclipse/jdt/internal/compiler/lookup/SourceTypeBinding.java", "commitBeforeChange": "34b4972480c62fc99b17d4728db2648e98460b52", "commitAfterChange": "a234173ab4d645c8990c97cafa00ec82ce0a909f", "methodNumberBeforeChange": 44, "methodNumberAfterChange": 44, "signatureBeforeChange": " private void evaluateNullAnnotations(long annotationTagBits)", "signatureAfterChange": " private void evaluateNullAnnotations(long annotationTagBits)", "diff": ["+\tboolean isPackageInfo = CharOperation.equals(this.sourceName, TypeConstants.PACKAGE_INFO_NAME);", "+\tPackageBinding pkg = getPackage();", "+\tboolean isInDefaultPkg = (pkg.compoundName == CharOperation.NO_CHAR_CHAR);", "+\tif (!isPackageInfo) {", "+\t\tboolean isInNullnessAnnotationPackage = ", "+\t\t\t\tpkg == this.scope.environment().nonnullAnnotationPackage", "+\t\t\t\t|| pkg == this.scope.environment().nullableAnnotationPackage", "+\t\t\t\t|| pkg == this.scope.environment().nonnullByDefaultAnnotationPackage;", "+\t\tif (pkg.defaultNullness == NO_NULL_DEFAULT && !isInDefaultPkg && !isInNullnessAnnotationPackage && !(this instanceof NestedTypeBinding)) {", "+\t\t\tReferenceBinding packageInfo = pkg.getType(TypeConstants.PACKAGE_INFO_NAME);", "+\t\t\tif (packageInfo == null) {", "+\t\t\t\t// no pkgInfo - complain", "+\t\t\t\tthis.scope.problemReporter().missingNonNullByDefaultAnnotation(this.scope.referenceContext);", "+\t\t\t\tpkg.defaultNullness = NULL_UNSPECIFIED_BY_DEFAULT;", "+\t\t\t} else {", "+\t\t\t\t// if pkgInfo has no default annot. - complain", "+\t\t\t\tpackageInfo.getAnnotationTagBits();", "+\t\t\t}", "+\t\t}", "+\t}", "-\t\tif (CharOperation.equals(this.sourceName, TypeConstants.PACKAGE_INFO_NAME)) {", "-\t\t\tgetPackage().defaultNullness = newDefaultNullness;", "+\t\tif (isPackageInfo) {", "+\t\t\tpkg.defaultNullness = newDefaultNullness;", "+\t} else if (isPackageInfo || (isInDefaultPkg && !(this instanceof NestedTypeBinding))) {", "+\t\tthis.scope.problemReporter().missingNonNullByDefaultAnnotation(this.scope.referenceContext);", "+\t\tif (!isInDefaultPkg)", "+\t\t\tpkg.defaultNullness = NULL_UNSPECIFIED_BY_DEFAULT;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "cd68c1b2ac64911900744a4cb4f3f9ad", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/compiler/org/eclipse/jdt/internal/compiler/lookup/BinaryTypeBinding.java", "commitBeforeChange": "c2e73e92d84b995d792bc11e9e3cc44e31128806", "commitAfterChange": "7530e9811f8e0b012d59fd23237f75cdb4977fd6", "methodNumberBeforeChange": 49, "methodNumberAfterChange": 49, "signatureBeforeChange": "  private void scanMethodForNullAnnotation(IBinaryMethod method, MethodBinding methodBinding)", "signatureAfterChange": "  private void scanMethodForNullAnnotation(IBinaryMethod method, MethodBinding methodBinding)", "diff": ["-\tif (!this.environment.globalOptions.isAnnotationBasedNullAnalysisEnabled)", "-\t\treturn;", "-\tboolean useTypeAnnotations = this.environment.globalOptions.sourceLevel >= ClassFileConstants.JDK1_8;", "-\t// in 1.8 we only need @NonNullByDefault, see below and exit further down.", "-\tboolean explicitNullness = false;", "-\t\t\t\tmethodBinding.tagBits |= TagBits.AnnotationNonNullByDefault;", "-\t\t\t\tif (useTypeAnnotations)", "-\t\t\t\t\tmethodBinding.defaultNullness = getNonNullByDefaultValue(annotations[i]);", "-\t\t\t}", "-\t\t\tif (!useTypeAnnotations && !explicitNullness) {", "-\t\t\t\tif (CharOperation.equals(typeName, nonNullAnnotationName)) {", "-\t\t\t\t\tmethodBinding.tagBits |= TagBits.AnnotationNonNull;", "-\t\t\t\t\texplicitNullness = true;", "-\t\t\t\t} else if (CharOperation.equals(typeName, nullableAnnotationName)) {", "-\t\t\t\t\tmethodBinding.tagBits |= TagBits.AnnotationNullable;", "-\t\t\t\t\texplicitNullness = true;", "-\t\t\t\t}", "+\t\t\t\tmethodBinding.defaultNullness = getNonNullByDefaultValue(annotations[i]);", "+\t\t\t\tif (methodBinding.defaultNullness == Binding.NULL_UNSPECIFIED_BY_DEFAULT)", "+\t\t\t\t\tmethodBinding.tagBits |= TagBits.AnnotationNullUnspecifiedByDefault;", "+\t\t\t\telse if (methodBinding.defaultNullness != 0)", "+\t\t\t\t\tmethodBinding.tagBits |= TagBits.AnnotationNonNullByDefault;", "+\t\t\t} else if (CharOperation.equals(typeName, nonNullAnnotationName)) {", "+\t\t\t\tmethodBinding.tagBits |= TagBits.AnnotationNonNull;", "+\t\t\t} else if (CharOperation.equals(typeName, nullableAnnotationName)) {", "+\t\t\t\tmethodBinding.tagBits |= TagBits.AnnotationNullable;", "-", "-\tif (useTypeAnnotations)", "-\t\treturn;"]}], "num": 62473}