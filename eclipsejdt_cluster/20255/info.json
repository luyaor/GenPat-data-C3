{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "9c701f14df22ec8e2f75256a8200a57a", "detectedBy": ["AST_HIERARCHICAL", "AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "161ffa9d40fd2cbabfd5f9c927462227", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/compiler/org/eclipse/jdt/internal/compiler/lookup/BlockScope.java", "commitBeforeChange": "837e74414fb9b240932cd6afae3110277fb777db", "commitAfterChange": "a966ab9bd6f1a46289abe3e77d65d881ca0ea764", "methodNumberBeforeChange": 10, "methodNumberAfterChange": 10, "signatureBeforeChange": "\r \r public final void computeLocalVariablePositions(int initOffset, CodeStream codeStream)", "signatureAfterChange": "\r \r public final void computeLocalVariablePositions(int offset, CodeStream codeStream)", "diff": ["-public final void computeLocalVariablePositions(int initOffset, CodeStream codeStream) {\r", "-\tObjectVector returnAddresses = new ObjectVector();\r", "-\tcomputeLocalVariablePositions(initOffset, codeStream, returnAddresses);\r", "-\tfor (int i = 0, length = returnAddresses.size(); i < length; i++){\r", "-\t\tLocalVariableBinding returnAddress = (LocalVariableBinding)returnAddresses.elementAt(i);\t\r", "-\t\treturnAddress.resolvedPosition = this.maxOffset ++;\r", "-\t}\r", "-}\r", "+public final void computeLocalVariablePositions(int offset, CodeStream codeStream) {\r", "+\r", "+\t\t\tif (subscopes[iscope] instanceof BlockScope)\r", "+\t\t\t\t((BlockScope) subscopes[iscope]).computeLocalVariablePositions(offset, codeStream);\r", "+\t\t\t\tif (local.declaration != null)\r", "+\t\t\t\t\tcodeStream.record(local); // record user local variables for attribute generation\r", "+\t\t\t\tlocal.resolvedPosition = offset;\r", "+\t\t\t\t// check for too many arguments/local variables\r", "+\t\t\t\tif(local.isArgument){\r", "+\t\t\t\t\tif (offset > 0xFF){ // no more than 255 words of arguments\r", "+\t\t\t\t\t\tthis.problemReporter().noMoreAvailableSpaceForArgument(local.declaration);\r", "+\t\t\t\t\t}\r", "+\t\t\t\t\tif(offset > 0xFFFF){ // no more than 65535 words of locals\r", "+\t\t\t\t\t\tthis.problemReporter().noMoreAvailableSpaceForLocal(local.declaration);\r", "+\t\t\t\tif ((local.type == LongBinding) || (local.type == DoubleBinding))\r", "+\t\t\t\t\toffset += 2;\r", "+\t\t\t\telse\r", "+\t\t\t\t\toffset++;\r"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "77666568853233091d3599a99fc3dc70", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/compiler/org/eclipse/jdt/internal/compiler/lookup/BlockScope.java", "commitBeforeChange": "a80af3efb100ecaa2771b9b64ea9f8becf2538e2", "commitAfterChange": "e31a3d332f7041212032bc8ecaf89b88f9f4b3f9", "methodNumberBeforeChange": 10, "methodNumberAfterChange": 10, "signatureBeforeChange": "\r \r public final void computeLocalVariablePositions(int initOffset, CodeStream codeStream)", "signatureAfterChange": "\r \tpublic void computeLocalVariablePositions(\r \t\tint initOffset,\r \t\tCodeStream codeStream)", "diff": ["-\r", "-public final void computeLocalVariablePositions(int initOffset, CodeStream codeStream) {\r", "-\tObjectVector returnAddresses = new ObjectVector();\r", "-\tcomputeLocalVariablePositions(initOffset, codeStream, returnAddresses);\r", "-\tfor (int i = 0, length = returnAddresses.size(); i < length; i++){\r", "-\t\tLocalVariableBinding returnAddress = (LocalVariableBinding)returnAddresses.elementAt(i);\t\r", "-\t\treturnAddress.resolvedPosition = this.maxOffset ++;\r", "-}\r", "+\t */\r", "+\tpublic void computeLocalVariablePositions(\r", "+\t\tint initOffset,\r", "+\t\tCodeStream codeStream) {\r", "+\r", "+\t\tthis.offset = initOffset;\r", "+\t\tthis.maxOffset = initOffset;\r", "+\r", "+\t\t// local variable init\r", "+\t\tint ilocal = 0, maxLocals = 0, localsLength = locals.length;\r", "+\t\twhile ((maxLocals < localsLength) && (locals[maxLocals] != null))\r", "+\t\t\tmaxLocals++;\r", "+\t\tboolean hasMoreVariables = maxLocals > 0;\r", "+\r", "+\t\t// scope init\r", "+\t\tint iscope = 0, maxScopes = 0, subscopesLength = subscopes.length;\r", "+\t\twhile ((maxScopes < subscopesLength) && (subscopes[maxScopes] != null))\r", "+\t\t\tmaxScopes++;\r", "+\t\tboolean hasMoreScopes = maxScopes > 0;\r", "+\r", "+\t\t// iterate scopes and variables in parallel\r", "+\t\twhile (hasMoreVariables || hasMoreScopes) {\r", "+\t\t\tif (hasMoreScopes\r", "+\t\t\t\t&& (!hasMoreVariables || (subscopes[iscope].startIndex() <= ilocal))) {\r", "+\t\t\t\t// consider subscope first\r", "+\t\t\t\tif (subscopes[iscope] instanceof BlockScope) {\r", "+\t\t\t\t\tBlockScope subscope = (BlockScope) subscopes[iscope];\r", "+\t\t\t\t\tint subOffset =\r", "+\t\t\t\t\t\tsubscope.shiftScope == null ? this.offset : subscope.shiftScope.offset;\r", "+\t\t\t\t\tsubscope.computeLocalVariablePositions(subOffset, codeStream);\r", "+\t\t\t\t\tif (subscope.maxOffset > this.maxOffset)\r", "+\t\t\t\t\t\tthis.maxOffset = subscope.maxOffset;\r", "+\t\t\t\thasMoreScopes = ++iscope < maxScopes;\r", "+\t\t\t\t// consider variable first\r", "+\t\t\t\tLocalVariableBinding local = locals[ilocal];\r", "+\t\t\t\t// check if variable is actually used, and may force it to be preserved\r", "+\t\t\t\tboolean generatesLocal =\r", "+\t\t\t\t\t(local.used && (local.constant == Constant.NotAConstant)) || local.isArgument;\r", "+\t\t\t\tif (!local.used\r", "+\t\t\t\t\t&& (local.declaration != null)) { // unused (and non secret) local\r", "+\t\t\t\t\tif (local.isArgument) // method argument\r", "+\t\t\t\t\t\tthis.problemReporter().unusedArgument(local.declaration);\r", "+\t\t\t\t\telse if (!(local.declaration instanceof Argument)) // catch variable\r", "+\t\t\t\t\t\tthis.problemReporter().unusedLocalVariable(local.declaration);\r", "+\t\t\t\t}\r", "+\t\t\t\tif (!generatesLocal) {\r", "+\t\t\t\t\tif (local.declaration != null\r", "+\t\t\t\t\t\t&& referenceCompilationUnit().problemReporter.options.preserveAllLocalVariables) {\r", "+\t\t\t\t\t\tgeneratesLocal = true; // force it to be preserved in the generated code\r", "+\t\t\t\t\t\tlocal.used = true;\r", "+\t\t\t\t}\r", "+\t\t\t\tif (generatesLocal) {\r", "+\r", "+\t\t\t\t\t// Return addresses are managed separately afterwards.\r", "+\t\t\t\t\tif (local.name != TryStatement.SecretReturnName) {\r", "+\r", "+\t\t\t\t\t\tif (local.declaration != null) {\r", "+\t\t\t\t\t\t\tcodeStream.record(local);\r", "+\t\t\t\t\t\t\t// record user local variables for attribute generation\r", "+\t\t\t\t\t\t}\r", "+\t\t\t\t\t\t// allocate variable position\r", "+\t\t\t\t\t\tlocal.resolvedPosition = this.offset;\r", "+\r", "+\t\t\t\t\t\t// check for too many arguments/local variables\r", "+\t\t\t\t\t\tif (local.isArgument) {\r", "+\t\t\t\t\t\t\tif (this.offset > 0xFF) { // no more than 255 words of arguments\r", "+\t\t\t\t\t\t\t\tthis.problemReporter().noMoreAvailableSpaceForArgument(local.declaration);\r", "+\t\t\t\t\t\t\t}\r", "+\t\t\t\t\t\t} else {\r", "+\t\t\t\t\t\t\tif (this.offset > 0xFFFF) { // no more than 65535 words of locals\r", "+\t\t\t\t\t\t\t\tthis.problemReporter().noMoreAvailableSpaceForLocal(local.declaration);\r", "+\t\t\t\t\t\t\t}\r", "+\t\t\t\t\t\t}\r", "+\r", "+\t\t\t\t\t\t// increment offset\r", "+\t\t\t\t\t\tif ((local.type == LongBinding) || (local.type == DoubleBinding)) {\r", "+\t\t\t\t\t\t\tthis.offset += 2;\r", "+\t\t\t\t\t\t} else {\r", "+\t\t\t\t\t\t\tthis.offset++;\r", "+\t\t\t\t\t\t}\r", "+\t\t\t\t\t}\r", "+\t\t\t\t} else {\r", "+\t\t\t\t\tlocal.resolvedPosition = -1; // not generated\r", "+\t\t\t\t}\r", "+\t\t\t\thasMoreVariables = ++ilocal < maxLocals;\r", "+\t\t\t}\r", "+\t\t}\r", "+\t\tif (this.offset > this.maxOffset)\r", "+\t\t\tthis.maxOffset = this.offset;\r", "+\t}\r"]}], "num": 20255}