{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "c90380fa8162292bc1dd6be1e1e5f6b6", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "a372e3adb1190428e622c050766aa3fd", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/search/org/eclipse/jdt/internal/core/search/indexing/IndexAllProject.java", "commitBeforeChange": "2acf337b771d06ad716c2ae54bdb8443b5b5d1d6", "commitAfterChange": "28f793f875e5d5b5aa1f2b69f1f41ea8e36715ac", "methodNumberBeforeChange": 4, "methodNumberAfterChange": 3, "signatureBeforeChange": " \tpublic boolean execute(IProgressMonitor progressMonitor)", "signatureAfterChange": " \tpublic boolean execute(IProgressMonitor progressMonitor)", "diff": ["-\t\t", "-\t\tif (progressMonitor != null && progressMonitor.isCanceled()) return COMPLETE;", "-\t\tif (!project.isOpen())", "-\t\t\treturn COMPLETE; // nothing to do", "+\t\tif (progressMonitor != null && progressMonitor.isCanceled()) return true;", "+\t\tif (!project.isAccessible()) return true; // nothing to do", "-\t\tIIndex index = manager.getIndex(project.getFullPath(), true /*reuse index file*/, true /*create if none*/);", "-\t\tif (index == null)", "-\t\t\treturn COMPLETE;", "-\t\tReadWriteMonitor monitor = manager.getMonitorFor(index);", "-\t\tif (monitor == null)", "-\t\t\treturn COMPLETE; // index got deleted since acquired", "+\t\tIPath projectPath = this.project.getFullPath();", "+\t\tIIndex index = this.manager.getIndex(projectPath, true, /*reuse index file*/ true /*create if none*/);", "+\t\tif (index == null) return true;", "+\t\tReadWriteMonitor monitor = this.manager.getMonitorFor(index);", "+\t\tif (monitor == null) return true; // index got deleted since acquired", "+", "+\t\t\tsaveIfNecessary(index, monitor);", "-\t\t\t/* if index has changed, commit these before querying */", "-\t\t\tif (index.hasChanged()) {", "-\t\t\t\ttry {", "-\t\t\t\t\tmonitor.exitRead(); // free read lock", "-\t\t\t\t\tmonitor.enterWrite(); // ask permission to write", "-\t\t\t\t\tif (IndexManager.VERBOSE)", "-\t\t\t\t\t\tJobManager.verbose(\"-> merging index \" + index.getIndexFile()); //$NON-NLS-1$", "-\t\t\t\t\tindex.save();", "-\t\t\t\t} catch (IOException e) {", "-\t\t\t\t\treturn FAILED;", "-\t\t\t\t} finally {", "-\t\t\t\t\tmonitor.exitWriteEnterRead(); // finished writing and reacquire read permission", "-\t\t\t\t}", "-\t\t\t}", "-\t\t\tthis.indexLastModified = index.getIndexFile().lastModified();", "-", "-\t\t\tthis.indexedFileNames = new Hashtable(100);", "-\t\t\tfor (int i = 0, max = results == null ? 0 : results.length; i < max; i++) {", "-\t\t\t\tString fileName = results[i].getPath();", "-\t\t\t\tthis.indexedFileNames.put(fileName, DELETED);", "-\t\t\t}", "-\t\t\tIJavaProject javaProject = JavaCore.create(this.project);", "-\t\t\tIClasspathEntry[] entries = javaProject.getRawClasspath(); //only interested in source folders", "+\t\t\tint max = results == null ? 0 : results.length;", "+\t\t\tfinal Hashtable indexedFileNames = new Hashtable(100);", "+\t\t\tfinal String OK = \"OK\"; //$NON-NLS-1$", "+\t\t\tfinal String DELETED = \"DELETED\"; //$NON-NLS-1$", "+\t\t\tfor (int i = 0; i < max; i++)", "+\t\t\t\tindexedFileNames.put(results[i].getPath(), DELETED);", "+\t\t\tfinal long indexLastModified = max == 0 ? 0L : index.getIndexFile().lastModified();", "+", "+\t\t\tIClasspathEntry[] entries = JavaCore.create(this.project).getRawClasspath();", "-\t\t\t\tif (this.isCancelled) return FAILED;", "-\t\t\t\t", "+\t\t\t\tif (this.isCancelled) return false;", "+", "-\t\t\t\t// Index only the project's source folders.", "-\t\t\t\t// Indexing of libraries is done in a separate job", "-\t\t\t\tif ((entry.getEntryKind() == IClasspathEntry.CPE_SOURCE)) {", "-\t\t\t\t\tIPath entryPath = entry.getPath();", "-\t\t\t\t\tIResource sourceFolder = root.findMember(entryPath);", "+\t\t\t\tif ((entry.getEntryKind() == IClasspathEntry.CPE_SOURCE)) { // Index only source folders. Libraries are done as a separate job", "+\t\t\t\t\tIResource sourceFolder = root.findMember(entry.getPath());", "-\t\t\t\t\t\tthis.currentExclusionPatterns = ((ClasspathEntry)entry).fullExclusionPatternChars();", "-\t\t\t\t\t\tsourceFolder.accept(this);", "+\t\t\t\t\t\tfinal char[][] patterns = ((ClasspathEntry) entry).fullExclusionPatternChars();", "+\t\t\t\t\t\tif (max == 0) {", "+\t\t\t\t\t\t\tsourceFolder.accept(new IResourceVisitor() {", "+\t\t\t\t\t\t\t\tpublic boolean visit(IResource resource) {", "+\t\t\t\t\t\t\t\t\tif (isCancelled) return false;", "+\t\t\t\t\t\t\t\t\tif (resource.getType() == IResource.FILE) {", "+\t\t\t\t\t\t\t\t\t\tif (Util.isJavaFileName(resource.getName()) && resource.getLocation() != null) {", "+\t\t\t\t\t\t\t\t\t\t\tif (patterns == null || !Util.isExcluded(resource, patterns)) {", "+\t\t\t\t\t\t\t\t\t\t\t\tString name = new IFileDocument((IFile) resource).getName();", "+\t\t\t\t\t\t\t\t\t\t\t\tindexedFileNames.put(name, resource);", "+\t\t\t\t\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\t\t\t\treturn false;", "+\t\t\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\t\t\treturn true;", "+\t\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\t});", "+\t\t\t\t\t\t} else {", "+\t\t\t\t\t\t\tsourceFolder.accept(new IResourceVisitor() {", "+\t\t\t\t\t\t\t\tpublic boolean visit(IResource resource) {", "+\t\t\t\t\t\t\t\t\tif (isCancelled) return false;", "+\t\t\t\t\t\t\t\t\tif (resource.getType() == IResource.FILE) {", "+\t\t\t\t\t\t\t\t\t\tif (Util.isJavaFileName(resource.getName())) {", "+\t\t\t\t\t\t\t\t\t\t\tIPath path = resource.getLocation();", "+\t\t\t\t\t\t\t\t\t\t\tif (path != null && (patterns == null || !Util.isExcluded(resource, patterns))) {", "+\t\t\t\t\t\t\t\t\t\t\t\tString name = new IFileDocument((IFile) resource).getName();", "+\t\t\t\t\t\t\t\t\t\t\t\tindexedFileNames.put(name,", "+\t\t\t\t\t\t\t\t\t\t\t\t\tindexedFileNames.get(name) == null || indexLastModified < path.toFile().lastModified()", "+\t\t\t\t\t\t\t\t\t\t\t\t\t\t? (Object) resource", "+\t\t\t\t\t\t\t\t\t\t\t\t\t\t: (Object) OK);", "+\t\t\t\t\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\t\t\t\treturn false;", "+\t\t\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\t\t\treturn true;", "+\t\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\t});", "+\t\t\t\t\t\t}", "-\t\t\t", "-\t\t\tIPath projectPath = this.project.getFullPath();", "+", "+\t\t\tboolean shouldSave = false;", "-\t\t\t\tif (this.isCancelled) return FAILED;", "+\t\t\t\tif (this.isCancelled) return false;", "-\t\t\t\tif (value instanceof IFile) {", "-\t\t\t\t\tmanager.addSource((IFile) value, projectPath);", "-\t\t\t\t} else if (value == DELETED) {", "-\t\t\t\t\tmanager.remove(name, projectPath);", "+\t\t\t\tif (value != OK) {", "+\t\t\t\t\tshouldSave = true;", "+\t\t\t\t\tif (value == DELETED)", "+\t\t\t\t\t\tthis.manager.remove(name, projectPath);", "+\t\t\t\t\telse", "+\t\t\t\t\t\tthis.manager.addSource((IFile) value, projectPath);", "-\t\t\tmanager.request(new SaveIndex(projectPath, manager));", "+\t\t\tif (shouldSave)", "+\t\t\t\tthis.manager.request(new SaveIndex(projectPath, manager));", "-\t\t\tmanager.removeIndex(project.getFullPath());", "-\t\t\treturn FAILED;", "+\t\t\tthis.manager.removeIndex(projectPath);", "+\t\t\treturn false;", "-\t\t\tmanager.removeIndex(project.getFullPath());", "-\t\t\treturn FAILED;", "+\t\t\tthis.manager.removeIndex(projectPath);", "+\t\t\treturn false;", "-\t\treturn COMPLETE;", "-\t}"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "e19ed98e12c954fbe20b089fa947e489", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/search/org/eclipse/jdt/internal/core/search/indexing/IndexBinaryFolder.java", "commitBeforeChange": "2acf337b771d06ad716c2ae54bdb8443b5b5d1d6", "commitAfterChange": "28f793f875e5d5b5aa1f2b69f1f41ea8e36715ac", "methodNumberBeforeChange": 4, "methodNumberAfterChange": 3, "signatureBeforeChange": " \tpublic boolean execute(IProgressMonitor progressMonitor)", "signatureAfterChange": " \tpublic boolean execute(IProgressMonitor progressMonitor)", "diff": ["-\t\tif (progressMonitor != null && progressMonitor.isCanceled()) return COMPLETE;", "+\t\tif (progressMonitor != null && progressMonitor.isCanceled()) return true;", "+\t\tif (!this.folder.isAccessible()) return true; // nothing to do", "-\t\tif (!this.folder.isAccessible())", "-\t\t\treturn COMPLETE; // nothing to do", "+\t\tIPath folderPath = this.folder.getFullPath();", "+\t\tIIndex index = this.manager.getIndex(folderPath, true, /*reuse index file*/ true /*create if none*/);", "+\t\tif (index == null) return true;", "+\t\tReadWriteMonitor monitor = this.manager.getMonitorFor(index);", "+\t\tif (monitor == null) return true; // index got deleted since acquired", "-\t\tIIndex index = manager.getIndex(this.folder.getFullPath(), true /*reuse index file*/, true /*create if none*/);", "-\t\tif (index == null)", "-\t\t\treturn COMPLETE;", "-\t\tReadWriteMonitor monitor = manager.getMonitorFor(index);", "-\t\tif (monitor == null)", "-\t\t\treturn COMPLETE; // index got deleted since acquired", "+\t\t\tsaveIfNecessary(index, monitor);", "-\t\t\t/* if index has changed, commit these before querying */", "-\t\t\tif (index.hasChanged()) {", "-\t\t\t\ttry {", "-\t\t\t\t\tmonitor.exitRead(); // free read lock", "-\t\t\t\t\tmonitor.enterWrite(); // ask permission to write", "-\t\t\t\t\tif (IndexManager.VERBOSE)", "-\t\t\t\t\t\tJobManager.verbose(\"-> merging index \" + index.getIndexFile()); //$NON-NLS-1$", "-\t\t\t\t\tindex.save();", "-\t\t\t\t} catch (IOException e) {", "-\t\t\t\t\treturn FAILED;", "-\t\t\t\t} finally {", "-\t\t\t\t\tmonitor.exitWriteEnterRead(); // finished writing and reacquire read permission", "-\t\t\t\t}", "-\t\t\t}", "+\t\t\tIQueryResult[] results = index.queryInDocumentNames(\"\"); // all file names //$NON-NLS-1$", "+\t\t\tint max = results == null ? 0 : results.length;", "+\t\t\tfinal Hashtable indexedFileNames = new Hashtable(100);", "-\t\t\tfinal long indexLastModified = index.getIndexFile().lastModified();", "-", "-\t\t\tfinal Hashtable indexedFileNames = new Hashtable(100);", "-\t\t\tIQueryResult[] results = index.queryInDocumentNames(\"\");// all file names //$NON-NLS-1$", "-\t\t\tfor (int i = 0, max = results == null ? 0 : results.length; i < max; i++) {", "-\t\t\t\tString fileName = results[i].getPath();", "-\t\t\t\tindexedFileNames.put(fileName, DELETED);", "-\t\t\t}", "-\t\t\tthis.folder.accept(new IResourceVisitor() {", "-\t\t\t\tpublic boolean visit(IResource resource) {", "-\t\t\t\t\tif (isCancelled) return false;", "-\t\t\t\t\tif (resource.getType() == IResource.FILE) {", "-\t\t\t\t\t\tString extension = resource.getFileExtension();", "-\t\t\t\t\t\tif ((extension != null)", "-\t\t\t\t\t\t\t&& extension.equalsIgnoreCase(\"class\")) { //$NON-NLS-1$", "-\t\t\t\t\t\t\tIPath path = resource.getLocation();", "-\t\t\t\t\t\t\tif (path != null) {", "-\t\t\t\t\t\t\t\tFile resourceFile = path.toFile();", "+\t\t\tif (max == 0) {", "+\t\t\t\tthis.folder.accept(new IResourceVisitor() {", "+\t\t\t\t\tpublic boolean visit(IResource resource) {", "+\t\t\t\t\t\tif (isCancelled) return false;", "+\t\t\t\t\t\tif (resource.getType() == IResource.FILE) {", "+\t\t\t\t\t\t\tif (Util.isClassFileName(resource.getName()) && resource.getLocation() != null) {", "-\t\t\t\t\t\t\t\tif (indexedFileNames.get(name) == null) {", "-\t\t\t\t\t\t\t\t\tindexedFileNames.put(name, resource);", "-\t\t\t\t\t\t\t\t} else {", "-\t\t\t\t\t\t\t\t\tindexedFileNames.put(", "-\t\t\t\t\t\t\t\t\t\tname,", "-\t\t\t\t\t\t\t\t\t\tresourceFile.lastModified() > indexLastModified", "+\t\t\t\t\t\t\t\tindexedFileNames.put(name, resource);", "+\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\treturn false;", "+\t\t\t\t\t\t}", "+\t\t\t\t\t\treturn true;", "+\t\t\t\t\t}", "+\t\t\t\t});", "+\t\t\t} else {", "+\t\t\t\tfor (int i = 0; i < max; i++)", "+\t\t\t\t\tindexedFileNames.put(results[i].getPath(), DELETED);", "+", "+\t\t\t\tfinal long indexLastModified = index.getIndexFile().lastModified();", "+\t\t\t\tthis.folder.accept(new IResourceVisitor() {", "+\t\t\t\t\tpublic boolean visit(IResource resource) {", "+\t\t\t\t\t\tif (isCancelled) return false;", "+\t\t\t\t\t\tif (resource.getType() == IResource.FILE) {", "+\t\t\t\t\t\t\tif (Util.isClassFileName(resource.getName())) {", "+\t\t\t\t\t\t\t\tIPath path = resource.getLocation();", "+\t\t\t\t\t\t\t\tif (path != null) {", "+\t\t\t\t\t\t\t\t\tString name = new IFileDocument((IFile) resource).getName();", "+\t\t\t\t\t\t\t\t\tindexedFileNames.put(name,", "+\t\t\t\t\t\t\t\t\t\tindexedFileNames.get(name) == null || indexLastModified < path.toFile().lastModified()", "+\t\t\t\t\t\t\treturn false;", "-\t\t\t\t\t\treturn false;", "+\t\t\t\t\t\treturn true;", "-\t\t\t\t\treturn true;", "-\t\t\t\t}", "-\t\t\t});", "+\t\t\t\t});", "+\t\t\t}", "-\t\t\tIPath folderPath = this.folder.getFullPath();", "-\t\t\tIPath projectPath = this.project.getFullPath();", "+\t\t\tboolean shouldSave = false;", "-\t\t\t\tif (this.isCancelled) return FAILED;", "-\t\t\t\t", "+\t\t\t\tif (this.isCancelled) return false;", "+", "-\t\t\t\tif (value instanceof IFile) {", "-\t\t\t\t\tmanager.addBinary((IFile) value, folderPath);", "-\t\t\t\t} else if (value == DELETED) {", "-\t\t\t\t\tmanager.remove(name, projectPath);", "+\t\t\t\tif (value != OK) {", "+\t\t\t\t\tshouldSave = true;", "+\t\t\t\t\tif (value == DELETED)", "+\t\t\t\t\t\tthis.manager.remove(name, folderPath);", "+\t\t\t\t\telse", "+\t\t\t\t\t\tthis.manager.addBinary((IFile) value, folderPath);", "-\t\t\tmanager.request(new SaveIndex(folderPath, manager));", "+\t\t\tif (shouldSave)", "+\t\t\t\tthis.manager.request(new SaveIndex(folderPath, manager));", "-\t\t\tmanager.removeIndex(this.folder.getFullPath());", "-\t\t\treturn FAILED;", "+\t\t\tthis.manager.removeIndex(folderPath);", "+\t\t\treturn false;", "-\t\t\tmanager.removeIndex(this.folder.getFullPath());", "-\t\t\treturn FAILED;", "+\t\t\tthis.manager.removeIndex(folderPath);", "+\t\t\treturn false;", "-\t\treturn COMPLETE;", "+\t\treturn true;", "+\t}"]}], "num": 56215}