{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "24fe344b4d82306a5c383471b4ac050d", "detectedBy": ["DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "51308ef7318ec855f09f87d3c7aae681", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/dom/org/eclipse/jdt/core/dom/DefaultCommentMapper.java", "commitBeforeChange": "fe16fe907972b2b0368c7cfd0298f309b98902c7", "commitAfterChange": "dc6e426600c06cd88dd174580a09881117be9e03", "methodNumberBeforeChange": 11, "methodNumberAfterChange": 11, "signatureBeforeChange": " \tint storeTrailingComments(ASTNode node, int nextStart,  boolean lastChild)", "signatureAfterChange": " \tint storeTrailingComments(ASTNode node, int nextStart,  boolean lastChild)", "diff": ["-\t\t\t\tthis.trailingIndexes = new int[STORAGE_INCREMENT][];", "+\t\t\t\tthis.trailingIndexes = new long[STORAGE_INCREMENT];", "-\t\t\t\tSystem.arraycopy(this.trailingIndexes, 0, this.trailingIndexes = new int[newLength][], 0, this.trailingPtr);", "+\t\t\t\tSystem.arraycopy(this.trailingIndexes, 0, this.trailingIndexes = new long[newLength], 0, this.trailingPtr);", "-\t\t\tthis.trailingIndexes[this.trailingPtr] = new int[] { -1, -1 };", "+\t\t\tthis.trailingIndexes[this.trailingPtr] = -1;", "-\t\t\t\tthis.trailingIndexes = new int[STORAGE_INCREMENT][];", "+\t\t\t\tthis.trailingIndexes = new long[STORAGE_INCREMENT];", "-\t\t\t\tSystem.arraycopy(this.trailingIndexes, 0, this.trailingIndexes = new int[newLength][], 0, this.trailingPtr);", "+\t\t\t\tSystem.arraycopy(this.trailingIndexes, 0, this.trailingIndexes = new long[newLength], 0, this.trailingPtr);", "-\t\t\tint[] nodeRange = new int[] { startIdx, endIdx };", "+\t\t\tlong nodeRange = (((long)startIdx)<<32) + endIdx;", "-\t\t\t\tint[] range = this.trailingIndexes[ptr];", "-\t\t\t\tif (range[0] != -1 || range[1] != -1) break; // there's no more unresolved nodes", "+\t\t\t\tlong range = this.trailingIndexes[ptr];", "+\t\t\t\tif (range != -1) break; // there's no more unresolved nodes"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "a91a90469ef8d6b7314cf29b9a2ae23e", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/dom/org/eclipse/jdt/core/dom/DefaultCommentMapper.java", "commitBeforeChange": "e178d64eb65916b8b54353dd9e6bcf5b085bf212", "commitAfterChange": "b43b2427c7b970b1fbbb18c36881f31743b7cd83", "methodNumberBeforeChange": 11, "methodNumberAfterChange": 11, "signatureBeforeChange": " \tint storeTrailingComments(ASTNode node, int nextStart,  boolean lastChild)", "signatureAfterChange": " \tint storeTrailingComments(ASTNode node, int nextStart,  boolean lastChild)", "diff": ["-\t\t\tthis.trailingComments.put(node, new int[] { -1, -1 });", "+\t\t\tif (++this.trailingPtr == 0) {", "+\t\t\t\tthis.trailingNodes = new ASTNode[STORAGE_INCREMENT];", "+\t\t\t\tthis.trailingIndexes = new int[STORAGE_INCREMENT][];", "+\t\t\t\tthis.lastTrailingPtr = -1;", "+\t\t\t} else if (this.trailingPtr == this.trailingNodes.length) {", "+\t\t\t\tint newLength = (this.trailingPtr*3/2)+STORAGE_INCREMENT;", "+\t\t\t\tSystem.arraycopy(this.trailingNodes, 0, this.trailingNodes = new ASTNode[newLength], 0, this.trailingPtr);", "+\t\t\t\tSystem.arraycopy(this.trailingIndexes, 0, this.trailingIndexes = new int[newLength][], 0, this.trailingPtr);", "+\t\t\t}", "+\t\t\tthis.trailingNodes[this.trailingPtr] = node;", "+\t\t\tthis.trailingIndexes[this.trailingPtr] = new int[] { -1, -1 };", "-\t\t\tthis.trailingComments.put(node, new int[] { startIdx, endIdx });", "+\t\t\tif (++this.trailingPtr == 0) {", "+\t\t\t\tthis.trailingNodes = new ASTNode[STORAGE_INCREMENT];", "+\t\t\t\tthis.trailingIndexes = new int[STORAGE_INCREMENT][];", "+\t\t\t\tthis.lastTrailingPtr = -1;", "+\t\t\t} else if (this.trailingPtr == this.trailingNodes.length) {", "+\t\t\t\tint newLength = (this.trailingPtr*3/2)+STORAGE_INCREMENT;", "+\t\t\t\tSystem.arraycopy(this.trailingNodes, 0, this.trailingNodes = new ASTNode[newLength], 0, this.trailingPtr);", "+\t\t\t\tSystem.arraycopy(this.trailingIndexes, 0, this.trailingIndexes = new int[newLength][], 0, this.trailingPtr);", "+\t\t\t}", "+\t\t\tthis.trailingNodes[this.trailingPtr] = node;", "+\t\t\tint[] nodeRange = new int[] { startIdx, endIdx };", "+\t\t\tthis.trailingIndexes[this.trailingPtr] = nodeRange;", "+\t\t\t// Compute new extended end", "+\t\t\t// Look for children unresolved extended end", "+\t\t\tASTNode previousNode = node;", "+\t\t\tint ptr = this.trailingPtr - 1; // children extended end were stored before", "+\t\t\tunresolved: while (ptr >= 0) {", "+\t\t\t\tint[] range = this.trailingIndexes[ptr];", "+\t\t\t\tif (range[0] != -1 || range[1] != -1) break; // there's no more unresolved nodes", "+\t\t\t\tASTNode unresolved = this.trailingNodes[ptr];", "+\t\t\t\tif (previousNode != unresolved.getParent()) break; // we're no longer in node ancestor hierarchy", "+\t\t\t\tthis.trailingIndexes[ptr] = nodeRange;", "+\t\t\t\tpreviousNode = unresolved;", "+\t\t\t\tptr--; // get previous node", "+\t\t\t}", "+\t\t\t// Remove remaining unresolved nodes", "+\t\t\tif (ptr > this.lastTrailingPtr) {", "+\t\t\t\tint offset = ptr - this.lastTrailingPtr;", "+\t\t\t\tfor (int i=ptr+1; i<=this.trailingPtr; i++) {", "+\t\t\t\t\tthis.trailingNodes[i-offset] = this.trailingNodes[i];", "+\t\t\t\t\tthis.trailingIndexes[i-offset] = this.trailingIndexes[i];", "+\t\t\t\t}", "+\t\t\t\tthis.trailingPtr -= offset;", "+\t\t\t}", "+\t\t\tthis.lastTrailingPtr = this.trailingPtr;"]}], "num": 33099}