{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "c168ac111b130618fb93f12a7de19b0e", "detectedBy": ["DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "026ab5cf8f6990907d96c675a673de05", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/compiler/org/eclipse/jdt/internal/compiler/flow/FinallyFlowContext.java", "commitBeforeChange": "c85c898de3099d8d87b870385bc47667302c5e21", "commitAfterChange": "73c6d3ea7dc5df8e531fcab68ea3f39bbd288577", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": " \tpublic void complainOnDeferredChecks(FlowInfo flowInfo, BlockScope scope)", "signatureAfterChange": " public void complainOnDeferredChecks(FlowInfo flowInfo, BlockScope scope)", "diff": ["-\t */", "-\tpublic void complainOnDeferredChecks(FlowInfo flowInfo, BlockScope scope) {", "+ */", "+public void complainOnDeferredChecks(FlowInfo flowInfo, BlockScope scope) {", "+\t", "+\t// check redundant final assignments", "+\tfor (int i = 0; i < this.assignCount; i++) {", "+\t\tVariableBinding variable = this.finalVariables[i];", "+\t\tif (variable == null) continue;", "-\t\t// check redundant final assignments", "-\t\tfor (int i = 0; i < assignCount; i++) {", "-\t\t\tVariableBinding variable = finalVariables[i];", "-\t\t\tif (variable == null) continue;", "-\t\t\t", "-\t\t\tboolean complained = false; // remember if have complained on this final assignment", "-\t\t\tif (variable instanceof FieldBinding) {", "-\t\t\t\t// final field", "-\t\t\t\tif (flowInfo.isPotentiallyAssigned((FieldBinding)variable)) {", "-\t\t\t\t\tcomplained = true;", "-\t\t\t\t\tscope.problemReporter().duplicateInitializationOfBlankFinalField((FieldBinding)variable, finalAssignments[i]);", "-\t\t\t\t}", "-\t\t\t} else {", "-\t\t\t\t// final local variable", "-\t\t\t\tif (flowInfo.isPotentiallyAssigned((LocalVariableBinding) variable)) {", "-\t\t\t\t\tcomplained = true;", "-\t\t\t\t\tscope.problemReporter().duplicateInitializationOfFinalLocal(", "-\t\t\t\t\t\t(LocalVariableBinding) variable,", "-\t\t\t\t\t\tfinalAssignments[i]);", "-\t\t\t\t}", "+\t\tboolean complained = false; // remember if have complained on this final assignment", "+\t\tif (variable instanceof FieldBinding) {", "+\t\t\t// final field", "+\t\t\tif (flowInfo.isPotentiallyAssigned((FieldBinding)variable)) {", "+\t\t\t\tcomplained = true;", "+\t\t\t\tscope.problemReporter().duplicateInitializationOfBlankFinalField((FieldBinding)variable, finalAssignments[i]);", "-\t\t\t// any reference reported at this level is removed from the parent context ", "-\t\t\t// where it could also be reported again", "-\t\t\tif (complained) {", "-\t\t\t\tFlowContext currentContext = parent;", "-\t\t\t\twhile (currentContext != null) {", "-\t\t\t\t\t//if (currentContext.isSubRoutine()) {", "-\t\t\t\t\tcurrentContext.removeFinalAssignmentIfAny(finalAssignments[i]);", "-\t\t\t\t\t//}", "-\t\t\t\t\tcurrentContext = currentContext.parent;", "-\t\t\t\t}", "+\t\t} else {", "+\t\t\t// final local variable", "+\t\t\tif (flowInfo.isPotentiallyAssigned((LocalVariableBinding) variable)) {", "+\t\t\t\tcomplained = true;", "+\t\t\t\tscope.problemReporter().duplicateInitializationOfFinalLocal(", "+\t\t\t\t\t(LocalVariableBinding) variable,", "+\t\t\t\t\tthis.finalAssignments[i]);", "-\t\t", "-\t\t// check inconsistent null checks", "-\t\tfor (int i = 0; i < nullCount; i++) {", "-\t\t\tExpression expression = nullReferences[i];", "-\t\t\tif (expression == null) continue;", "-\t\t\t// final local variable", "-\t\t\tLocalVariableBinding local = expression.localVariableBinding();", "-\t\t\tswitch (nullStatus[i]) {", "-\t\t\t\tcase FlowInfo.NULL :", "-\t\t\t\t\tif (flowInfo.isDefinitelyNull(local)) {", "-\t\t\t\t\t\tnullReferences[i] = null;", "-\t\t\t\t\t\tthis.parent.recordUsingNullReference(scope, local, expression, nullStatus[i], flowInfo);", "-\t\t\t\t\t}", "-\t\t\t\t\tbreak;", "-\t\t\t\tcase FlowInfo.NON_NULL :", "-\t\t\t\t\tif (flowInfo.isDefinitelyNonNull(local)) {", "-\t\t\t\t\t\tnullReferences[i] = null;", "-\t\t\t\t\t\tthis.parent.recordUsingNullReference(scope, local, expression, nullStatus[i], flowInfo);", "-\t\t\t\t\t}", "-\t\t\t\t\tbreak;", "+\t\t// any reference reported at this level is removed from the parent context ", "+\t\t// where it could also be reported again", "+\t\tif (complained) {", "+\t\t\tFlowContext currentContext = this.parent;", "+\t\t\twhile (currentContext != null) {", "+\t\t\t\t//if (currentContext.isSubRoutine()) {", "+\t\t\t\tcurrentContext.removeFinalAssignmentIfAny(this.finalAssignments[i]);", "+\t\t\t\t//}", "+\t\t\t\tcurrentContext = currentContext.parent;", "+\t", "+\t// check inconsistent null checks", "+\tif (this.deferNullDiagnostic) { // within an enclosing loop, be conservative", "+\t\tfor (int i = 0; i < this.nullCount; i++) {", "+\t\t\tExpression expression = this.nullReferences[i];", "+\t\t\tLocalVariableBinding local = this.nullLocals[i];", "+\t\t\tswitch (this.nullCheckTypes[i]) {", "+\t\t\t\tcase CAN_ONLY_NULL_NON_NULL :", "+\t\t\t\tcase CAN_ONLY_NULL:", "+\t\t\t\t\tif (flowInfo.isProtectedNonNull(local)) {", "+\t\t\t\t\t\tif (nullCheckTypes[i] == CAN_ONLY_NULL_NON_NULL) {", "+\t\t\t\t\t\t\tscope.problemReporter().localVariableCannotBeNull(local, expression);", "+\t\t\t\t\t\t}", "+\t\t\t\t\t\treturn;", "+\t\t\t\t\t}", "+\t\t\t\t\tif (flowInfo.isProtectedNull(local)) {", "+\t\t\t\t\t\tscope.problemReporter().localVariableCanOnlyBeNull(local, expression);", "+\t\t\t\t\t\treturn;", "+\t\t\t\t\t}", "+\t\t\t\t\tbreak;", "+\t\t\t\tcase MAY_NULL :", "+\t\t\t\t\tif (flowInfo.isProtectedNonNull(local)) {", "+\t\t\t\t\t\treturn;", "+\t\t\t\t\t}", "+\t\t\t\t\tif (flowInfo.isProtectedNull(local)) {", "+\t\t\t\t\t\tscope.problemReporter().localVariableCanOnlyBeNull(local, expression);", "+\t\t\t\t\t\treturn;", "+\t\t\t\t\t}", "+\t\t\t\t\tbreak;", "+\t\t\t\tdefault:", "+\t\t\t\t\t// never happens", "+\t\t\t}", "+\t\t\tthis.parent.recordUsingNullReference(scope, local, expression, ", "+\t\t\t\t\tthis.nullCheckTypes[i], flowInfo);", "+\t\t}", "+\t}", "+\telse { // no enclosing loop, be as precise as possible right now", "+\t\tfor (int i = 0; i < this.nullCount; i++) {", "+\t\t\tExpression expression = this.nullReferences[i];", "+\t\t\t// final local variable", "+\t\t\tLocalVariableBinding local = this.nullLocals[i];", "+\t\t\tswitch (this.nullCheckTypes[i]) {", "+\t\t\t\tcase CAN_ONLY_NULL_NON_NULL :", "+\t\t\t\t\tif (flowInfo.isDefinitelyNonNull(local)) {", "+\t\t\t\t\t\tscope.problemReporter().localVariableCannotBeNull(local, expression);\t\t\t\t", "+\t\t\t\t\t\treturn;", "+\t\t\t\t\t}", "+\t\t\t\tcase CAN_ONLY_NULL:", "+\t\t\t\t\tif (flowInfo.isDefinitelyNull(local)) {", "+\t\t\t\t\t\tscope.problemReporter().localVariableCanOnlyBeNull(local, expression);", "+\t\t\t\t\t\treturn;", "+\t\t\t\t\t}", "+\t\t\t\t\tbreak;", "+\t\t\t\tcase MAY_NULL :", "+\t\t\t\t\tif (flowInfo.isDefinitelyNull(local)) {", "+\t\t\t\t\t\tscope.problemReporter().localVariableCanOnlyBeNull(local, expression);", "+\t\t\t\t\t\treturn;", "+\t\t\t\t\t}", "+\t\t\t\t\tif (flowInfo.isPotentiallyNull(local)) {", "+\t\t\t\t\t\tscope.problemReporter().localVariableMayBeNull(local, expression);", "+\t\t\t\t\t\treturn;", "+\t\t\t\t\t}", "+\t\t\t\t\tbreak;", "+\t\t\t\tdefault:", "+\t\t\t\t\t// should not happen", "+\t\t\t}", "+\t\t}", "+\t}", "+}"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "7b2e05361eb2fdd4f739dd3d502c38e6", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/compiler/org/eclipse/jdt/internal/compiler/flow/FinallyFlowContext.java", "commitBeforeChange": "85b2cfd04e83239095fec1009e8fcb37543a6bed", "commitAfterChange": "a825a712d9a7173d7e7cfae42a0058bb2e0b5bb5", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": " \tpublic void complainOnRedundantFinalAssignments( \t\tFlowInfo flowInfo, \t\tBlockScope scope)", "signatureAfterChange": " \tpublic void complainOnRedundantFinalAssignments( \t\tFlowInfo flowInfo, \t\tBlockScope scope)", "diff": ["-\t\t\tReference ref;", "-\t\t\tif (((ref = finalAssignments[i]).bits & BindingIds.FIELD) != 0) {", "+\t\t\tVariableBinding variable = finalVariables[i];", "+\t\t\tif (variable == null) continue;", "+\t\t\t", "+\t\t\tboolean complained = false; // remember if have complained on this final assignment", "+\t\t\tif (variable instanceof FieldBinding) {", "-\t\t\t\tif (flowInfo.isPotentiallyAssigned(ref.fieldBinding())) {", "-\t\t\t\t\tscope.problemReporter().duplicateInitializationOfBlankFinalField(ref.fieldBinding(), ref);", "+\t\t\t\tif (flowInfo.isPotentiallyAssigned((FieldBinding)variable)) {", "+\t\t\t\t\tcomplained = true;", "+\t\t\t\t\tscope.problemReporter().duplicateInitializationOfBlankFinalField((FieldBinding)variable, finalAssignments[i]);", "-\t\t\t\tif (flowInfo", "-\t\t\t\t\t.isPotentiallyAssigned((LocalVariableBinding) ((NameReference) ref).binding)) {", "+\t\t\t\tif (flowInfo.isPotentiallyAssigned((LocalVariableBinding) variable)) {", "+\t\t\t\t\tcomplained = true;", "-\t\t\t\t\t\t(LocalVariableBinding) ((NameReference) ref).binding,", "-\t\t\t\t\t\t(NameReference) ref);", "+\t\t\t\t\t\t(LocalVariableBinding) variable,", "+\t\t\t\t\t\tfinalAssignments[i]);", "-\t\t\tFlowContext currentContext = parent;", "-\t\t\twhile (currentContext != null) {", "-\t\t\t\tif (currentContext.isSubRoutine()) {", "-\t\t\t\t\tcurrentContext.removeFinalAssignmentIfAny(ref);", "+\t\t\tif (complained) {", "+\t\t\t\tFlowContext currentContext = parent;", "+\t\t\t\twhile (currentContext != null) {", "+\t\t\t\t\t//if (currentContext.isSubRoutine()) {", "+\t\t\t\t\tcurrentContext.removeFinalAssignmentIfAny(finalAssignments[i]);", "+\t\t\t\t\t//}", "+\t\t\t\t\tcurrentContext = currentContext.parent;", "-\t\t\t\tcurrentContext = currentContext.parent;"]}], "num": 38410}