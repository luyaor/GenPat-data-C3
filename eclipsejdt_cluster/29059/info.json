{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "058625e1635715c1e6a0360e65e5d159", "detectedBy": ["AST_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "0e49985839a152d03c5fe082a3233183", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/model/org/eclipse/jdt/internal/core/builder/impl/StateImpl.java", "commitBeforeChange": "b04602938404af4f8569a399fb36a5018768a262", "commitAfterChange": "6a230a9d6ae1a4a6adbf38879cb9ee685eccffe9", "methodNumberBeforeChange": 63, "methodNumberAfterChange": 63, "signatureBeforeChange": "\r \tprotected void getSourceElementEntries(\r \t\tIPackage pkg,\r \t\tIPath path,\r \t\tLookupTable entryTable)", "signatureAfterChange": "\r \tprotected void getSourceElementEntries(IPackage pkg, IPath path, LookupTable entryTable)", "diff": ["-\tprotected void getSourceElementEntries(\r", "-\t\tIPackage pkg,\r", "-\t\tIPath path,\r", "-\t\tLookupTable entryTable) {\r", "+\tprotected void getSourceElementEntries(IPackage pkg, IPath path, LookupTable entryTable) {\r", "-\t\t\tIPackageFragmentRoot root = null;\r", "-\t\t\tIPackageFragment frag = null;\r", "-\t\t\tboolean isDefault = pkg.isUnnamed();\r", "-\t\t\tString pkgName =\r", "-\t\t\t\tisDefault ? IPackageFragment.DEFAULT_PACKAGE_NAME : pkg.getName();\r", "-\t\t\tString pkgPath = pkgName.replace('.', '/');\r", "+\t\t\tIPackageFragmentRoot root= null;\r", "+\t\t\tIPackageFragment frag= null;\r", "+\t\t\tboolean isDefault= pkg.isUnnamed();\r", "+\t\t\tString pkgName= isDefault ? IPackageFragment.DEFAULT_PACKAGE_NAME : pkg.getName();\r", "+\t\t\tString pkgPath= pkgName.replace('.', '/');\r", "-\t\t\t\tIResource member = null;\r", "-\t\t\t\tif (!path.isAbsolute()\r", "-\t\t\t\t\t|| getProject().getWorkspace().getRoot().findMember(path) != null) {\r", "-\t\t\t\t\troot = getJavaProject().getPackageFragmentRoot(getFile(path));\r", "+\t\t\t\tIResource member= null;\r", "+\t\t\t\tif (!path.isAbsolute() || getProject().getWorkspace().getRoot().findMember(path) != null) {\r", "+\t\t\t\t\troot= getJavaProject().getPackageFragmentRoot(getFile(path));\r", "-\t\t\t\t\troot = getJavaProject().getPackageFragmentRoot(path.toOSString());\r", "+\t\t\t\t\troot= getJavaProject().getPackageFragmentRoot(path.toOSString());\r", "-\t\t\t\tfrag = root.getPackageFragment(pkgName);\r", "+\t\t\t\tfrag= root.getPackageFragment(pkgName);\r", "-\t\t\t\tIPackageFragmentRoot[] roots = getPackageFragmentRootsInClassPath();\r", "-\t\t\t\tfor (int i = 0; i < roots.length; ++i) {\r", "-\t\t\t\t\tIPackageFragmentRoot testRoot = roots[i];\r", "-\t\t\t\t\tif (!testRoot.isArchive()\r", "-\t\t\t\t\t\t&& testRoot.getUnderlyingResource().getFullPath().isPrefixOf(path)) {\r", "-\t\t\t\t\t\troot = testRoot;\r", "-\t\t\t\t\t\tfrag = testRoot.getPackageFragment(pkgName);\r", "+\t\t\t\tIPackageFragmentRoot[] roots= getPackageFragmentRootsInClassPath();\r", "+\t\t\t\tfor (int i= 0; i < roots.length; ++i) {\r", "+\t\t\t\t\tIPackageFragmentRoot testRoot= roots[i];\r", "+\t\t\t\t\tif (!testRoot.isArchive() && testRoot.getUnderlyingResource().getFullPath().isPrefixOf(path)) {\r", "+\t\t\t\t\t\troot= testRoot;\r", "+\t\t\t\t\t\tfrag= testRoot.getPackageFragment(pkgName);\r", "-\t\t\tboolean isArchive = root.isArchive();\r", "+\t\t\tboolean isArchive= root.isArchive();\r", "-\t\t\tif (isArchive\r", "-\t\t\t\t&& root.getUnderlyingResource() != null\r", "-\t\t\t\t&& !root.getUnderlyingResource().isLocal(IResource.DEPTH_ZERO)) {\r", "+\t\t\tif (isArchive && root.getUnderlyingResource() != null && !root.getUnderlyingResource().isLocal(IResource.DEPTH_ZERO)) {\r", "-\t\t\tIPath entryPath = null;\r", "+\t\t\tIPath entryPath= null;\r", "-\t\t\tString zipEntryFileName = null;\r", "+\t\t\tString zipEntryFileName= null;\r", "-\t\t\tICompilationUnit[] units = frag.getCompilationUnits();\r", "-\t\t\tfor (int i = 0; i < units.length; ++i) {\r", "-\t\t\t\tICompilationUnit unit = units[i];\r", "-\t\t\t\tString fileName = unit.getElementName();\r", "-\t\t\t\t/* see if a source entry exists for this file name */\r", "-\t\t\t\tif (entryTable.get(fileName) == null) {\r", "+\t\t\tICompilationUnit[] units= frag.getCompilationUnits();\r", "+\t\t\tfor (int i= 0; i < units.length; ++i) {\r", "+\t\t\t\tICompilationUnit unit= units[i];\r", "+\t\t\t\tString fileName= unit.getElementName();\r", "+\t\t\t\t// get the corresponding .class file name\r", "+\t\t\t\tString classFileName = \"\";\r", "+\t\t\t\tif (Util.isJavaFileName(fileName)) { // paranoia check\r", "+\t\t\t\t\tclassFileName = fileName.substring(0, fileName.length()-5).concat(\".class\");\r", "+\t\t\t\t}\r", "+\t\t\t\t// see if a source entry exists for this file name\r", "+\t\t\t\t// or for the corresponding .class file\r", "+\t\t\t\tif (entryTable.get(fileName) == null && entryTable.get(classFileName) == null) {\r", "-\t\t\t\t\t\tentryPath = path;\r", "+\t\t\t\t\t\tentryPath= path;\r", "-\t\t\t\t\t\tzipEntryFileName = fileName;\r", "+\t\t\t\t\t\tzipEntryFileName= fileName;\r", "-\t\t\t\t\t\tentryPath = unit.getUnderlyingResource().getFullPath();\r", "+\t\t\t\t\t\tentryPath= unit.getUnderlyingResource().getFullPath();\r", "-\t\t\t\t\t\tzipEntryFileName = null;\r", "+\t\t\t\t\t\tzipEntryFileName= null;\r", "-\t\t\t\t\tSourceEntry sEntry = new SourceEntry(entryPath, zipEntryPath, zipEntryFileName);\r", "+\t\t\t\t\tSourceEntry sEntry= new SourceEntry(entryPath, zipEntryPath, zipEntryFileName);\r", "-\t\t\tIClassFile[] classFiles = frag.getClassFiles();\r", "-\t\t\tfor (int i = 0; i < classFiles.length; ++i) {\r", "-\t\t\t\tIClassFile classFile = classFiles[i];\r", "-\t\t\t\tString fileName = classFile.getElementName();\r", "-\t\t\t\t/* see if a source entry exists for this file name */\r", "-\t\t\t\tif (entryTable.get(fileName) == null) {\r", "+\t\t\tIClassFile[] classFiles= frag.getClassFiles();\r", "+\t\t\tfor (int i= 0; i < classFiles.length; ++i) {\r", "+\t\t\t\tIClassFile classFile= classFiles[i];\r", "+\t\t\t\tString fileName= classFile.getElementName();\r", "+\t\t\t\t// get the corresponding .java file name\r", "+\t\t\t\t// note: this handles nested types, but not secondary types (e.g. class B defined in A.java)\r", "+\t\t\t\tString javaFileName = \"\";\r", "+\t\t\t\tif (Util.isClassFileName(fileName)) { // paranoia check\r", "+\t\t\t\t\t// strip off any nested types\r", "+\t\t\t\t\tjavaFileName = fileName.substring(0, fileName.length()-6);\r", "+\t\t\t\t\tint dol = javaFileName.indexOf('$');\r", "+\t\t\t\t\tif (dol != -1) {\r", "+\t\t\t\t\t\tjavaFileName = javaFileName.substring(0, dol);\r", "+\t\t\t\t\t}\r", "+\t\t\t\t\tjavaFileName = javaFileName.concat(\".java\");\r", "+\t\t\t\t}\r", "+\t\t\t\t// see if a source entry exists for this file name\r", "+\t\t\t\t// or for the corresponding .java file\r", "+\t\t\t\tif (entryTable.get(fileName) == null && entryTable.get(javaFileName) == null) {\r", "-\t\t\t\t\t\tentryPath = path;\r", "+\t\t\t\t\t\tentryPath= path;\r", "-\t\t\t\t\t\tzipEntryFileName = fileName;\r", "+\t\t\t\t\t\tzipEntryFileName= fileName;\r", "-\t\t\t\t\t\tentryPath = classFile.getUnderlyingResource().getFullPath();\r", "+\t\t\t\t\t\tentryPath= classFile.getUnderlyingResource().getFullPath();\r", "-\t\t\t\t\t\tzipEntryFileName = null;\r", "+\t\t\t\t\t\tzipEntryFileName= null;\r", "-\t\t\t\t\tSourceEntry sEntry = new SourceEntry(entryPath, zipEntryPath, zipEntryFileName);\r", "+\t\t\t\t\tSourceEntry sEntry= new SourceEntry(entryPath, zipEntryPath, zipEntryFileName);\r"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "20497a6310529b88ac3494fce15bc935", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/model/org/eclipse/jdt/internal/core/NamedMember.java", "commitBeforeChange": "87035e28d15718dec923cda9730195aba7b8ab31", "commitAfterChange": "d7e74f0817baa712407da5eb003f21f0a3eeda6d", "methodNumberBeforeChange": 5, "methodNumberAfterChange": 5, "signatureBeforeChange": " \t \tprotected String getKey(IType type)", "signatureAfterChange": " \t \tprotected String getKey(IType type)", "diff": ["-\t\t// TODO (jerome) handle secondary types", "-\t\tkey.append(type.getTypeQualifiedName('$'));", "+\t\tString typeQualifiedName = type.getTypeQualifiedName('$');", "+\t\tICompilationUnit cu = (ICompilationUnit) type.getAncestor(IJavaElement.COMPILATION_UNIT);", "+\t\tif (cu != null) {", "+\t\t\tString cuName = cu.getElementName();", "+\t\t\tString mainTypeName = cuName.substring(0, cuName.lastIndexOf('.'));", "+\t\t\tint end = typeQualifiedName.indexOf('$');", "+\t\t\tif (end == -1)", "+\t\t\t\tend = typeQualifiedName.length();", "+\t\t\tString topLevelTypeName = typeQualifiedName.substring(0, end);", "+\t\t\tif (!mainTypeName.equals(topLevelTypeName)) {", "+\t\t\t\tkey.append(mainTypeName);", "+\t\t\t\tkey.append('~');", "+\t\t\t}", "+\t\t}", "+\t\tkey.append(typeQualifiedName);"]}], "num": 29059}