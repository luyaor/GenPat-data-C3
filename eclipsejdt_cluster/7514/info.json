{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "e450b0261eb7e95dbd248030de5828d3", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "23d6c76c2bb02a8a16ca0caee5c98713", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/search/org/eclipse/jdt/internal/core/search/indexing/IndexManager.java", "commitBeforeChange": "9ccc53063dda8b7e1afdde95ae36a8417c582abc", "commitAfterChange": "7143e72571bb2e6a2e74f6791210a97b375b5ab6", "methodNumberBeforeChange": 26, "methodNumberAfterChange": 25, "signatureBeforeChange": " public void saveIndexes()", "signatureAfterChange": " public void saveIndexes()", "diff": ["+\tboolean allSaved = true;", "-\t\tReadWriteMonitor monitor = getMonitorFor(index);", "+\t\tReadWriteMonitor monitor = index.monitor;", "-\t\t\t\tmonitor.exitRead();", "-\t\t\t\tmonitor.enterWrite();", "-\t\t\t\ttry {", "-\t\t\t\t\tsaveIndex(index);", "-\t\t\t\t} catch(IOException e){", "-\t\t\t\t\tif (VERBOSE) {", "-\t\t\t\t\t\tJobManager.verbose(\"-> got the following exception while saving:\"); //$NON-NLS-1$", "-\t\t\t\t\t\te.printStackTrace();", "+\t\t\t\tif (monitor.exitReadEnterWrite()) {", "+\t\t\t\t\ttry {", "+\t\t\t\t\t\tsaveIndex(index);", "+\t\t\t\t\t} catch(IOException e) {", "+\t\t\t\t\t\tif (VERBOSE) {", "+\t\t\t\t\t\t\tJobManager.verbose(\"-> got the following exception while saving:\"); //$NON-NLS-1$", "+\t\t\t\t\t\t\te.printStackTrace();", "+\t\t\t\t\t\t}", "+\t\t\t\t\t\tallSaved = false;", "+\t\t\t\t\t} finally {", "+\t\t\t\t\t\tmonitor.exitWriteEnterRead();", "-\t\t\t\t\t//Util.log(e);", "-\t\t\t\t} finally {", "-\t\t\t\t\tmonitor.exitWriteEnterRead();", "+\t\t\t\t} else {", "+\t\t\t\t\tallSaved = false;", "-\tneedToSave = false;", "+\tthis.needToSave = !allSaved;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "8ed42da0cb2421b79be39e5c9c549c91", "repository": "http://git.eclipse.org/gitroot/jdt/eclipse.jdt.core.git", "fileName": "org.eclipse.jdt.core/search/org/eclipse/jdt/internal/core/search/indexing/IndexManager.java", "commitBeforeChange": "844fc4d356fef36a29f4fe3bf00f7a74989bafaf", "commitAfterChange": "234e90f1063594cbfe450e6804c5db0a515eda2c", "methodNumberBeforeChange": 26, "methodNumberAfterChange": 26, "signatureBeforeChange": " public void saveIndexes()", "signatureAfterChange": " public void saveIndexes()", "diff": ["-\t\t\tmonitor.enterWrite();", "-\t\t\ttry {", "-\t\t\t\tsaveIndex(index);", "-\t\t\t} catch(IOException e){", "-\t\t\t\tif (VERBOSE) {", "-\t\t\t\t\tJobManager.verbose(\"-> got the following exception while saving:\"); //$NON-NLS-1$", "-\t\t\t\t\te.printStackTrace();", "+\t\t\t// take read lock before checking if index has changed", "+\t\t\t// don't take write lock yet since it can cause a deadlock (see https://bugs.eclipse.org/bugs/show_bug.cgi?id=50571)", "+\t\t\tmonitor.enterRead(); ", "+\t\t\tif (index.hasChanged()) {", "+\t\t\t\tmonitor.exitRead();", "+\t\t\t\tmonitor.enterWrite();", "+\t\t\t\ttry {", "+\t\t\t\t\tsaveIndex(index);", "+\t\t\t\t} catch(IOException e){", "+\t\t\t\t\tif (VERBOSE) {", "+\t\t\t\t\t\tJobManager.verbose(\"-> got the following exception while saving:\"); //$NON-NLS-1$", "+\t\t\t\t\t\te.printStackTrace();", "+\t\t\t\t\t}", "+\t\t\t\t\t//Util.log(e);", "+\t\t\t\t} finally {", "+\t\t\t\t\tmonitor.exitWriteEnterRead();", "-\t\t\t\t//Util.log(e);", "-\t\t\tmonitor.exitWrite();", "+\t\t\tmonitor.exitRead();"]}], "num": 7514}