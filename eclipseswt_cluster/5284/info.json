{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "883276fa75c4f694ddbbd156167fecef", "detectedBy": ["DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "9f239e77d85774a03bcc97e907ac4655", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Drag and Drop/photon/org/eclipse/swt/dnd/Clipboard.java", "commitBeforeChange": "da5b2096f70170c1ee5967072f15746afe644075", "commitAfterChange": "e1a1a9a2764b9fd42d3fd4db27d8d960a32582f7", "methodNumberBeforeChange": 3, "methodNumberAfterChange": 3, "signatureBeforeChange": "\r public Object getContents(Transfer transfer)", "signatureAfterChange": "\r public Object getContents(Transfer transfer)", "diff": ["-\treturn null;\r", "+\t\r", "+\tObject result = null;\r", "+\t\r", "+\tint ig = OS.PhInputGroup(0);\r", "+\tint cbdata = OS.PhClipboardPasteStart((short)ig);\r", "+\tif (cbdata == 0) return result;\r", "+\ttry {\r", "+\t\tString[] types = transfer.getTypeNames();\r", "+\t\tint[] ids = transfer.getTypeIds();\r", "+\t\tfor (int i = 0; i < types.length; i++) {\r", "+\t\t\tbyte[] type = Converter.wcsToMbcs(null, types[i], true);\r", "+\t\t\tint pClipHeader = OS.PhClipboardPasteType(cbdata, type);\r", "+\t\t\tif (pClipHeader != 0) {\r", "+\t\t\t\tPhClipHeader clipHeader = new PhClipHeader();\r", "+\t\t\t\tOS.memmove(clipHeader, pClipHeader, PhClipHeader.sizeof);\r", "+\t\t\t\tTransferData data = new TransferData();\r", "+\t\t\t\tdata.pData = clipHeader.data;\r", "+\t\t\t\tdata.length = clipHeader.length;\r", "+\t\t\t\tdata.type = ids[i];\r", "+\t\t\t\tresult = transfer.nativeToJava(data);\r", "+\t\t\t\tbreak;\r", "+\t\t\t}\r", "+\t\t}\r", "+\t} finally {\r", "+\t\tOS.PhClipboardPasteFinish(cbdata);\r", "+\t}\r", "+\t\r", "+\treturn result;\r"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "8c9889a6241b60ab79162e1c035193c7", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Drag and Drop/carbon/org/eclipse/swt/dnd/Clipboard.java", "commitBeforeChange": "89dd18f56416766e9f25e99fa93a3cfdf736ff7e", "commitAfterChange": "0333c3cd6e1227d0185cdb60c13b053083d72b21", "methodNumberBeforeChange": 3, "methodNumberAfterChange": 3, "signatureBeforeChange": " public Object getContents(Transfer transfer)", "signatureAfterChange": " public Object getContents(Transfer transfer)", "diff": ["-\t\t", "-\tint[] scrapHandle = new int[1];", "-\tOS.GetCurrentScrap(scrapHandle);", "-\tint scrap= scrapHandle[0];", "-\t\t", "-\t// Does Clipboard have data in required format?", "+\t", "+\tint[] scrap = new int[1];", "+\tif (OS.GetCurrentScrap(scrap) != OS.noErr) return null;", "-\tfor (int i= 0; i < typeIds.length; i++) {", "+\tint[] size = new int[1];\t", "+\t// get data from system clipboard", "+\tfor (int i=0; i<typeIds.length; i++) {", "-\t\tint[] size = new int[1];", "-\t\tif (OS.GetScrapFlavorSize(scrap, type, size) == OS.noErr) {", "-\t\t\tif (size[0] > 0) {", "+\t\tsize[0] = 0;", "+\t\tif (OS.GetScrapFlavorSize(scrap[0], type, size) == OS.noErr && size[0] > 0) {", "+\t\t\tbyte[] buffer = new byte[size[0]];", "+\t\t\tif (OS.GetScrapFlavorData(scrap[0], type, size, buffer) == OS.noErr) {", "-\t\t\t\ttdata.data = new byte[size[0]];", "-\t\t\t\tOS.GetScrapFlavorData(scrap, type, size, tdata.data);", "+\t\t\t\ttdata.data = new byte[1][];", "+\t\t\t\ttdata.data[0] = buffer;", "-\t}\t\t", "+\t}"]}], "num": 5284}