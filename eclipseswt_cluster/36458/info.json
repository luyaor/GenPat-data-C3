{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "3af59b33446649c15b3408f10968a958", "detectedBy": ["DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "6bea62d3e1483d493e6200838b334f95", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt.tools/JNI Generation/org/eclipse/swt/tools/internal/NativesGenerator.java", "commitBeforeChange": "e15501b63efe62490f7c3896fd80c014a6396408", "commitAfterChange": "f8210784d009eb3c65e7938f5f5aff02273c198f", "methodNumberBeforeChange": 19, "methodNumberAfterChange": 19, "signatureBeforeChange": "  void generateFunctionCall(JNIMethod method, JNIParameter[] params, JNIType returnType, JNIType returnType64, boolean needsReturn)", "signatureAfterChange": "  void generateFunctionCall(JNIMethod method, JNIParameter[] params, JNIType returnType, JNIType returnType64, boolean needsReturn)", "diff": ["-\tboolean objc_struct = false;", "-\tif (name.equals(\"objc_msgSend_stret\")) {", "-\t\tobjc_struct = true;", "-\t\toutputln(\"\\tif (sizeof(_arg0) > STRUCT_SIZE_LIMIT) {\");", "-\t\toutput(\"\\t\");", "-\t}", "-\tif (name.equalsIgnoreCase(\"call\")) {", "+", "+\tboolean objc_struct = false;", "+\tif (name.equals(\"objc_msgSend_stret\") || name.equals(\"objc_msgSendSuper_stret\")) objc_struct = true;", "+\tif (objc_struct) {", "+\t\toutputln(\"if (sizeof(_arg0) > STRUCT_SIZE_LIMIT) {\");", "+\t\tgenerate_objc_msgSend_stret (method, params, name);", "+\t\tparamStart = 1;", "+\t} else if (name.equalsIgnoreCase(\"call\")) {", "-\t\toutput(\"\\t\\t*lparg0 = (*(\");", "-\t\tJNIType paramType = params[0].getType(), paramType64 = params[0].getType64();", "-\t\toutput(paramType.getTypeSignature4(!paramType.equals(paramType64), true));", "-\t\toutput(\" (*)(\");", "-\t\tfor (int i = 1; i < params.length; i++) {", "-\t\t\tif (i != 1) output(\", \");", "-\t\t\tJNIParameter param = params[i];", "-\t\t\tString cast = param.getCast();", "-\t\t\tif (cast != null && cast.length() != 0) {", "-\t\t\t\tif (cast.startsWith(\"(\")) cast = cast.substring(1);", "-\t\t\t\tif (cast.endsWith(\")\")) cast = cast.substring(0, cast.length() - 1);", "-\t\t\t\toutput(cast);", "-\t\t\t} else {", "-\t\t\t\tparamType = param.getType(); paramType64 = param.getType64();", "-\t\t\t\toutput(paramType.getTypeSignature4(!paramType.equals(paramType64), param.getFlag(FLAG_STRUCT)));", "-\t\t\t}", "-\t\t}", "-\t\toutput(\"))objc_msgSend)\");", "+\t\tgenerate_objc_msgSend_stret (method, params, name.substring(0, name.length() - \"_stret\".length()));"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "92913a2c4fc9b31317f0c5553b40983e", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt.tools/JNI Generation/org/eclipse/swt/tools/internal/NativesGenerator.java", "commitBeforeChange": "798d905d31bfd777414fc291b597dc7a3f0e8625", "commitAfterChange": "d47a87e5c2fa59d11f5a84db475e651bf99b1cb3", "methodNumberBeforeChange": 20, "methodNumberAfterChange": 20, "signatureBeforeChange": "  void generateFunctionCall(Method method, MethodData methodData, Class[] paramTypes, Class returnType, boolean needsReturn)", "signatureAfterChange": "  void generateFunctionCall(Method method, MethodData methodData, Class[] paramTypes, Class returnType, boolean needsReturn)", "diff": ["+\tString name = method.getName();", "+\tboolean objc_struct = false;", "+\tif (name.equals(\"objc_msgSend_stret\")) {", "+\t\tobjc_struct = true;", "+\t\toutputln(\"\\tif (sizeof(_arg0) > STRUCT_SIZE_LIMIT) {\");", "+\t\toutput(\"\\t\");", "+\t}", "-\tString name = method.getName();", "+\tif (objc_struct) {", "+\t\toutputln(\"\\t} else {\");", "+\t\toutput(\"\\t\\t*lparg0 = (*(\");", "+\t\toutput(getTypeSignature4(paramTypes[0], true));", "+\t\toutput(\" (*)(\");", "+\t\tfor (int i = 1; i < paramTypes.length; i++) {", "+\t\t\tif (i != 1) output(\", \");", "+\t\t\tClass paramType = paramTypes[i];", "+\t\t\tParameterData paramData = getMetaData().getMetaData(method, i);", "+\t\t\tString cast = paramData.getCast();", "+\t\t\tif (cast != null && cast.length() != 0) {", "+\t\t\t\tif (cast.startsWith(\"(\")) cast = cast.substring(1);", "+\t\t\t\tif (cast.endsWith(\")\")) cast = cast.substring(0, cast.length() - 1);", "+\t\t\t\toutput(cast);", "+\t\t\t} else {", "+\t\t\t\toutput(getTypeSignature4(paramType, paramData.getFlag(FLAG_STRUCT)));", "+\t\t\t}", "+\t\t}", "+\t\toutput(\"))objc_msgSend)\");", "+\t\tgenerateFunctionCallRightSide(method, methodData, paramTypes, 1);", "+\t\toutputln(\";\");", "+\t\toutputln(\"\\t}\");", "+\t}"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "0c6a8c622101f2a4fed22cfb4cab8774", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt.tools/JNI Generation/org/eclipse/swt/tools/internal/NativesGenerator.java", "commitBeforeChange": "753c5d50ce83930c33a89811ce7eadb7faec18f9", "commitAfterChange": "4bcd9e15f1b441014f9ab446e0c5a9a0b39e8f7f", "methodNumberBeforeChange": 17, "methodNumberAfterChange": 17, "signatureBeforeChange": "  void generateDynamicFunctionCall(Method method, MethodData methodData, Class[] paramTypes, Class returnType, boolean needsReturn)", "signatureAfterChange": "  void generateDynamicFunctionCall(Method method, MethodData methodData, Class[] paramTypes, Class returnType, boolean needsReturn)", "diff": ["+\t} else if (getPlatform().equals(\"carbon\")) {", "+\t\toutputln(\"\\t\\tstatic int initialized = 0;\");", "+\t\toutputln(\"\\t\\tstatic CFBundleRef bundle = NULL;\");", "+\t\toutput(\"\\t\\ttypedef \");", "+\t\toutput(getTypeSignature2(returnType));", "+\t\toutput(\" (*FPTR)(\");", "+\t\tfor (int i = 0; i < paramTypes.length; i++) {", "+\t\t\tif (i != 0) output(\", \");", "+\t\t\tClass paramType = paramTypes[i];", "+\t\t\tParameterData paramData = getMetaData().getMetaData(method, i);", "+\t\t\tString cast = paramData.getCast();", "+\t\t\tif (cast.length() > 2) {", "+\t\t\t\toutput(cast.substring(1, cast.length() - 1));", "+\t\t\t} else {", "+\t\t\t\toutput(getTypeSignature4(paramType));", "+\t\t\t}", "+\t\t}", "+\t\toutputln(\");\");", "+\t\toutputln(\"\\t\\tstatic FPTR fptr;\");", "+\t\tif (returnType != Void.TYPE) {", "+\t\t\tif (needsReturn) {", "+\t\t\t\toutputln(\"\\t\\trc = 0;\");", "+\t\t\t}", "+\t\t}", "+\t\toutputln(\"\\t\\tif (!initialized) {\");", "+\t\toutput(\"\\t\\t\\tif (!bundle) bundle = CFBundleGetBundleWithIdentifier(CFSTR(\");", "+\t\toutput(name);", "+\t\toutputln(\"_LIB));\");", "+\t\toutput(\"\\t\\t\\tif (bundle) fptr = (FPTR)CFBundleGetFunctionPointerForName(bundle, CFSTR(\\\"\");", "+\t\toutput(name);", "+\t\toutputln(\"\\\"));\");", "+\t\toutputln(\"\\t\\t\\tinitialized = 1;\");", "+\t\toutputln(\"\\t\\t}\");", "+\t\toutputln(\"\\t\\tif (fptr) {\");", "+\t\toutput(\"\\t\\t\");", "+\t\tgenerateFunctionCallLeftSide(method, methodData, returnType, needsReturn);", "+\t\toutput(\"(*fptr)\");", "+\t\tgenerateFunctionCallRightSide(method, methodData, paramTypes, 0);", "+\t\toutputln();", "+\t\toutputln(\"\\t\\t}\");"]}], "num": 36458}