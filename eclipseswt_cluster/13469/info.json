{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "85fffdff8aff3ceec8f4d2074a7aa465", "detectedBy": ["AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "280b23a7aee3f15b27e41b0c39325a3a", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Program/cocoa/org/eclipse/swt/program/Program.java", "commitBeforeChange": "7252c074be7d5fd8626b7fe92856d52e0eef4b48", "commitAfterChange": "02a2fd1ba0eecd76c8bdd51daf981f19dc23cc43", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": " public static Program findProgram (String extension)", "signatureAfterChange": " public static Program findProgram (String extension)", "diff": ["-\t\tworkspace.getInfoForFile(fullPath, appName, type);", "+\t\tif (!workspace.getInfoForFile(fullPath, appName, type)) return null;", "+\t\tint /*long*/ [] buffer2 = new int /*long*/[1];", "+\t\tOS.memmove(buffer2, type, C.PTR_SIZEOF);", "+\t\t\tNSString appType = new NSString(buffer2[0]);", "-\t\t\tif (bundle != null) return getProgram(bundle);", "+\t\t\tif (bundle != null) {", "+\t\t\t\tNSString textEditId = NSString.stringWith(\"com.apple.TextEdit\");", "+\t\t\t\tNSString bundleId = NSString.stringWith(\"CFBundleIdentifier\");", "+\t\t\t\tNSDictionary infoDictionary = bundle.infoDictionary();", "+\t\t\t\tboolean textEdit = textEditId.isEqual(infoDictionary.objectForKey(bundleId));", "+\t\t\t\tif (!textEdit) return getProgram(bundle);", "+\t\t\t\t// if text edit, make sure we're really one of the extensions that", "+\t\t\t\t// text edit says it can handle.", "+\t\t\t\tNSString CFBundleDocumentTypes = NSString.stringWith(\"CFBundleDocumentTypes\");", "+\t\t\t\tNSString CFBundleTypeExtensions = NSString.stringWith(\"CFBundleTypeExtensions\");", "+\t\t\t\tid id = infoDictionary.objectForKey(CFBundleDocumentTypes);", "+\t\t\t\tif (id != null) {", "+\t\t\t\t\tNSDictionary documentTypes = new NSDictionary(id.id);", "+\t\t\t\t\tNSEnumerator documentTypesEnumerator = documentTypes.objectEnumerator();", "+\t\t\t\t\twhile ((id = documentTypesEnumerator.nextObject()) != null) {", "+\t\t\t\t\t\tNSDictionary documentType = new NSDictionary(id.id);", "+\t\t\t\t\t\tNSDictionary supportedExtensions = new NSDictionary(documentType.objectForKey(CFBundleTypeExtensions));", "+\t\t\t\t\t\tif (supportedExtensions != null) {", "+\t\t\t\t\t\t\tNSEnumerator supportedExtensionsEnumerator = supportedExtensions.objectEnumerator();", "+\t\t\t\t\t\t\tif (supportedExtensionsEnumerator != null) {", "+\t\t\t\t\t\t\t\tid ext = null;", "+\t\t\t\t\t\t\t\twhile((ext = supportedExtensionsEnumerator.nextObject()) != null) {", "+\t\t\t\t\t\t\t\t\tNSString strExt = new NSString(ext);", "+\t\t\t\t\t\t\t\t\tif (appType.isEqual(strExt)) return getProgram (bundle);", "+\t\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t}", "+\t\t\t\t\t}", "+\t\t\t\t}", "+\t\t\t}"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "f40ebb90df7f834915dcf102de93fa6a", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Program/cocoa/org/eclipse/swt/program/Program.java", "commitBeforeChange": "18a77004921c958d7933e6a4bf2f9879ef0cfdc3", "commitAfterChange": "235449f60e73b051bff45b523d24758455cf4aa9", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": " public static Program findProgram (String extension)", "signatureAfterChange": " public static Program findProgram (String extension)", "diff": ["-//\tchar[] chars;", "-//\tif (extension.charAt (0) != '.') {", "-//\t\tchars = new char[extension.length()];", "-//\t\textension.getChars(0, chars.length, chars, 0);", "-//\t} else {", "-//\t\tchars = new char[extension.length() - 1];", "-//\t\textension.getChars(1, extension.length(), chars, 0);\t\t", "-//\t}", "-//\tint ext = OS.CFStringCreateWithCharacters(OS.kCFAllocatorDefault, chars, chars.length);", "-//\tProgram program = null;", "-//\tif (ext != 0) {", "-//\t\tbyte[] fsRef = new byte[80];", "-//\t\tif (OS.LSGetApplicationForInfo(OS.kLSUnknownType, OS.kLSUnknownCreator, ext, OS.kLSRolesAll, fsRef, null) == OS.noErr) {", "-//\t\t\tprogram = getProgram(fsRef);", "-//\t\t}", "-//\t\tOS.CFRelease(ext);", "-//\t}", "-//\treturn program;", "+\tif (extension.charAt(0) != '.') extension = \".\" + extension;", "+\tNSWorkspace workspace = NSWorkspace.sharedWorkspace();", "+\tint /*long*/ appName = OS.malloc(C.PTR_SIZEOF);", "+\tint /*long*/ type = OS.malloc(C.PTR_SIZEOF);", "+\tNSString temp = new NSString(OS.NSTemporaryDirectory());", "+\tNSString fileName = NSString.stringWith(\"swt\" + System.currentTimeMillis() + extension);", "+\tNSString fullPath = temp.stringByAppendingPathComponent(fileName);", "+\tNSFileManager fileManager = NSFileManager.defaultManager();", "+\tfileManager.createFileAtPath(fullPath, null, null);", "+\tworkspace.getInfoForFile(fullPath, appName, type);", "+\tfileManager.removeItemAtPath(fullPath, 0);", "+\tint /*long*/ [] buffer = new int /*long*/[1];", "+\tOS.memmove(buffer, appName, C.PTR_SIZEOF);", "+\tOS.free(appName);", "+\tOS.free(type);", "+\tif (buffer [0] != 0) {", "+\t\tNSString appPath = new NSString(buffer[0]);", "+\t\tNSBundle bundle = NSBundle.bundleWithPath(appPath);", "+\t\tif (bundle != null) {", "+\t\t\tNSString CFBundleName = NSString.stringWith(\"CFBundleName\");", "+\t\t\tNSString CFBundleDisplayName = NSString.stringWith(\"CFBundleDisplayName\");", "+\t\t\tid bundleName = bundle.objectForInfoDictionaryKey(CFBundleDisplayName);", "+\t\t    if (bundleName == null) {", "+\t\t        bundleName = bundle.objectForInfoDictionaryKey(CFBundleName);", "+\t\t    }", "+\t\t    if (bundleName == null) {", "+\t\t        bundleName = appPath.lastPathComponent().stringByDeletingPathExtension();", "+\t\t    }", "+\t\t    NSString name = new NSString(bundleName.id);\t    ", "+\t\t\tProgram program = new Program();", "+\t\t\tprogram.name = name.getString();", "+\t\t\treturn program;", "+\t\t}", "+\t}"]}], "num": 13469}