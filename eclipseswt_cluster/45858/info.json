{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "6dd8c01d4b9f5ae43ecda74a475e86c0", "detectedBy": ["AST_HIERARCHICAL", "AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "f773896fc6cfb8782520e0418aca8bcd", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/win32/org/eclipse/swt/widgets/MenuItem.java", "commitBeforeChange": "3619e05678dc1ff8c0482f066150e6e0bbd77bcf", "commitAfterChange": "443e66e6e7f734ef4a3874238f6ed709ca15a64b", "methodNumberBeforeChange": 35, "methodNumberAfterChange": 34, "signatureBeforeChange": " public void setText (String string)", "signatureAfterChange": " public void setText (String string)", "diff": ["-\t\t/*", "-\t\t* Bug in Windows 2000.  For some reason, when MIIM_TYPE is set", "-\t\t* on a menu item that also has MIIM_BITMAP, the MIIM_TYPE clears", "-\t\t* the MIIM_BITMAP style.  The fix is to reset both MIIM_BITMAP.", "-\t\t* Note, this does not happen on Windows 98.", "-\t\t*/", "-\t\tboolean restoreBitmap = false;", "-\t\tif (!OS.IsWinCE && OS.WIN32_VERSION >= OS.VERSION (4, 10)) {", "-\t\t\tinfo.fMask = OS.MIIM_BITMAP;", "-\t\t\tOS.GetMenuItemInfo (hMenu, id, false, info);", "-\t\t\trestoreBitmap = info.hbmpItem != 0 || parent.foreground != -1;", "-\t\t}", "-\t\t", "-\t\tinfo.fMask = OS.MIIM_TYPE;", "-\t\tinfo.fType = widgetStyle ();", "-\t\tinfo.dwTypeData = pszText;", "-\t\tsuccess = OS.SetMenuItemInfo (hMenu, id, false, info);", "-", "-\t\t* Restore the bitmap that was removed to work around a problem", "-\t\t* in GetMenuItemInfo() and menu items that have bitmaps set with", "-\t\t* MIIM_BITMAP.", "+\t\t* Bug in Windows 2000.  For some reason, when MIIM_TYPE is set", "+\t\t* on a menu item that also has MIIM_BITMAP, the MIIM_TYPE clears", "+\t\t* the MIIM_BITMAP style.  The fix is to use MIIM_STRING.", "-\t\t\tif (restoreBitmap) {", "-\t\t\t\tinfo.fMask = OS.MIIM_BITMAP;", "-\t\t\t\tif (parent.foreground != -1) {", "-\t\t\t\t\tinfo.hbmpItem = OS.HBMMENU_CALLBACK;", "-\t\t\t\t} else {", "-\t\t\t\t\tif (!OS.IsWinCE && OS.WIN32_VERSION >= OS.VERSION (6, 0)) {", "-\t\t\t\t\t\tinfo.hbmpItem = hBitmap;", "-\t\t\t\t\t} else {", "-\t\t\t\t\t\tinfo.hbmpItem = OS.HBMMENU_CALLBACK;", "-\t\t\t\t\t}", "-\t\t\t\t}", "-\t\t\t\tsuccess = OS.SetMenuItemInfo (hMenu, id, false, info);", "-\t\t\t}", "+\t\t\tinfo.fMask = OS.MIIM_STRING;", "+\t\t} else {", "+\t\t\tinfo.fMask = OS.MIIM_TYPE;", "+\t\t\tinfo.fType = widgetStyle ();", "+\t\tinfo.dwTypeData = pszText;", "+\t\tsuccess = OS.SetMenuItemInfo (hMenu, id, false, info);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "99e58c826c4175373583b6abc49c6a96", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/win32/org/eclipse/swt/widgets/MenuItem.java", "commitBeforeChange": "3619e05678dc1ff8c0482f066150e6e0bbd77bcf", "commitAfterChange": "443e66e6e7f734ef4a3874238f6ed709ca15a64b", "methodNumberBeforeChange": 32, "methodNumberAfterChange": 31, "signatureBeforeChange": "  void setMenu (Menu menu, boolean dispose)", "signatureAfterChange": "  void setMenu (Menu menu, boolean dispose)", "diff": ["-\t\t/*", "-\t\t* Feature in Windows.  When SetMenuItemInfo () is used to", "-\t\t* set a submenu and the menu item already has a submenu,", "-\t\t* Windows destroys the previous menu.  This is undocumented", "-\t\t* and unexpected but not necessarily wrong.  The fix is to", "-\t\t* remove the item with RemoveMenu () which does not destroy", "-\t\t* the submenu and then insert the item with InsertMenuItem ().", "-\t\t*/", "-\t\tboolean restoreBitmap = false, success = false;", "-\t\t", "+\t\tint cch = 128;", "+\t\tint /*long*/ hHeap = OS.GetProcessHeap ();", "+\t\tint byteCount = cch * TCHAR.sizeof;", "+\t\tint /*long*/ pszText = OS.HeapAlloc (hHeap, OS.HEAP_ZERO_MEMORY, byteCount);", "+\t\tinfo.fMask = OS.MIIM_STATE | OS.MIIM_ID | OS.MIIM_DATA;", "-\t\t* The fix is to temporarily remove the bitmap and restore it after", "-\t\t* the text and submenu have been set.", "+\t\t* The fix is use MIIM_BITMAP and MIIM_STRING.", "-\t\t\tinfo.fMask = OS.MIIM_BITMAP;", "-\t\t\tOS.GetMenuItemInfo (hMenu, index, true, info);", "-\t\t\trestoreBitmap = info.hbmpItem != 0 || parent.foreground != -1;", "-\t\t\tif (restoreBitmap) {", "-\t\t\t\tinfo.hbmpItem = 0;", "-\t\t\t\tsuccess = OS.SetMenuItemInfo (hMenu, id, false, info);", "-\t\t\t}", "+\t\t\tinfo.fMask |= OS.MIIM_BITMAP | OS.MIIM_STRING;", "+\t\t} else {", "+\t\t\tinfo.fMask |= OS.MIIM_TYPE;", "-\t\t", "-\t\tint cch = 128;", "-\t\tint /*long*/ hHeap = OS.GetProcessHeap ();", "-\t\tint byteCount = cch * TCHAR.sizeof;", "-\t\tint /*long*/ pszText = OS.HeapAlloc (hHeap, OS.HEAP_ZERO_MEMORY, byteCount);", "-\t\tinfo.fMask = OS.MIIM_STATE | OS.MIIM_ID | OS.MIIM_TYPE | OS.MIIM_DATA;", "-\t\tsuccess = OS.GetMenuItemInfo (hMenu, index, true, info);", "+\t\tboolean success = OS.GetMenuItemInfo (hMenu, index, true, info);", "+\t\t\t\t/*", "+\t\t\t\t* Feature in Windows.  When SetMenuItemInfo () is used to", "+\t\t\t\t* set a submenu and the menu item already has a submenu,", "+\t\t\t\t* Windows destroys the previous menu.  This is undocumented", "+\t\t\t\t* and unexpected but not necessarily wrong.  The fix is to", "+\t\t\t\t* remove the item with RemoveMenu () which does not destroy", "+\t\t\t\t* the submenu and then insert the item with InsertMenuItem ().", "+\t\t\t\t*/", "-\t\t\t}", "-\t\t\t/*", "-\t\t\t* Restore the bitmap that was removed to work around a problem", "-\t\t\t* in GetMenuItemInfo() and menu items that have bitmaps set with", "-\t\t\t* MIIM_BITMAP.", "-\t\t\t*/", "-\t\t\tif (OS.WIN32_VERSION >= OS.VERSION (4, 10)) {", "-\t\t\t\tif (restoreBitmap) {", "-\t\t\t\t\tinfo.fMask = OS.MIIM_BITMAP;", "-\t\t\t\t\tif (parent.foreground != -1) {", "-\t\t\t\t\t\tinfo.hbmpItem = OS.HBMMENU_CALLBACK;", "-\t\t\t\t\t} else {", "-\t\t\t\t\t\tif (!OS.IsWinCE && OS.WIN32_VERSION >= OS.VERSION (6, 0)) {", "-\t\t\t\t\t\t\tinfo.hbmpItem = hBitmap;", "-\t\t\t\t\t\t} else {", "-\t\t\t\t\t\t\tinfo.hbmpItem = OS.HBMMENU_CALLBACK;", "-\t\t\t\t\t\t}", "-\t\t\t\t\t}", "-\t\t\t\t\tsuccess = OS.SetMenuItemInfo (hMenu, id, false, info);", "-\t\t\t\t}"]}], "num": 45858}