{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "a983203d735fd301273c1547d3ff2c7d", "detectedBy": ["DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "ca6bbfb2674525fd1758ef9ced4f02f8", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/carbon/org/eclipse/swt/graphics/GC.java", "commitBeforeChange": "690c4a8c2a13525287177e0c1fa0a4966fed59bd", "commitAfterChange": "45c17a900337f4050992d636939c2338936e1499", "methodNumberBeforeChange": 58, "methodNumberAfterChange": 58, "signatureBeforeChange": " public Point stringExtent(String string)", "signatureAfterChange": " public Point stringExtent(String string)", "diff": ["-\tif (data.layout == 0) createLayout ();", "-\tif (string != data.string) {", "-\t\tif (data.stringPtr != 0) OS.DisposePtr(data.stringPtr);", "-\t\tFont font = data.font;", "-\t\tint atsuiStyle = font.atsuiStyle != 0 ? font.atsuiStyle : data.atsuiStyle;", "-\t\tint ptr = OS.NewPtr(length * 2);", "-\t\tOS.memcpy(ptr, string, length * 2);", "-\t\tOS.ATSUSetTextPointerLocation(data.layout, ptr, 0, length, length);", "-\t\tOS.ATSUSetRunStyle(data.layout, atsuiStyle, 0, length);", "-\t\tdata.string = string;", "-\t\tdata.stringPtr = ptr;", "-\t}\t", "-\tATSTrapezoid trapezoid = new ATSTrapezoid();", "-\tOS.ATSUGetGlyphBounds(data.layout, 0, 0, 0, length, (short)OS.kATSUseDeviceOrigins, 1, trapezoid, null);", "-\tint width = OS.Fix2Long(trapezoid.upperRight_x) - OS.Fix2Long(trapezoid.upperLeft_x);", "-\tint height = OS.Fix2Long(trapezoid.lowerRight_y) - OS.Fix2Long(trapezoid.upperRight_y);", "-\treturn new Point(width, height);", "+\tif (Font.USE_ATSUI) {", "+\t\tif (data.layout == 0) createLayout ();", "+\t\tif (string != data.string) {", "+\t\t\tif (data.stringPtr != 0) OS.DisposePtr(data.stringPtr);", "+\t\t\tFont font = data.font;", "+\t\t\tint atsuiStyle = font.atsuiStyle != 0 ? font.atsuiStyle : data.atsuiStyle;", "+\t\t\tint ptr = OS.NewPtr(length * 2);", "+\t\t\tOS.memcpy(ptr, string, length * 2);", "+\t\t\tOS.ATSUSetTextPointerLocation(data.layout, ptr, 0, length, length);", "+\t\t\tOS.ATSUSetRunStyle(data.layout, atsuiStyle, 0, length);", "+\t\t\tdata.string = string;", "+\t\t\tdata.stringPtr = ptr;", "+\t\t}\t", "+\t\tATSTrapezoid trapezoid = new ATSTrapezoid();", "+\t\tOS.ATSUGetGlyphBounds(data.layout, 0, 0, 0, length, (short)OS.kATSUseDeviceOrigins, 1, trapezoid, null);", "+\t\tint width = OS.Fix2Long(trapezoid.upperRight_x) - OS.Fix2Long(trapezoid.upperLeft_x);", "+\t\tint height = OS.Fix2Long(trapezoid.lowerRight_y) - OS.Fix2Long(trapezoid.upperRight_y);", "+\t\treturn new Point(width, height);", "+\t} else {", "+\t\tOS.CGContextSetTextDrawingMode(handle, OS.kCGTextInvisible);", "+\t\tOS.CGContextSetTextPosition(handle, 0, 0);", "+\t\tbyte[] buffer = string.getBytes();", "+\t\tOS.CGContextShowText(handle, buffer, buffer.length);", "+\t\tCGPoint pt = new CGPoint();", "+\t\tOS.CGContextGetTextPosition(handle, pt);", "+\t\treturn new Point((int)pt.x, data.fontAscent + data.fontDescent);", "+\t}"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "4442555fec702ff8d8ddba75246f1966", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/carbon/org/eclipse/swt/graphics/GC.java", "commitBeforeChange": "690c4a8c2a13525287177e0c1fa0a4966fed59bd", "commitAfterChange": "45c17a900337f4050992d636939c2338936e1499", "methodNumberBeforeChange": 20, "methodNumberAfterChange": 20, "signatureBeforeChange": " public void drawString(String string, int x, int y, boolean isTransparent)", "signatureAfterChange": " public void drawString(String string, int x, int y, boolean isTransparent)", "diff": ["-\tif (data.layout == 0) createLayout ();", "-\tif (string != data.string) {", "-\t\tif (data.stringPtr != 0) OS.DisposePtr(data.stringPtr);", "-\t\tFont font = data.font;", "-\t\tint atsuiStyle = font.atsuiStyle != 0 ? font.atsuiStyle : data.atsuiStyle;", "-\t\tint ptr = OS.NewPtr(length * 2);", "-\t\tOS.memcpy(ptr, string, length * 2);", "-\t\tOS.ATSUSetTextPointerLocation(data.layout, ptr, 0, length, length);", "-\t\tOS.ATSUSetRunStyle(data.layout, atsuiStyle, 0, length);", "-\t\tdata.string = string;", "-\t\tdata.stringPtr = ptr;", "+\tif (Font.USE_ATSUI) {", "+\t\tif (data.layout == 0) createLayout ();", "+\t\tif (string != data.string) {", "+\t\t\tif (data.stringPtr != 0) OS.DisposePtr(data.stringPtr);", "+\t\t\tFont font = data.font;", "+\t\t\tint atsuiStyle = font.atsuiStyle != 0 ? font.atsuiStyle : data.atsuiStyle;", "+\t\t\tint ptr = OS.NewPtr(length * 2);", "+\t\t\tOS.memcpy(ptr, string, length * 2);", "+\t\t\tOS.ATSUSetTextPointerLocation(data.layout, ptr, 0, length, length);", "+\t\t\tOS.ATSUSetRunStyle(data.layout, atsuiStyle, 0, length);", "+\t\t\tdata.string = string;", "+\t\t\tdata.stringPtr = ptr;", "+\t\t}", "+\t\tOS.ATSUDrawText(data.layout, 0, length, OS.X2Fix(x), OS.X2Fix(-(y + data.fontAscent)));", "+\t} else {", "+\t\tOS.CGContextSetTextDrawingMode(handle, OS.kCGTextFill);", "+\t\tbyte[] buffer = string.getBytes();", "+\t\tOS.CGContextShowTextAtPoint(handle, x, -(y + data.fontAscent), buffer, buffer.length);", "-\tOS.ATSUDrawText(data.layout, 0, length, OS.X2Fix(x), OS.X2Fix(-(y + data.fontAscent)));"]}], "num": 21979}