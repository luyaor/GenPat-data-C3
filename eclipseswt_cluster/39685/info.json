{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "03507728bc852a58d7409cf611bfeb5b", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN", "AST_HIERARCHICAL", "AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "0ae472d09423c2c28f3601f46c00d12d", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Printing/win32/org/eclipse/swt/printing/Printer.java", "commitBeforeChange": "5381f36cd2ee3ebae345f390df5e1c6d63d37a50", "commitAfterChange": "64c41b83f65fe3168ce076e0d9105675dc3826dc", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": "\r static PrinterData getDefaultPrinterData()", "signatureAfterChange": "\r static PrinterData getDefaultPrinterData()", "diff": ["-\tbyte [] deviceName = null;\r", "-\tbyte[] buf = new byte[1024];\r", "-\tint n = OS.GetProfileStringA(appName, keyName, new byte[] {0}, buf, buf.length);\r", "+\tString deviceName = null;\r", "+\tint length = 1024;\r", "+\t/* Use the character encoding for the default locale */\r", "+\tTCHAR buf = new TCHAR(0, length);\r", "+\tTCHAR nullBuf = new TCHAR(0, 1);\r", "+\tint n = OS.GetProfileString(appName, keyName, nullBuf, buf, length);\r", "-\twhile(buf[commaIndex] != ',' && commaIndex < buf.length) commaIndex++;\r", "-\tif (commaIndex < buf.length) {\r", "-\t\tdeviceName = new byte[commaIndex + 1];\r", "-\t\tSystem.arraycopy(buf, 0, deviceName, 0, commaIndex);\r", "+\twhile(buf.tcharAt(commaIndex) != ',' && commaIndex < length) commaIndex++;\r", "+\tif (commaIndex < length) {\r", "+\t\tdeviceName = buf.toString(0, commaIndex);\t\t\r", "-\tString device = new String(deviceName, 0, deviceName.length - 1);\r", "-\tif (OS.GetProfileStringA(profile, deviceName, new byte [] {0}, buf, buf.length) > 0) {\r", "+\tif (OS.GetProfileString(profile, new TCHAR(0, deviceName, true), nullBuf, buf, length) > 0) {\r", "-\t\twhile (buf[commaIndex] != ',' && commaIndex < buf.length) commaIndex++;\r", "-\t\tif (commaIndex < buf.length) {\r", "-\t\t\tbyte[] driverName = new byte[commaIndex + 1];\r", "-\t\t\tSystem.arraycopy(buf, 0, driverName, 0, commaIndex);\r", "-\t\t\tdriver = new String(driverName, 0, driverName.length - 1);\r", "+\t\twhile (buf.tcharAt(commaIndex) != ',' && commaIndex < length) commaIndex++;\r", "+\t\tif (commaIndex < length) {\r", "+\t\t\tdriver = buf.toString(0, commaIndex);\t\r", "-\treturn new PrinterData(driver, device);\r", "+\treturn new PrinterData(driver, deviceName);\r"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "655ab37adad4c2fe05a00952ed45b9c9", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Printing/win32/org/eclipse/swt/printing/Printer.java", "commitBeforeChange": "5381f36cd2ee3ebae345f390df5e1c6d63d37a50", "commitAfterChange": "64c41b83f65fe3168ce076e0d9105675dc3826dc", "methodNumberBeforeChange": 0, "methodNumberAfterChange": 0, "signatureBeforeChange": "\r public static PrinterData[] getPrinterList()", "signatureAfterChange": "\r public static PrinterData[] getPrinterList()", "diff": ["-\tbyte[] buf = new byte[1024];\r", "-\tint n = OS.GetProfileStringA(profile, null, new byte[] {0}, buf, buf.length);\r", "+\tint length = 1024;\r", "+\t/* Use the character encoding for the default locale */\r", "+\tTCHAR buf = new TCHAR(0, length);\r", "+\tTCHAR nullBuf = new TCHAR(0, 1);\r", "+\tint n = OS.GetProfileString(profile, null, nullBuf, buf, length);\r", "-\tbyte[][] deviceNames = new byte[5][];\r", "+\tString[] deviceNames = new String[5];\r", "-\t\tif (buf[i] == 0) {\r", "+\t\tif (buf.tcharAt(i) == 0) {\r", "-\t\t\t\tbyte[][] newNames = new byte[deviceNames.length + 5][];\r", "+\t\t\t\tString[] newNames = new String[deviceNames.length + 5];\r", "-\t\t\tdeviceNames[nameCount] = new byte[i - index + 1];\r", "-\t\t\tSystem.arraycopy(buf, index, deviceNames[nameCount], 0, i - index);\r", "+\t\t\tdeviceNames[nameCount] = buf.toString(index, i - index);\r", "-\t\tString device = new String(deviceNames[p], 0, deviceNames[p].length - 1);\r", "+\t\tString device = deviceNames[p];\r", "-\t\tif (OS.GetProfileStringA(profile, deviceNames[p], new byte [] {0}, buf, buf.length) > 0) {\r", "+\t\tif (OS.GetProfileString(profile, new TCHAR(0, device, true), nullBuf, buf, length) > 0) {\r", "-\t\t\twhile (buf[commaIndex] != ',' && commaIndex < buf.length) commaIndex++;\r", "-\t\t\tif (commaIndex < buf.length) {\r", "-\t\t\t\tbyte[] driverName = new byte[commaIndex + 1];\r", "-\t\t\t\tSystem.arraycopy(buf, 0, driverName, 0, commaIndex);\r", "-\t\t\t\tdriver = new String(driverName, 0, driverName.length - 1);\r", "+\t\t\twhile (buf.tcharAt(commaIndex) != ',' && commaIndex < length) commaIndex++;\r", "+\t\t\tif (commaIndex < length) {\r", "+\t\t\t\tdriver = buf.toString(0, commaIndex);\r"]}], "num": 39685}