{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "79ff1414a44079f0adaa589293ac814a", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN", "AST_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "a3b9e7f986ea95273decd29230ddd706", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Custom Widgets/common/org/eclipse/swt/custom/StyledText.java", "commitBeforeChange": "635a9e5d0a5f495ec272194dbb750eddc745876f", "commitAfterChange": "e83d77b7ddccf5500d06ea30a64ce0d090ac4b10", "methodNumberBeforeChange": 228, "methodNumberAfterChange": 79, "signatureBeforeChange": " int doLineUp()", "signatureAfterChange": " void doLineUp(boolean select)", "diff": ["-int doLineUp() {", "+void doLineUp(boolean select) {", "-\tif (caretLine > 0) {", "-\t\tcaretLine--;", "-\t\tcaretOffset = getOffsetAtMouseLocation(columnX, caretLine);", "+\tboolean paragraphUp = true;", "+\tif (wordWrap) {", "+\t\tTextLayout layout = renderer.getTextLayout(caretLine);", "+\t\tif (layout.getLineCount() > 0) {", "+\t\t\tPoint pos = getCaret().getLocation();", "+\t\t\tpos.x = columnX + horizontalScrollOffset;", "+\t\t\tpos.y -= getLinePixel(caretLine);", "+\t\t\tint offset = layout.getOffset(pos, null);", "+\t\t\tint lineInParagraph = layout.getLineIndex(offset);", "+\t\t\tif (lineInParagraph > 0) {", "+\t\t\t\tint lineOffset = content.getOffsetAtLine(caretLine);", "+\t\t\t\tparagraphUp = false;", "+\t\t\t\tpos.y -= layout.getLineBounds(lineInParagraph).height;", "+\t\t\t\tcaretOffset = lineOffset + layout.getOffset(pos, null);", "+\t\t\t\tadvancing = false;", "+\t\t\t}", "+\t\t}", "+\t\trenderer.disposeTextLayout(layout);", "-\treturn caretLine;", "+\tif (select && caretLine == 0) {", "+\t\tcaretOffset = 0;", "+\t}", "+\tif (paragraphUp && caretLine > 0) {", "+\t\tcaretLine--;", "+\t\tint lineOffset = content.getOffsetAtLine(caretLine);", "+\t\tTextLayout layout = renderer.getTextLayout(caretLine);", "+\t\tint x = columnX + horizontalScrollOffset - leftMargin;", "+\t\tint y = layout.getBounds().height - 1;", "+\t\tcaretOffset = lineOffset + layout.getOffset(x, y, null);", "+\t\tadvancing = false;", "+\t\trenderer.disposeTextLayout(layout);", "+\t}", "+\tint oldColumnX = columnX;", "+\tint oldHScrollOffset = horizontalScrollOffset;", "+\tif (select) setMouseWordSelectionAnchor();", "+\tshowCaret();", "+\tif (select) doSelection(ST.COLUMN_PREVIOUS);", "+\tint hScrollChange = oldHScrollOffset - horizontalScrollOffset;", "+\tcolumnX = oldColumnX + hScrollChange;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "931ffb76bc35f85dc88aca14a2d7d02f", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Custom Widgets/common/org/eclipse/swt/custom/StyledText.java", "commitBeforeChange": "635a9e5d0a5f495ec272194dbb750eddc745876f", "commitAfterChange": "e83d77b7ddccf5500d06ea30a64ce0d090ac4b10", "methodNumberBeforeChange": 225, "methodNumberAfterChange": 76, "signatureBeforeChange": " int doLineDown()", "signatureAfterChange": " void doLineDown(boolean select)", "diff": ["-int doLineDown() {", "-\tif (isSingleLine()) {", "-\t\treturn 0;", "+void doLineDown(boolean select) {", "+\tint caretLine = getCaretLine();", "+\tboolean paragraphDown = true;", "+\tif (wordWrap) {", "+\t\tTextLayout layout = renderer.getTextLayout(caretLine);", "+\t\tif (layout.getLineCount() > 0) {", "+\t\t\tPoint pos = getCaret().getLocation();", "+\t\t\tpos.x = columnX + horizontalScrollOffset;", "+\t\t\tpos.y -= getLinePixel(caretLine);", "+\t\t\tint offset = layout.getOffset(pos, null);", "+\t\t\tint lineInParagraph = layout.getLineIndex(offset);", "+\t\t\tif (lineInParagraph < layout.getLineCount() - 1) {", "+\t\t\t\tint lineOffset = content.getOffsetAtLine(caretLine);", "+\t\t\t\tparagraphDown = false;", "+\t\t\t\tpos.y += layout.getLineBounds(lineInParagraph).height;", "+\t\t\t\tcaretOffset = lineOffset + layout.getOffset(pos, null);", "+\t\t\t\tadvancing = false;", "+\t\t\t}", "+\t\t}", "+\t\trenderer.disposeTextLayout(layout);", "-\t// allow line down action only if receiver is not in single line mode.", "-\t// fixes 4820.", "-\tint caretLine = getCaretLine(); ", "-\tif (caretLine < content.getLineCount() - 1) {", "+\tif (select && caretLine == content.getLineCount() - 1) {", "+\t\tcaretOffset = content.getCharCount();", "+\t}", "+\tif (paragraphDown && caretLine < content.getLineCount() - 1) {", "-\t\tcaretOffset = getOffsetAtMouseLocation(columnX, caretLine);", "+\t\tint lineOffset = content.getOffsetAtLine(caretLine);", "+\t\tTextLayout layout = renderer.getTextLayout(caretLine);", "+\t\tint x = columnX + horizontalScrollOffset - leftMargin;", "+\t\tcaretOffset = lineOffset + layout.getOffset(x, 0, null);", "+\t\tadvancing = false;", "+\t\trenderer.disposeTextLayout(layout);", "-\treturn caretLine;", "+\tint oldColumnX = columnX;", "+\tint oldHScrollOffset = horizontalScrollOffset;", "+\tif (select) {", "+\t\tsetMouseWordSelectionAnchor();\t", "+\t\t// select first and then scroll to reduce flash when key ", "+\t\t// repeat scrolls lots of lines", "+\t\tdoSelection(ST.COLUMN_NEXT);", "+\t}", "+\tshowCaret();", "+\tint hScrollChange = oldHScrollOffset - horizontalScrollOffset;", "+\tcolumnX = oldColumnX + hScrollChange;"]}], "num": 58830}