{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "2996056a5c52719ad2bb7d08fe8ee5f2", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "082a493f648afebb85ae701f30d5da3f", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Drag and Drop/gtk/org/eclipse/swt/dnd/DropTarget.java", "commitBeforeChange": "4b10f2a3a24e7037b13a6b21d0386bf976be739d", "commitAfterChange": "616f5a4d963ffa9e332b664b81207bb1f17d8c21", "methodNumberBeforeChange": 11, "methodNumberAfterChange": 12, "signatureBeforeChange": "\t  int dragDataReceived ( int widget, int context, int x, int y, int data, int info, int time)", "signatureAfterChange": "  private int drag_data_received ( int widget, int context, int x, int y, int data, int info, int time)", "diff": ["-int dragDataReceived ( int widget, int context, int x, int y, int data, int info, int time){", "+", "+private int drag_data_received ( int widget, int context, int x, int y, int data, int info, int time){", "+\tDNDEvent event = new DNDEvent();", "+\tif (data == 0 || !setEventData(context, x, y, time, event)) {", "+\t\tkeyOperation = -1;", "+\t\treturn 0;", "+\t}", "+", "+\tint allowedOperations = event.operations;", "+\t", "-\tif (data != 0) {", "-\t\tGtkSelectionData selectionData = new GtkSelectionData(); ", "-\t\tOS.memmove(selectionData, data, GtkSelectionData.sizeof);", "-\t\tif (selectionData.data != 0) {", "-\t\t\ttransferData.type = selectionData.type;", "-\t\t\ttransferData.length = selectionData.length;", "-\t\t\ttransferData.pValue = selectionData.data;", "-\t\t\ttransferData.format = selectionData.format;", "-\t\t\tTransfer transfer = null;", "-\t\t\tfor (int i = 0; i < transferAgents.length; i++) {", "-\t\t\t\ttransfer = transferAgents[i];", "-\t\t\t\tif (transfer.isSupportedType(transferData)) break;", "-\t\t\t}", "-\t\t\tif (transfer != null) {", "-\t\t\t\tobject = transfer.nativeToJava(transferData);", "-\t\t\t}", "+\tGtkSelectionData selectionData = new GtkSelectionData(); ", "+\tOS.memmove(selectionData, data, GtkSelectionData.sizeof);", "+\tif (selectionData.data != 0) {", "+\t\ttransferData.type = selectionData.type;", "+\t\ttransferData.length = selectionData.length;", "+\t\ttransferData.pValue = selectionData.data;", "+\t\ttransferData.format = selectionData.format;", "+\t\tTransfer transfer = null;", "+\t\tfor (int i = 0; i < transferAgents.length; i++) {", "+\t\t\ttransfer = transferAgents[i];", "+\t\t\tif (transfer.isSupportedType(transferData)) break;", "+\t\t}", "+\t\tif (transfer != null) {", "+\t\t\tobject = transfer.nativeToJava(transferData);", "-\t//Notify listeners", "-\tDNDEvent event = new DNDEvent();", "-\tif (!setEventData(context, x, y, time, event)) return 0;", "+\t\tselectedOperation = DND.DROP_NONE;", "+\t\tif ((allowedOperations & event.detail) == event.detail) {", "+\t\t\tselectedOperation = event.detail;", "+\t\t}", "-\t\tevent.detail = DND.DROP_NONE;", "+\t\tselectedOperation = DND.DROP_NONE;", "+\tkeyOperation = -1;", "-\tOS.gtk_drag_finish(context, event.detail != DND.DROP_NONE, event.detail == DND.DROP_MOVE, time); \t\t\t", "+\tOS.gtk_drag_finish(context, selectedOperation != DND.DROP_NONE, selectedOperation== DND.DROP_MOVE, time); \t\t\t"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "94f1f43bcee4d9d2c27faec2169b5c11", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Drag and Drop/gtk/org/eclipse/swt/dnd/DropTarget.java", "commitBeforeChange": "4b10f2a3a24e7037b13a6b21d0386bf976be739d", "commitAfterChange": "616f5a4d963ffa9e332b664b81207bb1f17d8c21", "methodNumberBeforeChange": 24, "methodNumberAfterChange": 25, "signatureBeforeChange": "  boolean setEventData(int context, int x, int y, int time, DNDEvent event)", "signatureAfterChange": "  private boolean setEventData(int context, int x, int y, int time, DNDEvent event)", "diff": ["-boolean setEventData(int context, int x, int y, int time, DNDEvent event) {", "+private boolean setEventData(int context, int x, int y, int time, DNDEvent event) {", "+\t", "+\t// get allowed operations", "+\tint style = getStyle();", "+\tint operations = osOpToOp(dragContext.actions) & style;", "+\tif (operations == DND.DROP_NONE) return false;", "+\t", "+\t// get current operation", "+\tint operation = getOperationFromKeyState();", "+\tkeyOperation = operation;", "+\tif (operation== DND.DROP_DEFAULT) {", "+\t\tif ((style & DND.DROP_DEFAULT) == 0) {", "+\t\t\toperation = (operations & DND.DROP_MOVE) != 0 ? DND.DROP_MOVE : DND.DROP_NONE;", "+\t\t}", "+\t} else {", "+\t\tif ((operation & operations) == 0) operation = DND.DROP_NONE;", "+\t}", "+", "+\t// Get allowed transfer types", "-\tTransferData[] tdata = new TransferData[0];", "+\tTransferData[] dataTypes = new TransferData[0];", "-\t\tTransferData[] newTdata = new TransferData[tdata.length + 1];", "-\t\tSystem.arraycopy(tdata, 0, newTdata, 0, tdata.length);", "-\t\tnewTdata[tdata.length] = data;", "-\t\ttdata = newTdata;", "+\t\tfor (int j = 0; j < transferAgents.length; j++) {", "+\t\t\tif (transferAgents[j].isSupportedType(data)) {", "+\t\t\t\tTransferData[] newDataTypes = new TransferData[dataTypes.length + 1];", "+\t\t\t\tSystem.arraycopy(dataTypes, 0, newDataTypes, 0, dataTypes.length);", "+\t\t\t\tnewDataTypes[dataTypes.length] = data;", "+\t\t\t\tdataTypes = newDataTypes;\t", "+\t\t\t\tbreak;", "+\t\t\t}", "+\t\t}", "-\tif (tdata.length == 0) return false;", "+\tif (dataTypes.length == 0) return false;", "-", "+\t", "-\tevent.dataTypes\t= tdata;", "-\tint operations = osOpToOp(dragContext.actions);", "-\tif (operations == DND.DROP_COPY ||", "-\t    operations == DND.DROP_LINK || ", "-\t    operations == DND.DROP_MOVE || ", "-\t    operations == DND.DROP_NONE) {", "-\t\t\tevent.detail = operations;", "-\t} else {", "-\t\t\tevent.detail = DND.DROP_DEFAULT;", "-\t}", "-\tevent.operations = operations;", "+\tevent.feedback = DND.FEEDBACK_SELECT;", "+\tevent.dataTypes = dataTypes;", "+\tevent.dataType = dataTypes[0];", "+\tevent.operations = operations;", "+\tevent.detail = operation;"]}], "num": 61205}