{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "35f4137e2cde83fe10959b9c361f2f52", "detectedBy": ["AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "ded6142f0b9896fdd624dc346bfef821", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/cocoa/org/eclipse/swt/widgets/MenuItem.java", "commitBeforeChange": "b85fb68961573dd389adf28379ab9deeba886abc", "commitAfterChange": "e2d1a7d7aebda79ac656f9c79dc6c06be5122338", "methodNumberBeforeChange": 34, "methodNumberAfterChange": 34, "signatureBeforeChange": " \t void updateText ()", "signatureAfterChange": " \t void updateText ()", "diff": ["-\t\tnsItem.setTitle (label);", "+\t\tint direction = (parent.getStyle () & SWT.RIGHT_TO_LEFT) != 0 ? OS.NSWritingDirectionRightToLeft : OS.NSWritingDirectionLeftToRight;", "+\t\tNSMutableDictionary dict = ((NSMutableDictionary)new NSMutableDictionary().alloc()).initWithCapacity(2);", "+\t\tNSMutableParagraphStyle paragraphStyle = (NSMutableParagraphStyle)new NSMutableParagraphStyle ().alloc ().init ();", "+\t\tparagraphStyle.setBaseWritingDirection(direction);", "+\t\tdict.setObject (paragraphStyle, OS.NSParagraphStyleAttributeName);", "+\t\tparagraphStyle.release ();", "+\t\tdict.setObject (NSFont.menuBarFontOfSize(0), OS.NSFontAttributeName);", "+\t\tNSAttributedString attribStr = ((NSAttributedString) new NSAttributedString ().alloc ()).initWithString (label, dict);", "+\t\tdict.release();", "+\t\tnsItem.setAttributedTitle(attribStr);", "+\t\tattribStr.release();"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "81055ef516cf7af5a39210bc6f2d8c41", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/cocoa/org/eclipse/swt/graphics/GC.java", "commitBeforeChange": "bcaafebf3d1c0b9cf3c5ce180e5a53cde2e7ad58", "commitAfterChange": "93745a79da963108a6ee75f8fd35bcdb8794dcb1", "methodNumberBeforeChange": 58, "methodNumberAfterChange": 58, "signatureBeforeChange": " public FontMetrics getFontMetrics()", "signatureAfterChange": " public FontMetrics getFontMetrics()", "diff": ["-\t\tString s = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";  //$NON-NLS-1$", "-\t\tNSAttributedString attribStr = createString(s, 0, false);", "-\t\tdata.textStorage.setAttributedString(attribStr);", "-\t\tattribStr.release();", "-\t\tNSLayoutManager layoutManager = data.layoutManager;", "-\t\tlayoutManager.glyphRangeForTextContainer(data.textContainer);", "-\t\tNSRect rect = layoutManager.usedRectForTextContainer(data.textContainer);", "-\t\tint width = (int)Math.ceil(rect.width);", "-\t\tint ascent = (int)layoutManager.defaultBaselineOffsetForFont(data.font.handle);", "-\t\tint height = (int)layoutManager.defaultLineHeightForFont(data.font.handle);", "-\t\treturn FontMetrics.cocoa_new(ascent, height - ascent, width / s.length(), 0, height);", "+", "+\t\tif (data.font.metrics == null) {", "+\t\t\tString s = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";  //$NON-NLS-1$", "+\t\t\tNSMutableDictionary dict = ((NSMutableDictionary)new NSMutableDictionary().alloc()).initWithCapacity(3);", "+\t\t\tdict.setObject(data.font.handle, OS.NSFontAttributeName);", "+\t\t\tdata.font.addTraits(dict);", "+\t\t\tNSAttributedString attribStr = ((NSAttributedString)new NSAttributedString().alloc()).initWithString(NSString.stringWith(s), dict);", "+\t\t\tdata.textStorage.setAttributedString(attribStr);", "+\t\t\tattribStr.release();", "+\t\t\tdict.release();", "+\t\t\tNSLayoutManager layoutManager = data.layoutManager;", "+\t\t\tlayoutManager.glyphRangeForTextContainer(data.textContainer);", "+\t\t\tNSRect rect = layoutManager.usedRectForTextContainer(data.textContainer);", "+\t\t\tint avgWidth = (int) Math.ceil(rect.width) / s.length();", "+\t\t\tint ascent = (int)layoutManager.defaultBaselineOffsetForFont(data.font.handle);", "+\t\t\tint height = (int)layoutManager.defaultLineHeightForFont(data.font.handle);", "+\t\t\tdata.font.metrics = FontMetrics.cocoa_new(ascent, height - ascent, avgWidth, 0, height); ", "+\t\t}", "+\t\t", "+\t\treturn data.font.metrics;"]}], "num": 55764}