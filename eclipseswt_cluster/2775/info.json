{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "12c8563b632b39b1433db1a6fda138d8", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "db2e099f8da5ef04f874526fbc0557da", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT OLE Win32/win32/org/eclipse/swt/ole/win32/OleClientSite.java", "commitBeforeChange": "dd0862c01e9b993d658b395af820f586129ec8a1", "commitAfterChange": "7f2ab38fb4043d4a5bb5f2320fea53804d91ff7f", "methodNumberBeforeChange": 2, "methodNumberAfterChange": 2, "signatureBeforeChange": " public OleClientSite(Composite parent, int style, File file)", "signatureAfterChange": " public OleClientSite(Composite parent, int style, File file)", "diff": ["-\t\tappClsid = new GUID();", "+\t\tGUID fileClsid = new GUID();", "-\t\tint result = COM.GetClassFile(fileName, appClsid);", "+\t\tint result = COM.GetClassFile(fileName, fileClsid);", "-\t\tif (getProgramID() == null)", "+\t\tappClsid = fileClsid;", "+\t\tString progID = getProgramID(); ", "+\t\tif (progID == null)", "-\t\t// Open a temporary storage object", "-\t\ttempStorage = createTempStorage();", "-", "-\t\t// Create ole object with storage object", "-\t\tint /*long*/[] address = new int /*long*/[1];", "-\t\tresult = COM.OleCreateFromFile(appClsid, fileName, COM.IIDIUnknown, COM.OLERENDER_DRAW, null, iOleClientSite.getAddress(), tempStorage.getAddress(), address);", "-\t\tif (result != COM.S_OK)", "-\t\t\tOLE.error(OLE.ERROR_CANNOT_CREATE_OBJECT, result);", "-", "-\t\tobjIUnknown = new IUnknown(address[0]);", "+\t\t/* Bug in Windows. In some machines running Windows Vista and ", "+\t\t * Office 2007, OleCreateFromFile() fails to open files from ", "+\t\t * Office Word 97 - 2003. The fix is to detect this case and create", "+\t\t * the activeX using CoCreateInstance() and then load the file", "+\t\t * using IPersistStorage.Load().", "+\t\t */", "+\t\tif (progID.equals(\"Word.Document.8\")) { //$NON-NLS-1$", "+\t\t\tGUID clsid = getClassID(WORDPROGID);", "+\t\t\tString latestProgID = getProgID(clsid);", "+\t\t\tif (latestProgID.equals(\"Word.Document.12\")) { //$NON-NLS-1$", "+\t\t\t\tappClsid = clsid;", "+\t\t\t}", "+\t\t}", "-\t\t// Init sinks", "-\t\taddObjectReferences();", "-\t\t", "-\t\tif (COM.OleRun(objIUnknown.getAddress()) == OLE.S_OK) state = STATE_RUNNING;", "+\t\tOleCreate(appClsid, fileClsid, fileName, file);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "edd77d9397335a0a94496710bd8fccfd", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT OLE Win32/win32/org/eclipse/swt/ole/win32/OleClientSite.java", "commitBeforeChange": "647ee8ac0b4674688a64286f665d0bc51c0718e8", "commitAfterChange": "8c113a426e5f05549192616bd0df00498451eac3", "methodNumberBeforeChange": 2, "methodNumberAfterChange": 2, "signatureBeforeChange": " public OleClientSite(Composite parent, int style, File file)", "signatureAfterChange": " public OleClientSite(Composite parent, int style, File file)", "diff": ["-\t\tif (result != COM.S_OK)", "-\t\t\tOLE.error(OLE.ERROR_INVALID_CLASSID, result);", "+\t\tif (result != COM.S_OK)\tOLE.error(OLE.ERROR_INVALID_CLASSID, result);", "-\t\tappClsid = fileClsid;", "-\t\tString progID = getProgramID(); ", "-\t\tif (progID == null)", "-\t\t\tOLE.error(OLE.ERROR_INVALID_CLASSID, result);", "+\t\tString progID = getProgID(fileClsid); ", "+\t\tif (progID == null)\tOLE.error(OLE.ERROR_INVALID_CLASSID, result);", "-\t\t/* Bug in Windows. In some machines running Windows Vista and ", "-\t\t * Office 2007, OleCreateFromFile() fails to open files from ", "-\t\t * Office Word 97 - 2003. The fix is to detect this case and create", "-\t\t * the activeX using CoCreateInstance() and then load the file", "-\t\t * using IPersistStorage.Load().", "-\t\t */", "-\t\tif (progID.equals(\"Word.Document.8\")) { //$NON-NLS-1$", "-\t\t\tGUID clsid = getClassID(WORDPROGID);", "-\t\t\tString latestProgID = getProgID(clsid);", "-\t\t\tif (latestProgID.equals(\"Word.Document.12\")) { //$NON-NLS-1$", "-\t\t\t\tappClsid = clsid;", "-\t\t\t}", "-\t\t}", "-\t\t", "+\t\tappClsid = fileClsid;"]}], "num": 2775}