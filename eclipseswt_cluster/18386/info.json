{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "4d84ac33221db6dd71b7698447c594dd", "detectedBy": ["AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "edd77d9397335a0a94496710bd8fccfd", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT OLE Win32/win32/org/eclipse/swt/ole/win32/OleClientSite.java", "commitBeforeChange": "647ee8ac0b4674688a64286f665d0bc51c0718e8", "commitAfterChange": "8c113a426e5f05549192616bd0df00498451eac3", "methodNumberBeforeChange": 2, "methodNumberAfterChange": 2, "signatureBeforeChange": " public OleClientSite(Composite parent, int style, File file)", "signatureAfterChange": " public OleClientSite(Composite parent, int style, File file)", "diff": ["-\t\tif (result != COM.S_OK)", "-\t\t\tOLE.error(OLE.ERROR_INVALID_CLASSID, result);", "+\t\tif (result != COM.S_OK)\tOLE.error(OLE.ERROR_INVALID_CLASSID, result);", "-\t\tappClsid = fileClsid;", "-\t\tString progID = getProgramID(); ", "-\t\tif (progID == null)", "-\t\t\tOLE.error(OLE.ERROR_INVALID_CLASSID, result);", "+\t\tString progID = getProgID(fileClsid); ", "+\t\tif (progID == null)\tOLE.error(OLE.ERROR_INVALID_CLASSID, result);", "-\t\t/* Bug in Windows. In some machines running Windows Vista and ", "-\t\t * Office 2007, OleCreateFromFile() fails to open files from ", "-\t\t * Office Word 97 - 2003. The fix is to detect this case and create", "-\t\t * the activeX using CoCreateInstance() and then load the file", "-\t\t * using IPersistStorage.Load().", "-\t\t */", "-\t\tif (progID.equals(\"Word.Document.8\")) { //$NON-NLS-1$", "-\t\t\tGUID clsid = getClassID(WORDPROGID);", "-\t\t\tString latestProgID = getProgID(clsid);", "-\t\t\tif (latestProgID.equals(\"Word.Document.12\")) { //$NON-NLS-1$", "-\t\t\t\tappClsid = clsid;", "-\t\t\t}", "-\t\t}", "-\t\t", "+\t\tappClsid = fileClsid;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "d37d249f9feaacb4100818688507318c", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT OLE Win32/win32/org/eclipse/swt/ole/win32/OleClientSite.java", "commitBeforeChange": "306f95301b97e9d8ba82cad67812ad605a6ab86b", "commitAfterChange": "de5b9b1f68cbb466a86733b45d1a63f217e8c701", "methodNumberBeforeChange": 82, "methodNumberAfterChange": 83, "signatureBeforeChange": " public boolean save(File file, boolean includeOleInfo)", "signatureAfterChange": " public boolean save(File file, boolean includeOleInfo)", "diff": ["-\tString programID = getProgramID();", "-\t", "-\t/*", "-\t* Bug in Office 2007. Saving Office 2007 documents to compound file storage object", "-\t* causes the output file to be corrupted. The fix is to detect Office 2007 documents", "-\t* using the program ID and save only the content of the 'Package' stream. ", "-\t*/", "-\tif (programID != null && (programID.equals(\"Word.Document.12\") || programID.equals(\"Excel.Sheet.12\") || programID.equals(\"PowerPoint.Show.12\"))) { //$NON-NLS-1$ //$NON-NLS-2$ //$NON-NLS-3$ ", "-\t\treturn saveOffice2007(file);", "-\t}"]}], "num": 18386}