{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "951ea04846130c31d5138db699772b05", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "e7d7be7e9fc6110ced1c62cd2eef6cf7", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/motif/org/eclipse/swt/widgets/Control.java", "commitBeforeChange": "a2121a3b36fd9f479b5853f961011d3d772dea1a", "commitAfterChange": "180b63adf3a86ec0ec05574f5a95cc8803880a19", "methodNumberBeforeChange": 93, "methodNumberAfterChange": 93, "signatureBeforeChange": " void sendIMKeyEvent (int type, XKeyEvent xEvent, byte [] mbcs, char [] chars)", "signatureAfterChange": " boolean sendIMKeyEvent (int type, XKeyEvent xEvent, int textHandle)", "diff": ["+}", "+boolean sendIMKeyEvent (int type, XKeyEvent xEvent, int textHandle) {", "+\tif (length == 0) return true;", "-}", "-void sendIMKeyEvent (int type, XKeyEvent xEvent, byte [] mbcs, char [] chars) {", "-\tint index = 0;", "+\tchar [] chars = Converter.mbcsToWcs (null, buffer);", "+\tint index = 0, count = 0;", "-\t\tif (chars [index] == 0) break;", "+\t\tif (chars [index] == 0) {", "+\t\t\tchars [count] = 0;", "+\t\t\tbreak;", "+\t\t}", "-\t\tpostEvent (type, event);", "+\t\tsendEvent (type, event);", "+\t\tif (event.doit) chars [count++] = chars [index];", "+\tif (count == 0) return false;", "+\tif (textHandle != 0) {", "+\t\t/*", "+\t\t* Bug in Motif. On Solaris and Linux, XmImMbLookupString() clears", "+\t\t* the characters from the IME. This causes the characters to be", "+\t\t* stolen from the text widget. The fix is to detect that the IME", "+\t\t* has been cleared and use XmTextInsert() to insert the stolen", "+\t\t* characters. This problem does not happen on AIX.", "+\t\t*/", "+\t\tbyte [] testBuffer = new byte [5];", "+\t\tint testLength = OS.XmImMbLookupString (textHandle, xEvent, testBuffer, testBuffer.length, unused, unused);", "+\t\tif (testLength == 0 || index != count) {", "+\t\t\tint [] start = new int [1], end = new int [1];", "+\t\t\tOS.XmTextGetSelectionPosition (textHandle, start, end);", "+\t\t\tif (start [0] == end [0]) {", "+\t\t\t\tstart [0] = end [0] = OS.XmTextGetInsertionPosition (textHandle);", "+\t\t\t}", "+\t\t\tboolean warnings = display.getWarnings ();", "+\t\t\tdisplay.setWarnings (false);", "+\t\t\tif (index != count) {", "+\t\t\t\tbuffer = Converter.wcsToMbcs (getCodePage (), chars, true);", "+\t\t\t}", "+\t\t\tOS.XmTextReplace (textHandle, start [0], end [0], buffer);", "+\t\t\tint position = start [0] + count;", "+\t\t\tOS.XmTextSetInsertionPosition (textHandle, position);", "+\t\t\tdisplay.setWarnings (warnings);", "+\t\t}", "+\t\treturn false;", "+\t}", "+\treturn true;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "49883a3d67a43d416ad5a6f07c4b3f48", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/motif/org/eclipse/swt/widgets/Control.java", "commitBeforeChange": "4510458698a44cfe0ebb614544242955fbc20f7a", "commitAfterChange": "d07e719160ad9b5428874b3929f88d189e7c89ac", "methodNumberBeforeChange": 94, "methodNumberAfterChange": 97, "signatureBeforeChange": "\r void sendKeyEvent (int type, XKeyEvent xEvent)", "signatureAfterChange": "\r byte [] sendKeyEvent (int type, XKeyEvent xEvent)", "diff": ["-void sendKeyEvent (int type, XKeyEvent xEvent) {\r", "+byte [] sendKeyEvent (int type, XKeyEvent xEvent) {\r", "-\t\tint size = 0;\r", "-\t\tbuffer = new byte [2];\r", "-\t\tint xIC = inputContext ();\r", "-\t\tif (xIC == 0) {\r", "-\t\t\tsize = OS.XmImMbLookupString (handle, xEvent, buffer, buffer.length, keysym, status);\r", "-\t\t\tif (status [0] == OS.XBufferOverflow) {\r", "-\t\t\t\tbuffer = new byte [size];\r", "-\t\t\t\tsize = OS.XmImMbLookupString (handle, xEvent, buffer, size, keysym, status);\r", "-\t\t\t}\r", "-\t\t} else {\r", "-\t\t\tsize = OS.XmbLookupString (xIC, xEvent, buffer, buffer.length, keysym, status);\r", "-\t\t\tif (status [0] == OS.XBufferOverflow) {\r", "-\t\t\t\tbuffer = new byte [size];\r", "-\t\t\t\tsize = OS.XmbLookupString (xIC, xEvent, buffer, size, keysym, status);\r", "-\t\t\t}\r", "+\t\t/*\r", "+\t\t* Bug in Motif. On Linux only, XmImMbLookupString() does not return \r", "+\t\t* XBufferOverflow as the status if the buffer is too small. The fix is\r", "+\t\t* to pass a bigger buffer.\r", "+\t\t*/\r", "+\t\tbuffer = new byte [512];\r", "+\t\tint size = OS.XmImMbLookupString (handle, xEvent, buffer, buffer.length, keysym, status);\r", "+\t\tif (status [0] == OS.XBufferOverflow) {\r", "+\t\t\tbuffer = new byte [size];\r", "+\t\t\tsize = OS.XmImMbLookupString (handle, xEvent, buffer, size, keysym, status);\r", "-\t\tif (size == 0) return;\r", "+\t\tif (size == 0) return null;\r", "-\tif (IsSunOS) {\r", "+\tif (OS.IsSunOS) {\r", "+\t/* Use the character encoding for the default locale */\r", "-\tfor (int i=0; i<result.length; i++) {\r", "+\tint index = 0;\r", "+\twhile (index < result.length) {\r", "+\t\tif (result [index] == 0) break;\r", "-\t\tevent.character = result [i];\r", "+\t\tevent.character = result [index];\r", "+\t\tindex++;\r", "+\t\r", "+\treturn buffer;\r"]}], "num": 14825}