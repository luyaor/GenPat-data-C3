{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "8149e621435b4d452a1f906c8cc01ea9", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "70626c37f687a40f7614c2cd1a7b602a", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/win32/org/eclipse/swt/graphics/TextLayout.java", "commitBeforeChange": "49004903cea627f8e18ec7beb495ed69bd7515bf", "commitAfterChange": "74b446f0656f1cd959b11120c70a3b24ba9958b8", "methodNumberBeforeChange": 10, "methodNumberAfterChange": 10, "signatureBeforeChange": " public void draw (GC gc, int x, int y, int selectionStart, int selectionEnd, Color selectionForeground, Color selectionBackground, int flags)", "signatureAfterChange": " public void draw (GC gc, int x, int y, int selectionStart, int selectionEnd, Color selectionForeground, Color selectionBackground, int flags)", "diff": ["-\t\t\t\t\tint end = run.start + run.length - 1;", "-\t\t\t\t\tboolean fullSelection = hasSelection && selectionStart <= run.start && selectionEnd >= end;", "-\t\t\t\t\tif (fullSelection) {", "-\t\t\t\t\t\tif (gdip) {", "-\t\t\t\t\t\t\tGdip.Graphics_FillRectangle(gdipGraphics, selBrush, drawX, drawY, run.width, lineHeight);", "-\t\t\t\t\t\t} else {", "-\t\t\t\t\t\t\tOS.SelectObject(hdc, selBrush);", "-\t\t\t\t\t\t\tOS.PatBlt(hdc, drawX, drawY, run.width, lineHeight, OS.PATCOPY);", "-\t\t\t\t\t\t}", "+\t\t\t\t\tOS.SetRect(rect, drawX, drawY, drawX + run.width, drawY + lineHeight);", "+\t\t\t\t\tif (gdip) {", "+\t\t\t\t\t\tdrawRunBackgroundGDIP(run, gdipGraphics, rect, selectionStart, selectionEnd, alpha, selBrush, hasSelection);", "-\t\t\t\t\t\tif (run.style != null && run.style.background != null) {", "-\t\t\t\t\t\t\tint bg = run.style.background.handle;", "-\t\t\t\t\t\t\tif (gdip) {", "-\t\t\t\t\t\t\t\tint argb = ((alpha & 0xFF) << 24) | ((bg >> 16) & 0xFF) | (bg & 0xFF00) | ((bg & 0xFF) << 16);", "-\t\t\t\t\t\t\t\tint /*long*/ color = Gdip.Color_new(argb); ", "-\t\t\t\t\t\t\t\tint /*long*/ brush = Gdip.SolidBrush_new(color);", "-\t\t\t\t\t\t\t\tGdip.Graphics_FillRectangle(gdipGraphics, brush, drawX, drawY, run.width, lineHeight);", "-\t\t\t\t\t\t\t\tGdip.Color_delete(color);", "-\t\t\t\t\t\t\t\tGdip.SolidBrush_delete(brush);", "-\t\t\t\t\t\t\t} else {", "-\t\t\t\t\t\t\t\tint /*long*/ hBrush = OS.CreateSolidBrush (bg);", "-\t\t\t\t\t\t\t\tint /*long*/ oldBrush = OS.SelectObject(hdc, hBrush);", "-\t\t\t\t\t\t\t\tOS.PatBlt(hdc, drawX, drawY, run.width, lineHeight, OS.PATCOPY);", "-\t\t\t\t\t\t\t\tOS.SelectObject(hdc, oldBrush);", "-\t\t\t\t\t\t\t\tOS.DeleteObject(hBrush);", "-\t\t\t\t\t\t\t}", "-\t\t\t\t\t\t}", "-\t\t\t\t\t\tboolean partialSelection = hasSelection && !(selectionStart > end || run.start > selectionEnd);", "-\t\t\t\t\t\tif (partialSelection) {", "-\t\t\t\t\t\t\tint selStart = Math.max(selectionStart, run.start) - run.start;", "-\t\t\t\t\t\t\tint selEnd = Math.min(selectionEnd, end) - run.start;", "-\t\t\t\t\t\t\tint cChars = run.length;", "-\t\t\t\t\t\t\tint gGlyphs = run.glyphCount;", "-\t\t\t\t\t\t\tint[] piX = new int[1];", "-\t\t\t\t\t\t\tint /*long*/ advances = run.justify != 0 ? run.justify : run.advances;", "-\t\t\t\t\t\t\tOS.ScriptCPtoX(selStart, false, cChars, gGlyphs, run.clusters, run.visAttrs, advances, run.analysis, piX);", "-\t\t\t\t\t\t\tint runX = (orientation & SWT.RIGHT_TO_LEFT) != 0 ? run.width - piX[0] : piX[0];", "-\t\t\t\t\t\t\trect.left = drawX + runX;", "-\t\t\t\t\t\t\trect.top = drawY;", "-\t\t\t\t\t\t\tOS.ScriptCPtoX(selEnd, true, cChars, gGlyphs, run.clusters, run.visAttrs, advances, run.analysis, piX);", "-\t\t\t\t\t\t\trunX = (orientation & SWT.RIGHT_TO_LEFT) != 0 ? run.width - piX[0] : piX[0];", "-\t\t\t\t\t\t\trect.right = drawX + runX;", "-\t\t\t\t\t\t\trect.bottom = drawY + lineHeight;", "-\t\t\t\t\t\t\tif (gdip) {", "-\t\t\t\t\t\t\t\tif (rect.left > rect.right) {", "-\t\t\t\t\t\t\t\t\tint tmp = rect.left;", "-\t\t\t\t\t\t\t\t\trect.left = rect.right;", "-\t\t\t\t\t\t\t\t\trect.right = tmp;", "-\t\t\t\t\t\t\t\t}", "-\t\t\t\t\t\t\t\tGdip.Graphics_FillRectangle(gdipGraphics, selBrush, rect.left, rect.top, rect.right - rect.left, rect.bottom - rect.top);", "-\t\t\t\t\t\t\t} else {", "-\t\t\t\t\t\t\t\tOS.SelectObject(hdc, selBrush);", "-\t\t\t\t\t\t\t\tOS.PatBlt(hdc, rect.left, rect.top, rect.right - rect.left, rect.bottom - rect.top, OS.PATCOPY);", "-\t\t\t\t\t\t\t}", "-\t\t\t\t\t\t}", "+\t\t\t\t\t\tdrawRunBackground(run, hdc, rect, selectionStart, selectionEnd, selBrush, hasSelection);", "+\t}", "+}"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "35452c4cb407ecb9e8977c94cd1f1b92", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/win32/org/eclipse/swt/graphics/TextLayout.java", "commitBeforeChange": "65777ce3d2a96099cf20830ff9a4bd6c4c860e8f", "commitAfterChange": "ba852d737724ee92cb82b3435acad91de5d9d6c7", "methodNumberBeforeChange": 10, "methodNumberAfterChange": 10, "signatureBeforeChange": " public void draw (GC gc, int x, int y, int selectionStart, int selectionEnd, Color selectionForeground, Color selectionBackground, int flags)", "signatureAfterChange": " public void draw (GC gc, int x, int y, int selectionStart, int selectionEnd, Color selectionForeground, Color selectionBackground, int flags)", "diff": ["-\t\t\t\t\t\tif (run.style != null && (run.style.underline || run.style.strikeout)) {", "-\t\t\t\t\t\t\tint /*long*/ newPen = hasSelection ? selPen : Gdip.Pen_new(brush, 1);", "-\t\t\t\t\t\t\tGdip.Graphics_SetPixelOffsetMode(gdipGraphics, Gdip.PixelOffsetModeNone);", "-\t\t\t\t\t\t\tif (run.style.underline) {", "-\t\t\t\t\t\t\t\tint underlineY = drawY + baseline + 1 - run.style.rise;", "-\t\t\t\t\t\t\t\tGdip.Graphics_DrawLine(gdipGraphics, newPen, drawX, underlineY, drawX + run.width, underlineY);", "-\t\t\t\t\t\t\t}", "-\t\t\t\t\t\t\tif (run.style.strikeout) {", "-\t\t\t\t\t\t\t\tint strikeoutY = drawRunY + run.leading + (run.ascent - run.style.rise) / 2;", "-\t\t\t\t\t\t\t\tGdip.Graphics_DrawLine(gdipGraphics, newPen, drawX, strikeoutY, drawX + run.width, strikeoutY);", "-\t\t\t\t\t\t\t}", "-\t\t\t\t\t\t\tif (newPen != selPen) Gdip.Pen_delete(newPen);", "-\t\t\t\t\t\t\tGdip.Graphics_SetPixelOffsetMode(gdipGraphics, Gdip.PixelOffsetModeHalf);", "-\t\t\t\t\t\t}", "+\t\t\t\t\t\tdrawLines(gdip, gdipGraphics, drawX, drawRunY, run, brush);", "-\t\t\t\t\t\t\tif (run.style != null && (run.style.underline || run.style.strikeout)) {", "-\t\t\t\t\t\t\t\tGdip.Graphics_SetPixelOffsetMode(gdipGraphics, Gdip.PixelOffsetModeNone);", "-\t\t\t\t\t\t\t\tif (run.style.underline) {", "-\t\t\t\t\t\t\t\t\tint underlineY = drawY + baseline + 1 - run.style.rise;", "-\t\t\t\t\t\t\t\t\tGdip.Graphics_DrawLine(gdipGraphics, selPen, rect.left, underlineY, rect.right, underlineY);", "-\t\t\t\t\t\t\t\t}", "-\t\t\t\t\t\t\t\tif (run.style.strikeout) {", "-\t\t\t\t\t\t\t\t\tint strikeoutY = drawRunY + run.leading + (run.ascent - run.style.rise) / 2;", "-\t\t\t\t\t\t\t\t\tGdip.Graphics_DrawLine(gdipGraphics, selPen, rect.left, strikeoutY, rect.right, strikeoutY);", "-\t\t\t\t\t\t\t\t}", "-\t\t\t\t\t\t\t\tGdip.Graphics_SetPixelOffsetMode(gdipGraphics, Gdip.PixelOffsetModeHalf);", "-\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\tdrawLines(gdip, gdipGraphics, drawX, drawRunY, run, selBrushFg);", "-\t\t\t\t\t\tif (run.style != null && (run.style.underline || run.style.strikeout)) {", "-\t\t\t\t\t\t\tint /*long*/ newPen = hasSelection && fg == selectionForeground.handle ? selPen : OS.CreatePen(OS.PS_SOLID, 1, fg);", "-\t\t\t\t\t\t\tint /*long*/ oldPen = OS.SelectObject(hdc, newPen);", "-\t\t\t\t\t\t\tif (run.style.underline) {", "-\t\t\t\t\t\t\t\tint underlineY = drawY + baseline + 1 - run.style.rise;", "-\t\t\t\t\t\t\t\tOS.MoveToEx(hdc, drawX, underlineY, 0);", "-\t\t\t\t\t\t\t\tOS.LineTo(hdc, drawX + run.width, underlineY);", "-\t\t\t\t\t\t\t}", "-\t\t\t\t\t\t\tif (run.style.strikeout) {", "-\t\t\t\t\t\t\t\tint strikeoutY = drawRunY + run.leading + (run.ascent - run.style.rise) / 2;", "-\t\t\t\t\t\t\t\tOS.MoveToEx(hdc, drawX, strikeoutY, 0);", "-\t\t\t\t\t\t\t\tOS.LineTo(hdc, drawX + run.width, strikeoutY);\t", "-\t\t\t\t\t\t\t}", "-\t\t\t\t\t\t\tOS.SelectObject(hdc, oldPen);", "-\t\t\t\t\t\t\tif (!hasSelection || fg != selectionForeground.handle) OS.DeleteObject(newPen);", "-\t\t\t\t\t\t}", "+\t\t\t\t\t\tdrawLines(gdip, hdc, drawX, drawRunY, run, fg);", "-\t\t\t\t\t\t\tif (run.style != null && (run.style.underline || run.style.strikeout)) {\t\t\t\t\t\t\t", "-\t\t\t\t\t\t\t\tint /*long*/ oldPen = OS.SelectObject(hdc, selPen);", "-\t\t\t\t\t\t\t\tif (run.style.underline) {", "-\t\t\t\t\t\t\t\t\tint underlineY = drawY + baseline + 1 - run.style.rise;", "-\t\t\t\t\t\t\t\t\tOS.MoveToEx(hdc, rect.left, underlineY, 0);", "-\t\t\t\t\t\t\t\t\tOS.LineTo(hdc, rect.right, underlineY);", "-\t\t\t\t\t\t\t\t}", "-\t\t\t\t\t\t\t\tif (run.style.strikeout) {", "-\t\t\t\t\t\t\t\t\tint strikeoutY = drawRunY + run.leading + (run.ascent - run.style.rise) / 2;", "-\t\t\t\t\t\t\t\t\tOS.MoveToEx(hdc, rect.left, strikeoutY, 0);", "-\t\t\t\t\t\t\t\t\tOS.LineTo(hdc, rect.right, strikeoutY);\t", "-\t\t\t\t\t\t\t\t}", "-\t\t\t\t\t\t\t\tOS.SelectObject(hdc, oldPen);", "-\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\tdrawLines(gdip, hdc, drawX, drawRunY, run, selectionForeground.handle);", "+\t}", "+}"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "5a914924b547fa5de38a98a546379aaf", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/win32/org/eclipse/swt/graphics/TextLayout.java", "commitBeforeChange": "730383938344c8db63a066870828ce1e9edbaeff", "commitAfterChange": "ff5cee0ddb447114a3cb637cbfa7673f5548d1d3", "methodNumberBeforeChange": 7, "methodNumberAfterChange": 7, "signatureBeforeChange": " public void draw (GC gc, int x, int y, int selectionStart, int selectionEnd, Color selectionForeground, Color selectionBackground)", "signatureAfterChange": " public void draw (GC gc, int x, int y, int selectionStart, int selectionEnd, Color selectionForeground, Color selectionBackground)", "diff": ["-\tint selBrush = 0;", "-\tif (hasSelection) selBrush = OS.CreateSolidBrush (selectionBackground.handle);", "+\tint selBrush = 0, selPen = 0;", "+\tif (hasSelection) {", "+\t\tselBrush = OS.CreateSolidBrush(selectionBackground.handle);", "+\t\tselPen = OS.CreatePen(OS.BS_SOLID, 1, selectionForeground.handle);", "+\t}", "+\t\t\t\t\tif ((run.style != null) && (run.style.underline || run.style.strikeout)) {", "+\t\t\t\t\t\tint newPen = fg == selectionForeground.handle ? selPen : OS.CreatePen(OS.BS_SOLID, 1, fg);", "+\t\t\t\t\t\tint oldPen = OS.SelectObject(hdc, newPen);", "+\t\t\t\t\t\tif (run.style.underline) {", "+\t\t\t\t\t\t\tint underlineY = drawY + baseline + 1;", "+\t\t\t\t\t\t\tOS.MoveToEx(hdc, drawX, underlineY, 0);", "+\t\t\t\t\t\t\tOS.LineTo(hdc, drawX + run.width, underlineY);", "+\t\t\t\t\t\t}", "+\t\t\t\t\t\tif (run.style.strikeout) {", "+\t\t\t\t\t\t\tint strikeoutY = drawRunY + run.leading + run.ascent / 2;", "+\t\t\t\t\t\t\tOS.MoveToEx(hdc, drawX, strikeoutY, 0);", "+\t\t\t\t\t\t\tOS.LineTo(hdc, drawX + run.width, strikeoutY);\t", "+\t\t\t\t\t\t}", "+\t\t\t\t\t\tOS.SelectObject(hdc, oldPen);", "+\t\t\t\t\t\tif (fg != selectionForeground.handle) OS.DeleteObject(newPen);", "+\t\t\t\t\t}", "+\t\t\t\t\t\tif ((run.style != null) && (run.style.underline || run.style.strikeout)) {\t\t\t\t\t\t\t", "+\t\t\t\t\t\t\tint oldPen = OS.SelectObject(hdc, selPen);", "+\t\t\t\t\t\t\tif (run.style.underline) {", "+\t\t\t\t\t\t\t\tint underlineY = drawY + baseline + 1;", "+\t\t\t\t\t\t\t\tOS.MoveToEx(hdc, rect.left, underlineY, 0);", "+\t\t\t\t\t\t\t\tOS.LineTo(hdc, rect.right, underlineY);", "+\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\tif (run.style.strikeout) {", "+\t\t\t\t\t\t\t\tint strikeoutY = drawRunY + run.leading + run.ascent / 2;", "+\t\t\t\t\t\t\t\tOS.MoveToEx(hdc, rect.left, strikeoutY, 0);", "+\t\t\t\t\t\t\t\tOS.LineTo(hdc, rect.right, strikeoutY);\t", "+\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\tOS.SelectObject(hdc, oldPen);", "+\t\t\t\t\t\t}", "+\tif (selPen != 0) OS.DeleteObject (selPen);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "86039d034f95a78dd5d8f9a10291660d", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/win32/org/eclipse/swt/graphics/TextLayout.java", "commitBeforeChange": "c2fae840e2c4504c79425ea45901026fd92628c1", "commitAfterChange": "3fa364044e14640667896a5a3291a209ebfed153", "methodNumberBeforeChange": 11, "methodNumberAfterChange": 11, "signatureBeforeChange": "  void drawLines(boolean advance, int graphics, int x, int y, StyleItem run, int color)", "signatureAfterChange": "  void drawLines(boolean advance, int graphics, int x, int y, StyleItem run, int color)", "diff": ["-\t\tint /*long*/ newPen = 0;", "-\t\t\tnewPen = Gdip.Pen_new(color, run.underlineThickness);", "-\t\t\tGdip.Graphics_DrawLine(graphics, newPen, x, underlineY, x + run.width, underlineY);", "+\t\t\tGdip.Graphics_FillRectangle(graphics, color, x, underlineY, run.width, run.underlineThickness);", "-\t\t\tif (newPen == 0 || run.strikeoutThickness != run.underlineThickness) {", "-\t\t\t\tif (newPen != 0) {", "-\t\t\t\t\tGdip.Pen_delete(newPen);", "-\t\t\t\t}", "-\t\t\t\tnewPen = Gdip.Pen_new(color, run.strikeoutThickness);", "-\t\t\t}", "-\t\t\tGdip.Graphics_DrawLine(graphics, newPen, x, strikeoutY, x + run.width, strikeoutY);", "+\t\t\tGdip.Graphics_FillRectangle(graphics, color, x, strikeoutY, run.width, run.strikeoutThickness);", "-\t\tGdip.Pen_delete(newPen);", "-\t\tint /*long*/ newPen = 0;", "-\t\tint /*long*/ oldPen = 0;", "+\t\tint /*long*/ brush = OS.CreateSolidBrush((int)/*64*/color);", "+\t\tRECT rect = new RECT();", "-\t\t\tnewPen = OS.CreatePen(OS.PS_SOLID, run.underlineThickness, (int)/*64*/color);", "-\t\t\toldPen = OS.SelectObject(graphics, newPen);", "-\t\t\tOS.MoveToEx(graphics, x, underlineY, 0);", "-\t\t\tOS.LineTo(graphics, x + run.width, underlineY);", "+\t\t\tOS.SetRect(rect, x, underlineY, x + run.width, underlineY + run.underlineThickness);", "+\t\t\tOS.FillRect(graphics, rect, brush);", "-\t\t\tif (newPen == 0 || run.strikeoutThickness != run.underlineThickness) {", "-\t\t\t\tif (newPen != 0) {", "-\t\t\t\t\tOS.SelectObject(graphics, oldPen);", "-\t\t\t\t\tOS.DeleteObject(newPen);", "-\t\t\t\t}", "-\t\t\t\tnewPen = OS.CreatePen(OS.PS_SOLID, run.strikeoutThickness, (int)/*64*/color);", "-\t\t\t\toldPen = OS.SelectObject(graphics, newPen);", "-\t\t\t}", "-\t\t\tOS.MoveToEx(graphics, x, strikeoutY, 0);", "-\t\t\tOS.LineTo(graphics, x + run.width, strikeoutY);\t", "+\t\t\tOS.SetRect(rect, x, strikeoutY, x + run.width, strikeoutY + run.strikeoutThickness);", "+\t\t\tOS.FillRect(graphics, rect, brush);", "-\t\tOS.SelectObject(graphics, oldPen);", "-\t\tOS.DeleteObject(newPen);", "+\t\tOS.DeleteObject(brush);"]}], "num": 32127}