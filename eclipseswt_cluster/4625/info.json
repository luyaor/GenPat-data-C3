{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "809a366ff7938dd6ed369b031877c277", "detectedBy": ["AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "518937e2aed1a559c78627e0120c7113", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/win32/org/eclipse/swt/graphics/GC.java", "commitBeforeChange": "735e9a9bdbb6a114195dba9738a0d9f8f6b1edcf", "commitAfterChange": "f098e8b179a28a23bfb0b63407491b2e68e55ba9", "methodNumberBeforeChange": 29, "methodNumberAfterChange": 29, "signatureBeforeChange": " public void drawText (String string, int x, int y, int flags)", "signatureAfterChange": " public void drawText (String string, int x, int y, int flags)", "diff": ["-\tif ((flags & SWT.DRAW_MNEMONIC) == 0) uFormat |= OS.DT_NOPREFIX;\t", "+\tif ((flags & SWT.DRAW_MNEMONIC) == 0) uFormat |= OS.DT_NOPREFIX;", "+\tint rop2 = 0;", "+\tif (OS.IsWinCE) {", "+\t\trop2 = OS.SetROP2(handle, OS.R2_COPYPEN);", "+\t\tOS.SetROP2(handle, rop2);", "+\t} else {", "+\t\trop2 = OS.GetROP2(handle);", "+\t}", "-\tOS.DrawText(handle, buffer, length, rect, uFormat);", "+\tif (rop2 != OS.R2_XORPEN) {", "+\t\tOS.DrawText(handle, buffer, length, rect, uFormat);", "+\t} else {", "+\t\tint foreground = OS.GetTextColor(handle);", "+\t\tif ((flags & SWT.DRAW_TRANSPARENT) != 0) {", "+\t\t\tOS.DrawText(handle, buffer, buffer.length(), rect, uFormat | OS.DT_CALCRECT);", "+\t\t\tint width = rect.right - rect.left;", "+\t\t\tint height = rect.bottom - rect.top;", "+\t\t\tint hBitmap = OS.CreateCompatibleBitmap(handle, width, height);", "+\t\t\tif (hBitmap == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "+\t\t\tint memDC = OS.CreateCompatibleDC(handle);", "+\t\t\tint hOldBitmap = OS.SelectObject(memDC, hBitmap);", "+\t\t\tOS.PatBlt(memDC, 0, 0, width, height, OS.BLACKNESS);", "+\t\t\tOS.SetBkMode(memDC, OS.TRANSPARENT);", "+\t\t\tOS.SetTextColor(memDC, foreground);", "+\t\t\tOS.SelectObject(memDC, OS.GetCurrentObject(handle, OS.OBJ_FONT));", "+\t\t\tOS.SetRect(rect, 0, 0, 0x7FFF, 0x7FFF);", "+\t\t\tOS.DrawText(memDC, buffer, length, rect, uFormat);", "+\t\t\tOS.BitBlt(handle, x, y, width, height, memDC, 0, 0, OS.SRCINVERT);", "+\t\t\tOS.SelectObject(memDC, hOldBitmap);", "+\t\t\tOS.DeleteDC(memDC);", "+\t\t\tOS.DeleteObject(hBitmap);", "+\t\t} else {", "+\t\t\tint background = OS.GetBkColor(handle);", "+\t\t\tOS.SetTextColor(handle, foreground ^ background);", "+\t\t\tOS.DrawText(handle, buffer, length, rect, uFormat);", "+\t\t\tOS.SetTextColor(handle, foreground);", "+\t\t}", "+\t}"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "25ff6579825a034d2735ee36778df162", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/photon/org/eclipse/swt/graphics/GC.java", "commitBeforeChange": "257d61e9439d7943ecdc8704cdc26b87077b747e", "commitAfterChange": "735e9a9bdbb6a114195dba9738a0d9f8f6b1edcf", "methodNumberBeforeChange": 26, "methodNumberAfterChange": 26, "signatureBeforeChange": " public void drawString (String string, int x, int y, boolean isTransparent)", "signatureAfterChange": " public void drawString (String string, int x, int y, boolean isTransparent)", "diff": ["-\t\tOS.PgDrawText(buffer, buffer.length, (short)x, (short)y, drawFlags);", "+\t\tif (!data.xorMode) {", "+\t\t\tOS.PgDrawText(buffer, buffer.length, (short)x, (short)y, drawFlags);", "+\t\t} else {", "+\t\t\tif (isTransparent) {", "+\t\t\t\tPhRect_t rect = new PhRect_t();", "+\t\t\t\tOS.PfExtentText(rect, null, data.font, buffer, buffer.length);", "+\t\t\t\tshort width = (short)(rect.lr_x - rect.ul_x + 1);", "+\t\t\t\tshort height = (short)(rect.lr_y - rect.ul_y + 1);", "+\t\t\t\tint image = OS.PhCreateImage(null, width, height, OS.Pg_IMAGE_DIRECT_888, 0, 0, 0);", "+\t\t\t\tPhDim_t dim = new PhDim_t();", "+\t\t\t\tdim.w = width;", "+\t\t\t\tdim.h = height;", "+\t\t\t\tPhPoint_t point = new PhPoint_t();", "+\t\t\t\tint pmMC = OS.PmMemCreateMC(image, dim, point);", "+\t\t\t\tif (pmMC == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "+\t\t\t\tint prevCont = OS.PmMemStart(pmMC);", "+\t\t\t\tOS.PgSetTextColor(data.foreground);", "+\t\t\t\tOS.PgSetFont(data.font);", "+\t\t\t\tOS.PgDrawText(buffer, buffer.length, (short)0, (short)0, drawFlags);", "+\t\t\t\tOS.PmMemFlush(pmMC, image);", "+\t\t\t\tOS.PmMemStop(pmMC);", "+\t\t\t\tOS.PhDCSetCurrent(prevCont);", "+\t\t\t\tOS.PmMemReleaseMC(pmMC);", "+\t\t\t\tpoint.x = (short)x;", "+\t\t\t\tpoint.y = (short)y;", "+\t\t\t\tPhImage_t phImage = new PhImage_t();", "+\t\t\t\tOS.memmove(phImage, image, PhImage_t.sizeof);", "+\t\t\t\tOS.PgDrawImage(phImage.image, phImage.type, point, dim, phImage.bpl, 0);", "+\t\t\t\tphImage.flags = OS.Ph_RELEASE_IMAGE_ALL;", "+\t\t\t\tOS.memmove(image, phImage, PhImage_t.sizeof);", "+\t\t\t\tOS.PhReleaseImage(image);", "+\t\t\t\tOS.free(image);", "+\t\t\t} else {", "+\t\t\t\tOS.PgSetTextXORColor(data.foreground, data.background);", "+\t\t\t\tOS.PgSetDrawMode(OS.Pg_DrawModeS);", "+\t\t\t\tOS.PgDrawText(buffer, buffer.length, (short)x, (short)y, drawFlags);", "+\t\t\t\tdirtyBits |= DIRTY_XORMODE | DIRTY_FOREGROUND;\t\t\t\t", "+\t\t\t}", "+\t\t}"]}], "num": 4625}