{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "738a32de2cbf79365b82cf52e0f140a6", "detectedBy": ["AST_HIERARCHICAL", "AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "fdfe88266b8dc62d6cad1134d155e67b", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Printing/cocoa/org/eclipse/swt/printing/Printer.java", "commitBeforeChange": "f4abd83d57d77245094f225bf96065fc437b4479", "commitAfterChange": "8ab0cb1a59e576205e88d233b12556089108ede1", "methodNumberBeforeChange": 5, "methodNumberAfterChange": 5, "signatureBeforeChange": " protected void create(DeviceData deviceData)", "signatureAfterChange": " protected void create(DeviceData deviceData)", "diff": ["+\t//TODO printing is not working. NSPrintOperation does not fit our API well", "+\t// maybe should core printing directly", "-\t", "-//\tint[] buffer = new int[1];", "-//\tif (OS.PMCreateSession(buffer) != OS.noErr) SWT.error(SWT.ERROR_NO_HANDLES);", "-//\tprintSession = buffer[0];", "-//\tif (printSession == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "-//\t\t", "-//\tif (data.otherData != null) {", "-//\t\t/* Deserialize settings */", "-//\t\tint offset = 0;", "-//\t\tbyte[] otherData = data.otherData;", "-//\t\toffset = unpackData(buffer, otherData, offset);", "-//\t\tint flatSettings = buffer[0];", "-//\t\toffset = unpackData(buffer, otherData, offset);", "-//\t\tint flatFormat = buffer[0];", "-//\t\tif (OS.PMUnflattenPrintSettings(flatSettings, buffer) != OS.noErr) SWT.error(SWT.ERROR_NO_HANDLES);", "-//\t\tprintSettings = buffer[0];", "-//\t\tif (printSettings == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "-//\t\tif (OS.PMUnflattenPageFormat(flatFormat, buffer) != OS.noErr) SWT.error(SWT.ERROR_NO_HANDLES);", "-//\t\tpageFormat = buffer[0];", "-//\t\tif (pageFormat == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "-//\t\tOS.DisposeHandle(flatSettings);", "-//\t\tOS.DisposeHandle(flatFormat);", "-//\t} else {", "-//\t\t/* Create default settings */", "-//\t\tif (OS.PMCreatePrintSettings(buffer) != OS.noErr) SWT.error(SWT.ERROR_NO_HANDLES);", "-//\t\tprintSettings = buffer[0];", "-//\t\tif (printSettings == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "-//\t\tOS.PMSessionDefaultPrintSettings(printSession, printSettings);", "-//\t\tif (OS.PMCreatePageFormat(buffer) != OS.noErr) SWT.error(SWT.ERROR_NO_HANDLES);", "-//\t\tpageFormat = buffer[0];", "-//\t\tif (pageFormat == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "-//\t\tOS.PMSessionDefaultPageFormat(printSession, pageFormat);", "-//\t}", "-//\t", "-//\tif (PREVIEW_DRIVER.equals(data.driver)) {", "-//\t\tOS.PMSessionSetDestination(printSession, printSettings, (short) OS.kPMDestinationPreview, 0, 0);", "-//\t}", "-//\tString name = data.name;", "-//\tchar[] buffer1 = new char[name.length ()];", "-//\tname.getChars(0, buffer1.length, buffer1, 0);", "-//\tint ptr = OS.CFStringCreateWithCharacters(OS.kCFAllocatorDefault, buffer1, buffer1.length);", "-//\tif (ptr != 0) {", "-//\t\tOS.PMSessionSetCurrentPrinter(printSession, ptr); ", "-//\t\tOS.CFRelease(ptr);", "-//\t}", "-//\t", "-//\tOS.PMSessionValidatePrintSettings(printSession, printSettings, null);", "-//\tOS.PMSessionValidatePageFormat(printSession, pageFormat, null);\t", "-//\t", "-//\tint graphicsContextsArray = OS.CFArrayCreateMutable(OS.kCFAllocatorDefault, 1, 0);", "-//\tif (graphicsContextsArray != 0) {", "-//\t\tOS.CFArrayAppendValue(graphicsContextsArray, OS.kPMGraphicsContextCoreGraphics());", "-//\t\tOS.PMSessionSetDocumentFormatGeneration(printSession, OS.kPMDocumentFormatPDF(), graphicsContextsArray, 0);", "-//\t\tOS.CFRelease(graphicsContextsArray);", "-//\t}", "+\tif (data.otherData != null) {", "+\t\tNSData nsData = NSData.dataWithBytes(data.otherData, data.otherData.length);", "+\t\tprintInfo = new NSPrintInfo(NSKeyedUnarchiver.unarchiveObjectWithData(nsData).id);", "+\t} else {", "+\t\tprintInfo = NSPrintInfo.sharedPrintInfo();", "+\t}", "+\tprintInfo.retain();", "+\tprintInfo.setPrinter(printer);", "+\twindow = (NSWindow)new NSWindow().alloc();", "+\twindow.initWithContentRect_styleMask_backing_defer_(printInfo.imageablePageBounds(), OS.NSBorderlessWindowMask, OS.NSBackingStoreBuffered, false);", "+\tview = (NSView)new NSView().alloc();", "+\tview.initWithFrame(new NSRect());", "+\twindow.setContentView(view);", "+\toperation = NSPrintOperation.static_printOperationWithView_printInfo_(view, printInfo);", "+//\toperation = NSPrintOperation.static_PDFOperationWithView_insideRect_toPath_printInfo_(view, printInfo.imageablePageBounds(), NSString.stringWith(\"/Users/silenioquarti/Desktop/u.pdf\"), printInfo);", "+\toperation.retain();", "+\toperation.setShowsPrintPanel(false);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "ac497127809646c3263728b8386fc099", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/cocoa/org/eclipse/swt/widgets/ToolItem.java", "commitBeforeChange": "0279ac89ad933bec67322b956321e83b2a1ac93a", "commitAfterChange": "dbc3f579c8454ac59e01ac2d56752eda0d58b6cd", "methodNumberBeforeChange": 12, "methodNumberAfterChange": 12, "signatureBeforeChange": "  void createHandle ()", "signatureAfterChange": "  void createHandle ()", "diff": ["+\tif (parent.nsToolbar != null) {", "+\t\tid = NSString.stringWith(String.valueOf(ToolBar.NEXT_ID++));", "+\t\tid.retain();", "+\t\tnsItem = ((NSToolbarItem)new NSToolbarItem().alloc()).initWithItemIdentifier(id);", "+\t\tnsItem.setAction(OS.sel_sendSelection);", "+\t\tnsMenuRep = ((NSMenuItem)new SWTMenuItem().alloc()).initWithTitle(NSString.string(), OS.sel_sendSelection, NSString.string());", "+\t\tnsItem.setMenuFormRepresentation(nsMenuRep);", "+\t} ", "+", "-\t\tNSBox widget = (NSBox)new SWTBox().alloc();", "-\t\twidget.init();", "-\t\twidget.setBoxType(OS.NSBoxSeparator);", "-\t\twidget.setBorderWidth(0);", "-\t\tview = widget;", "+\t\tif (parent.nsToolbar != null) {", "+\t\t\tview = (NSView)new SWTView().alloc();", "+\t\t\tview.init();", "+\t\t} else {", "+\t\t\tNSBox widget = (NSBox)new SWTBox().alloc();", "+\t\t\twidget.init();", "+\t\t\twidget.setBoxType(OS.NSBoxSeparator);", "+\t\t\twidget.setBorderWidth(0);", "+\t\t\tview = widget;", "+\t\t}", "+\t\tif (parent.nsToolbar != null) {", "+\t\t\tcell.setHighlightsBy(OS.NSContentsCellMask);", "+\t\t\tcell.setBackgroundStyle(OS.NSBackgroundStyleRaised);", "+\t\t}", "+\t\tif (nsMenuRep != null) nsMenuRep.setTarget(button);"]}], "num": 57244}