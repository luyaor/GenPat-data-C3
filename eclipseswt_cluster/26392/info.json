{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "98ab751e509f3db66911b87ff8b5bbf3", "detectedBy": ["DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "230b60af677b84963d4fed1dbdecb314", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Drag and Drop/win32/org/eclipse/swt/dnd/RTFTransfer.java", "commitBeforeChange": "74553fa6850361f786837718de64643b391519f8", "commitAfterChange": "bf33a068cd8d34feb66b3cb1cbaacdbe09b72620", "methodNumberBeforeChange": 2, "methodNumberAfterChange": 2, "signatureBeforeChange": " public void javaToNative (Object object, TransferData transferData)", "signatureAfterChange": " public void javaToNative (Object object, TransferData transferData)", "diff": ["-\tif (object == null || !(object instanceof String)) {", "-\t\ttransferData.result = COM.E_FAIL;", "+\ttransferData.result = COM.E_FAIL;", "+\tif (object == null || !(object instanceof String)) return;", "+\tif (!isSupportedType(transferData)) {", "+\t\t// did not match the TYMED", "+\t\ttransferData.stgmedium = new STGMEDIUM();", "+\t\ttransferData.result = COM.DV_E_TYMED;", "-\tif (isSupportedType(transferData)) {", "-\t\tString string = (String)object;", "-\t\tint count = string.length ();", "-\t\tchar [] buffer = new char [count + 1];", "-\t\tstring.getChars (0, count, buffer, 0);", "-\t\tint cchMultiByte = OS.WideCharToMultiByte (CodePage, 0, buffer, -1, null, 0, null, null);", "-\t\tif (cchMultiByte == 0) {", "-\t\t\ttransferData.stgmedium = new STGMEDIUM();", "-\t\t\ttransferData.result = COM.DV_E_STGMEDIUM;", "-\t\t\treturn;", "-\t\t}", "-\t\tint lpMultiByteStr = COM.GlobalAlloc(COM.GMEM_FIXED | COM.GMEM_ZEROINIT, cchMultiByte);", "-\t\tOS.WideCharToMultiByte (CodePage, 0, buffer, -1, lpMultiByteStr, cchMultiByte, null, null);", "+\tString string = (String)object;", "+\tint count = string.length();", "+\tif (count == 0) return;", "+\tchar[] chars = new char[count + 1];", "+\tstring.getChars(0, count, chars, 0);", "+\tint cchMultiByte = COM.WideCharToMultiByte(CodePage, 0, chars, -1, null, 0, null, null);", "+\tif (cchMultiByte == 0) {", "-\t\ttransferData.stgmedium.tymed = COM.TYMED_HGLOBAL;", "-\t\ttransferData.stgmedium.unionField = lpMultiByteStr;", "-\t\ttransferData.stgmedium.pUnkForRelease = 0;", "-\t\ttransferData.result = COM.S_OK;", "+\t\ttransferData.result = COM.DV_E_STGMEDIUM;", "-\t", "-\t// did not match the TYMED", "+\tint lpMultiByteStr = COM.GlobalAlloc(COM.GMEM_FIXED | COM.GMEM_ZEROINIT, cchMultiByte);", "+\tCOM.WideCharToMultiByte(CodePage, 0, chars, -1, lpMultiByteStr, cchMultiByte, null, null);", "-\ttransferData.result = COM.DV_E_TYMED;", "+\ttransferData.stgmedium.tymed = COM.TYMED_HGLOBAL;", "+\ttransferData.stgmedium.unionField = lpMultiByteStr;", "+\ttransferData.stgmedium.pUnkForRelease = 0;", "+\ttransferData.result = COM.S_OK;", "+\treturn;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "1d948965147b490e5d3e27f744b14bf4", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Drag and Drop/win32/org/eclipse/swt/dnd/TextTransfer.java", "commitBeforeChange": "74553fa6850361f786837718de64643b391519f8", "commitAfterChange": "bf33a068cd8d34feb66b3cb1cbaacdbe09b72620", "methodNumberBeforeChange": 2, "methodNumberAfterChange": 2, "signatureBeforeChange": " public void javaToNative (Object object, TransferData transferData)", "signatureAfterChange": " public void javaToNative (Object object, TransferData transferData)", "diff": ["-\tif (object == null || !(object instanceof String)) {", "-\t\ttransferData.result = COM.E_FAIL;", "-\t\treturn;", "-\t}", "-\t", "-\tif (isSupportedType(transferData)) {", "-\t\tTCHAR buffer = new TCHAR(0, (String)object, true);", "-\t\tint byteCount = buffer.length() * TCHAR.sizeof;", "-\t\tint newPtr = COM.GlobalAlloc(COM.GMEM_FIXED | COM.GMEM_ZEROINIT, byteCount);", "-\t\tCOM.MoveMemory(newPtr, buffer, byteCount);", "-\t\t", "+\ttransferData.result = COM.E_FAIL;", "+\tif (object == null || !(object instanceof String)) return;", "+\tif (!isSupportedType(transferData)) {", "+\t\t// did not match the TYMED", "-\t\ttransferData.stgmedium.tymed = COM.TYMED_HGLOBAL;", "-\t\ttransferData.stgmedium.unionField = newPtr;", "-\t\ttransferData.stgmedium.pUnkForRelease = 0;", "-\t\ttransferData.result = COM.S_OK;", "+\t\ttransferData.result = COM.DV_E_TYMED;", "-\t", "-\t// did not match the TYMED", "-\ttransferData.stgmedium = new STGMEDIUM();", "-\ttransferData.result = COM.DV_E_TYMED;", "-\t", "+\tswitch (transferData.type) {", "+\t\tcase COM.CF_UNICODETEXT: {", "+\t\t\tTCHAR buffer = new TCHAR(0, (String)object, true);", "+\t\t\tint byteCount = buffer.length() * TCHAR.sizeof;", "+\t\t\tint newPtr = COM.GlobalAlloc(COM.GMEM_FIXED | COM.GMEM_ZEROINIT, byteCount);", "+\t\t\tCOM.MoveMemory(newPtr, buffer, byteCount);\t", "+\t\t\ttransferData.stgmedium = new STGMEDIUM();", "+\t\t\ttransferData.stgmedium.tymed = COM.TYMED_HGLOBAL;", "+\t\t\ttransferData.stgmedium.unionField = newPtr;", "+\t\t\ttransferData.stgmedium.pUnkForRelease = 0;", "+\t\t\ttransferData.result = COM.S_OK;", "+\t\t\tbreak;", "+\t\t}", "+\t\tcase COM.CF_TEXT: {", "+\t\t\tString string = (String)object;", "+\t\t\tint count = string.length();", "+\t\t\tif (count == 0) return;", "+\t\t\tchar[] chars = new char[count + 1];", "+\t\t\tstring.getChars(0, count, chars, 0);", "+\t\t\tint cchMultiByte = COM.WideCharToMultiByte(CodePage, 0, chars, -1, null, 0, null, null);", "+\t\t\tif (cchMultiByte == 0) {", "+\t\t\t\ttransferData.stgmedium = new STGMEDIUM();", "+\t\t\t\ttransferData.result = COM.DV_E_STGMEDIUM;", "+\t\t\t\treturn;", "+\t\t\t}", "+\t\t\tint lpMultiByteStr = COM.GlobalAlloc(COM.GMEM_FIXED | COM.GMEM_ZEROINIT, cchMultiByte);", "+\t\t\tCOM.WideCharToMultiByte(CodePage, 0, chars, -1, lpMultiByteStr, cchMultiByte, null, null);", "+\t\t\ttransferData.stgmedium = new STGMEDIUM();", "+\t\t\ttransferData.stgmedium.tymed = COM.TYMED_HGLOBAL;", "+\t\t\ttransferData.stgmedium.unionField = lpMultiByteStr;", "+\t\t\ttransferData.stgmedium.pUnkForRelease = 0;", "+\t\t\ttransferData.result = COM.S_OK;", "+\t\t\tbreak;", "+\t\t}", "+\t}", "+\treturn;"]}], "num": 26392}