{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "339077c49ac841966c4d2c0447b3152e", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "e0e6ad6115027ca9a40fd050e4f7458c", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/win32/org/eclipse/swt/graphics/TextLayout.java", "commitBeforeChange": "87c0fbdc76442698239433834ac5c24b8702e015", "commitAfterChange": "1abca3de880ca8fa3712038f321ffb3a0803dd38", "methodNumberBeforeChange": 47, "methodNumberAfterChange": 47, "signatureBeforeChange": " public int getOffset (int x, int y, int[] trailing)", "signatureAfterChange": " public int getOffset (int x, int y, int[] trailing)", "diff": ["-\t\t\tif (trailing != null) trailing[0] = piTrailing[0];", "-\t\t\treturn untranslateOffset(run.start + piCP[0]);", "+\t\t\tint offset = run.start + piCP[0];", "+\t\t\tchar ch = segmentsText.charAt(offset);", "+\t\t\tint length = segmentsText.length();", "+\t\t\tif (0xD800 <= ch && ch <= 0xDBFF) {", "+\t\t\t\tif (offset + 1 < length) {", "+\t\t\t\t\tch = segmentsText.charAt(offset + 1);", "+\t\t\t\t\tif (0xDC00 <= ch && ch <= 0xDFFF) {", "+\t\t\t\t\t\tif (trailing != null) trailing[0] = 0;", "+\t\t\t\t\t}", "+\t\t\t\t}", "+\t\t\t} else if (0xDC00 <= ch && ch <= 0xDFFF) {", "+\t\t\t\tif (offset - 1 >= 0) {", "+\t\t\t\t\tch = segmentsText.charAt(offset - 1);", "+\t\t\t\t\tif (0xD800 <= ch && ch <= 0xDBFF) {", "+\t\t\t\t\t\toffset--;", "+\t\t\t\t\t\tif (trailing != null) trailing[0] = 2;", "+\t\t\t\t\t}", "+\t\t\t\t}", "+\t\t\t} else {", "+\t\t\t\tif (trailing != null) trailing[0] = piTrailing[0];", "+\t\t\t}", "+\t\t\treturn untranslateOffset(offset);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "99f562fa19c4bcd00e4206394754772a", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/cocoa/org/eclipse/swt/graphics/TextLayout.java", "commitBeforeChange": "1abca3de880ca8fa3712038f321ffb3a0803dd38", "commitAfterChange": "1fcdb5569a20cdd8ecab2986180db47c5142ee2d", "methodNumberBeforeChange": 27, "methodNumberAfterChange": 27, "signatureBeforeChange": "  int _getOffset (int offset, int movement, boolean forward)", "signatureAfterChange": "  int _getOffset (int offset, int movement, boolean forward)", "diff": ["-\tif (length == 0) return 0;", "+\tif (forward && offset == length) return length;", "+\tif (!forward && offset == 0) return 0;", "+\tint step = forward ? 1 : -1;", "+\tif ((movement & SWT.MOVEMENT_CHAR) != 0) return offset + step;", "-\t\tcase SWT.MOVEMENT_CLUSTER://TODO cluster", "-\t\tcase SWT.MOVEMENT_CHAR: {", "-\t\t\t\tif (forward) {", "-\t\t\t\t\tif (offset < length) offset++;", "-\t\t\t\t} else {", "-\t\t\t\t\tif (offset > 0) offset--;", "+\t\tcase SWT.MOVEMENT_CLUSTER:", "+\t\t\t//TODO cluster", "+\t\t\toffset += step;", "+\t\t\tif (0 <= offset && offset < length) {", "+\t\t\t\tchar ch = text.charAt(offset);", "+\t\t\t\tif (0xDC00 <= ch && ch <= 0xDFFF) {", "+\t\t\t\t\tif (offset > 0) {", "+\t\t\t\t\t\tch = text.charAt(offset - 1);", "+\t\t\t\t\t\tif (0xD800 <= ch && ch <= 0xDBFF) {", "+\t\t\t\t\t\t\toffset += step;", "+\t\t\t\t\t\t}", "+\t\t\t\t\t}", "-\t\t\t\treturn offset;", "-\t\t}", "+\t\t\t}", "+\t\t\tbreak;"]}], "num": 62460}