{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "bb2ff0e3c899dea6db3d83d612ff2e86", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "d3ce95bd49f6af9d9fe6c5ac88527c67", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/carbon/org/eclipse/swt/graphics/Cursor.java", "commitBeforeChange": "5257fe3e5c2382bbc3b51c5d746acb8fd1eb464e", "commitAfterChange": "be37fa819811929900e5dcf4ba355cc550991316", "methodNumberBeforeChange": 3, "methodNumberAfterChange": 4, "signatureBeforeChange": " public Cursor(Device device, ImageData source, int hotspotX, int hotspotY)", "signatureAfterChange": " public Cursor(Device device, ImageData source, int hotspotX, int hotspotY)", "diff": ["+", "+\tif (OS.VERSION >= 0x1040) {", "+\t\tbyte[] data = new byte[source.width * source.height * 4];", "+\t\tPaletteData palette = source.palette;", "+\t\tif (palette.isDirect) {", "+\t\t\tImageData.blit(ImageData.BLIT_SRC,", "+\t\t\t\tsource.data, source.depth, source.bytesPerLine, source.getByteOrder(), 0, 0, source.width, source.height, palette.redMask, palette.greenMask, palette.blueMask,", "+\t\t\t\tImageData.ALPHA_OPAQUE, null, 0, 0, 0, ", "+\t\t\t\tdata, 32, source.width * 4, ImageData.MSB_FIRST, 0, 0, source.width, source.height, 0xFF0000, 0xFF00, 0xFF,", "+\t\t\t\tfalse, false);", "+\t\t} else {", "+\t\t\tRGB[] rgbs = palette.getRGBs();", "+\t\t\tint length = rgbs.length;", "+\t\t\tbyte[] srcReds = new byte[length];", "+\t\t\tbyte[] srcGreens = new byte[length];", "+\t\t\tbyte[] srcBlues = new byte[length];", "+\t\t\tfor (int i = 0; i < rgbs.length; i++) {", "+\t\t\t\tRGB rgb = rgbs[i];", "+\t\t\t\tif (rgb == null) continue;", "+\t\t\t\tsrcReds[i] = (byte)rgb.red;", "+\t\t\t\tsrcGreens[i] = (byte)rgb.green;", "+\t\t\t\tsrcBlues[i] = (byte)rgb.blue;", "+\t\t\t}", "+\t\t\tImageData.blit(ImageData.BLIT_SRC,", "+\t\t\t\tsource.data, source.depth, source.bytesPerLine, source.getByteOrder(), 0, 0, source.width, source.height, srcReds, srcGreens, srcBlues,", "+\t\t\t\tImageData.ALPHA_OPAQUE, null, 0, 0, 0,", "+\t\t\t\tdata, 32, source.width * 4, ImageData.MSB_FIRST, 0, 0, source.width, source.height, 0xFF0000, 0xFF00, 0xFF,", "+\t\t\t\tfalse, false);", "+\t\t}", "+\t\tif (source.maskData != null || source.transparentPixel != -1) {", "+\t\t\tImageData mask = source.getTransparencyMask();", "+\t\t\tbyte[] maskData = mask.data;", "+\t\t\tint maskBpl = mask.bytesPerLine;", "+\t\t\tint offset = 0, maskOffset = 0;", "+\t\t\tfor (int y = 0; y<source.height; y++) {", "+\t\t\t\tfor (int x = 0; x<source.width; x++) {", "+\t\t\t\t\tdata[offset] = ((maskData[maskOffset + (x >> 3)]) & (1 << (7 - (x & 0x7)))) != 0 ? (byte)0xff : 0;", "+\t\t\t\t\toffset += 4;", "+\t\t\t\t}", "+\t\t\t\tmaskOffset += maskBpl;", "+\t\t\t}", "+\t\t} else if (source.alpha != -1) {", "+\t\t\tbyte alpha = (byte)source.alpha;", "+\t\t\tfor (int i=0; i<data.length; i+=4) {", "+\t\t\t\tdata[i] = alpha;\t\t\t\t", "+\t\t\t}", "+\t\t} else if (source.alphaData != null) {", "+\t\t\tbyte[] alphaData = source.alphaData;", "+\t\t\tfor (int i=0; i<data.length; i+=4) {", "+\t\t\t\tdata[i] = alphaData[i/4];", "+\t\t\t}", "+\t\t}", "+\t\tcreateNSCursor(device, hotspotX, hotspotY, data, source.width, source.height);", "+\t\treturn;", "+\t}", "+"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "11eda6aec66d181ea1fd9fdaeb5f54a3", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/win32/org/eclipse/swt/graphics/Cursor.java", "commitBeforeChange": "21adea3406a745f3b5dd9a42716b4efd0fc29227", "commitAfterChange": "845cd3662a4fd50dc772f1cb398e102a7c633b87", "methodNumberBeforeChange": 3, "methodNumberAfterChange": 3, "signatureBeforeChange": " public Cursor(Device device, ImageData source, int hotspotX, int hotspotY)", "signatureAfterChange": " public Cursor(Device device, ImageData source, int hotspotX, int hotspotY)", "diff": ["-\tImageData mask = source.getTransparencyMask();", "-\tint /*long*/ [] result = Image.init(this.device, null, source, mask);", "-\tint /*long*/ hBitmap = result[0];", "-\tint /*long*/ hMask = result[1];", "+\tint /*long*/ hBitmap = 0;", "+\tint /*long*/ hMask = 0;", "+\tif (source.maskData == null && source.transparentPixel == -1 && (source.alpha != -1 || source.alphaData != null)) {", "+\t\tPaletteData palette = source.palette;", "+\t\tPaletteData newPalette = new PaletteData(0xFF00, 0xFF0000, 0xFF000000);", "+\t\tImageData img = new ImageData(source.width, source.height, 32, newPalette);", "+\t\tif (palette.isDirect) {", "+\t\t\tImageData.blit(ImageData.BLIT_SRC, ", "+\t\t\t\tsource.data, source.depth, source.bytesPerLine, source.getByteOrder(), 0, 0, source.width, source.height, palette.redMask, palette.greenMask, palette.blueMask,", "+\t\t\t\tImageData.ALPHA_OPAQUE, null, 0, 0, 0,", "+\t\t\t\timg.data, img.depth, img.bytesPerLine, img.getByteOrder(), 0, 0, img.width, img.height, newPalette.redMask, newPalette.greenMask, newPalette.blueMask,", "+\t\t\t\tfalse, false);", "+\t\t} else {", "+\t\t\tRGB[] rgbs = palette.getRGBs();", "+\t\t\tint length = rgbs.length;", "+\t\t\tbyte[] srcReds = new byte[length];", "+\t\t\tbyte[] srcGreens = new byte[length];", "+\t\t\tbyte[] srcBlues = new byte[length];", "+\t\t\tfor (int i = 0; i < rgbs.length; i++) {", "+\t\t\t\tRGB rgb = rgbs[i];", "+\t\t\t\tif (rgb == null) continue;", "+\t\t\t\tsrcReds[i] = (byte)rgb.red;", "+\t\t\t\tsrcGreens[i] = (byte)rgb.green;", "+\t\t\t\tsrcBlues[i] = (byte)rgb.blue;", "+\t\t\t}", "+\t\t\tImageData.blit(ImageData.BLIT_SRC,", "+\t\t\t\tsource.data, source.depth, source.bytesPerLine, source.getByteOrder(), 0, 0, source.width, source.height, srcReds, srcGreens, srcBlues,", "+\t\t\t\tImageData.ALPHA_OPAQUE, null, 0, 0, 0,", "+\t\t\t\timg.data, img.depth, img.bytesPerLine, img.getByteOrder(), 0, 0, img.width, img.height, newPalette.redMask, newPalette.greenMask, newPalette.blueMask,", "+\t\t\t\tfalse, false);", "+\t\t}", "+\t\thBitmap = Image.createDIB(source.width, source.height, 32);", "+\t\tif (hBitmap == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "+\t\tBITMAP dibBM = new BITMAP();", "+\t\tOS.GetObject(hBitmap, BITMAP.sizeof, dibBM);", "+\t\tbyte[] srcData = img.data;", "+\t\tif (source.alpha != -1) {", "+\t\t\tfor (int i = 3, ap=0; i < srcData.length; i+=4, ap++) {", "+\t\t\t\tsrcData[i] = (byte)source.alpha;", "+\t\t\t}", "+\t\t} else if (source.alphaData != null) {", "+\t\t\tfor (int sp = 3, ap=0; sp < srcData.length; sp+=4, ap++) {", "+\t\t\t\tsrcData[sp] = source.alphaData[ap];", "+\t\t\t}", "+\t\t}", "+\t\tOS.MoveMemory(dibBM.bmBits, srcData, srcData.length);", "+\t\thMask = OS.CreateBitmap(source.width, source.height, 1, 1, new byte[(((source.width + 7) / 8) + 3) / 4 * 4 * source.height]);", "+\t\tif (hMask == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "+\t} else {", "+\t\tImageData mask = source.getTransparencyMask();", "+\t\tint /*long*/ [] result = Image.init(this.device, null, source, mask);", "+\t\thBitmap = result[0];", "+\t\thMask = result[1];", "+\t}", "-\tif (handle == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "+\tif (handle == 0) SWT.error(SWT.ERROR_NO_HANDLES);"]}], "num": 44616}