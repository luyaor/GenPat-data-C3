{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "faf6cf6cb18dcd0fe359c4957164fbd0", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "9dbbba17a93441e8ccef56471e58f450", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Custom Widgets/common/org/eclipse/swt/custom/StyledText.java", "commitBeforeChange": "635a9e5d0a5f495ec272194dbb750eddc745876f", "commitAfterChange": "e83d77b7ddccf5500d06ea30a64ce0d090ac4b10", "methodNumberBeforeChange": 203, "methodNumberAfterChange": 53, "signatureBeforeChange": " public Point computeSize (int wHint, int hHint, boolean changed)", "signatureAfterChange": " public Point computeSize (int wHint, int hHint, boolean changed)", "diff": ["-\tint count, width, height;", "-\t", "-\tif (singleLine) {", "-\t\tcount = 1;", "-\t} else {", "-\t\tcount = content.getLineCount();", "-\t}", "-\tif (wHint != SWT.DEFAULT) {", "-\t\twidth = wHint;", "-\t} ", "-\telse {", "-\t\twidth = DEFAULT_WIDTH;", "-\t}", "-\tif (wHint == SWT.DEFAULT) {", "-\t\tLineCache computeLineCache = lineCache;", "-\t\tif (wordWrap) {", "-\t\t\t// set non-wrapping content width calculator. Ensures ideal line width ", "-\t\t\t// that does not required wrapping. Fixes bug 31195.", "-\t\t\tcomputeLineCache = new ContentWidthCache(this, logicalContent);", "-\t\t\tif (!singleLine) {", "-\t\t\t\tcount = logicalContent.getLineCount();", "+\tint lineCount = singleLine ? 1 : content.getLineCount();", "+\tint width = 0;", "+\tint height = 0;", "+\tif (wHint == SWT.DEFAULT || hHint == SWT.DEFAULT) {", "+\t\tDisplay display = getDisplay();", "+\t\tint maxHeight = display.getClientArea().height;", "+\t\tint lineIndex = 0;", "+\t\twhile (lineIndex < lineCount && height < maxHeight) {", "+\t\t\tTextLayout layout = renderer.getTextLayout(lineIndex);", "+\t\t\tif (wordWrap) {", "+\t\t\t\tlayout.setWidth(wHint);", "+\t\t\tRectangle rect = layout.getBounds();", "+\t\t\theight += rect.height;", "+\t\t\twidth = Math.max(width, rect.width);", "+\t\t\trenderer.disposeTextLayout(layout);", "+\t\t\tlineIndex++;", "-\t\t// Only calculate what can actually be displayed.", "-\t\t// Do this because measuring each text line is a ", "-\t\t// time-consuming process.", "-\t\tint visibleCount = Math.min (count, getDisplay().getBounds().height / lineHeight);", "-\t\tcomputeLineCache.calculate(0, visibleCount);", "-\t\twidth = computeLineCache.getWidth() + leftMargin + rightMargin;", "-\t}", "-\telse", "-\tif (wordWrap && !singleLine) {", "-\t\t// calculate to wrap to width hint. Fixes bug 20377. ", "-\t\t// don't wrap live content. Fixes bug 38344.", "-\t\tWrappedContent wrappedContent = new WrappedContent(renderer, logicalContent);", "-\t\twrappedContent.wrapLines(width);", "-\t\tcount = wrappedContent.getLineCount();", "-\t}", "-\tif (hHint != SWT.DEFAULT) {", "-\t\theight = hHint;", "-\t} ", "-\telse {", "-\t\theight = count * lineHeight + topMargin + bottomMargin;", "-\tif (width == 0) {", "-\t\twidth = DEFAULT_WIDTH;", "-\t}", "-\tif (height == 0) {", "-\t\tif (singleLine) {", "-\t\t\theight = lineHeight;", "-\t\t}", "-\t\telse {", "-\t\t\theight = DEFAULT_HEIGHT;", "-\t\t}", "-\t}", "-\tRectangle rect = computeTrim(0, 0, width, height);", "+\tif (width == 0) width = DEFAULT_WIDTH;", "+\tif (height == 0) height = DEFAULT_HEIGHT;", "+\tif (wHint != SWT.DEFAULT) width = wHint;", "+\tif (hHint != SWT.DEFAULT) height = hHint;", "+\tint wTrim = leftMargin + rightMargin + getCaretWidth();", "+\tint hTrim = topMargin + bottomMargin;", "+\tRectangle rect = computeTrim(0, 0, width + wTrim, height + hTrim);"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "9401cc7b8ffc8fa2f6ea1d06fed30b0a", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Custom Widgets/common/org/eclipse/swt/custom/StyledText2.java", "commitBeforeChange": "1a6a47fd4cb07a565544aa8caf7003382a6b00f3", "commitAfterChange": "375107332fc5402c59bbea222825730a86b9abf8", "methodNumberBeforeChange": 68, "methodNumberAfterChange": 68, "signatureBeforeChange": " public Point computeSize (int wHint, int hHint, boolean changed)", "signatureAfterChange": " public Point computeSize (int wHint, int hHint, boolean changed)", "diff": ["-\tint count = singleLine ? 1 : content.getLineCount();", "-\tint width = wHint;", "-\t//TODO rewrite computeSize", "-\tif (wHint == SWT.DEFAULT) {", "-//\t\tLineCache computeLineCache = lineCache;", "-//\t\tif (wordWrap) {", "-//\t\t\t// set non-wrapping content width calculator. Ensures ideal line width ", "-//\t\t\t// that does not required wrapping. Fixes bug 31195.", "-//\t\t\tcomputeLineCache = new ContentWidthCache(this, logicalContent);", "-//\t\t\tif (!singleLine) {", "-//\t\t\t\tcount = logicalContent.getLineCount();", "-//\t\t\t}", "-//\t\t}", "-//\t\t// Only calculate what can actually be displayed.", "-//\t\t// Do this because measuring each text line is a ", "-//\t\t// time-consuming process.", "-//\t\tint visibleCount = Math.min (count, getDisplay().getBounds().height / lineHeight);", "-//\t\tcomputeLineCache.calculate(0, visibleCount);", "-//\t\twidth = computeLineCache.getWidth() + leftMargin + rightMargin;", "-//\t} else if (wordWrap && !singleLine) {", "-//\t\t// calculate to wrap to width hint. Fixes bug 20377. ", "-//\t\t// don't wrap live content. Fixes bug 38344.", "-//\t\tWrappedContent2 wrappedContent = new WrappedContent2(renderer, logicalContent);", "-//\t\twrappedContent.wrapLines(width);", "-//\t\tcount = wrappedContent.getLineCount();", "-\t}", "-\tint height;", "-\tif (hHint != SWT.DEFAULT) {", "-\t\theight = hHint;", "-\t} else {", "-\t\theight = count * lineHeight + topMargin + bottomMargin;", "+\tint lineCount = singleLine ? 1 : content.getLineCount();", "+\tint width = 0;", "+\tint height = 0;", "+\tif (wHint == SWT.DEFAULT || hHint == SWT.DEFAULT) {", "+\t\tDisplay display = getDisplay();", "+\t\tint maxHeight = display.getClientArea().height;", "+\t\tint lineIndex = 0;", "+\t\twhile (lineIndex < lineCount && height < maxHeight) {", "+\t\t\tint lineOffset = content.getOffsetAtLine(lineIndex);", "+\t\t\tString line = content.getLine(lineIndex);", "+\t\t\tTextLayout layout = renderer.getTextLayout(line, lineOffset);", "+\t\t\tif (wordWrap) {", "+\t\t\t\tlayout.setWidth(wHint);", "+\t\t\t}", "+\t\t\tRectangle rect = layout.getBounds();", "+\t\t\theight += rect.height;", "+\t\t\twidth = Math.max(width, rect.width);", "+\t\t\trenderer.disposeTextLayout(layout);", "+\t\t\tlineIndex++;", "+\t\t}", "-\tif (width == 0)\twidth = DEFAULT_WIDTH;", "-\tif (height == 0) height = singleLine ? lineHeight : DEFAULT_HEIGHT;", "-\tRectangle rect = computeTrim(0, 0, width, height);", "+\tif (width == 0) width = DEFAULT_WIDTH;", "+\tif (height == 0) height = DEFAULT_HEIGHT;", "+\tif (wHint != SWT.DEFAULT) width = wHint;", "+\tif (hHint != SWT.DEFAULT) height = hHint;", "+\tint wTrim = leftMargin + rightMargin + getCaretWidth();", "+\tint hTrim = topMargin + bottomMargin;", "+\tRectangle rect = computeTrim(0, 0, width + wTrim, height + hTrim);"]}], "num": 16566}