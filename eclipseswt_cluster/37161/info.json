{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "5023b2e45529af0cb790a55c851366a2", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "7848a185036cafd5dc4ad852d65b5445", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Custom Widgets/common/org/eclipse/swt/custom/CTabFolder.java", "commitBeforeChange": "13c9e3869b0e39928c07f59c6669533020de611a", "commitAfterChange": "5a18b227e248dbcd7e352f9c9d08f49d1696ab1c", "methodNumberBeforeChange": 88, "methodNumberAfterChange": 88, "signatureBeforeChange": " boolean setItemSize()", "signatureAfterChange": " boolean setItemSize()", "diff": ["-\tint[] widths = new int[items.length];", "-\twidths = new int[items.length];", "+\tif (items.length == 0) return changed;", "+", "+\tint[] widths;", "-\tfor (int i = 0; i < items.length; i++) {", "-\t\twidths[i] = items[i].preferredWidth(gc, i == selectedIndex, false);", "-\t}\t", "-\tif (items.length > 0) {", "-\t\tint totalWidth = 0;", "-\t\tint tabAreaWidth = size.x - borderLeft - borderRight - 3;", "-\t\tif (showMin) tabAreaWidth -= BUTTON_SIZE;", "-\t\tif (showMax) tabAreaWidth -= BUTTON_SIZE;", "-\t\tif (topRightAlignment == SWT.RIGHT && topRight != null) {", "-\t\t\tPoint rightSize = topRight.computeSize(SWT.DEFAULT, SWT.DEFAULT, false);", "-\t\t\ttabAreaWidth -= rightSize.x + 3;", "+\tint tabAreaWidth = size.x - borderLeft - borderRight - 3;", "+\tif (showMin) tabAreaWidth -= BUTTON_SIZE;", "+\tif (showMax) tabAreaWidth -= BUTTON_SIZE;", "+\tif (topRightAlignment == SWT.RIGHT && topRight != null) {", "+\t\tPoint rightSize = topRight.computeSize(SWT.DEFAULT, SWT.DEFAULT, false);", "+\t\ttabAreaWidth -= rightSize.x + 3;", "+\t}", "+\tif (!simple) tabAreaWidth -= curveWidth - 2*curveIndent;", "+\ttabAreaWidth = Math.max(0, tabAreaWidth);", "+\t", "+\t// First, try the minimum tab size at full compression.", "+\tint minWidth = 0;", "+\tint[] minWidths = new int[items.length];\t", "+\tfor (int i = 0; i < minWidths.length; i++) {", "+\t\tminWidths[i] = items[i].preferredWidth(gc, i == selectedIndex, true);", "+\t\tminWidth += minWidths[i];", "+\t}", "+\tif (minWidth > tabAreaWidth) {", "+\t\t// full compression required and a chevron", "+\t\tshowChevron = items.length > 1;", "+\t\tif (showChevron) tabAreaWidth -= 3*BUTTON_SIZE/2;", "+\t\twidths = minWidths;", "+\t\tint index = selectedIndex != -1 ? selectedIndex : 0;", "+\t\tif (tabAreaWidth < widths[index]) {", "+\t\t\twidths[index] = Math.max(0, tabAreaWidth);", "-\t\tif (!simple) tabAreaWidth -= curveWidth - 2*curveIndent;", "-\t\ttabAreaWidth = Math.max(0, tabAreaWidth);", "-\t\tint count = items.length;", "-\t\tfor (int i = 0 ; i < count; i++) {", "-\t\t\ttotalWidth += widths[i];", "+\t} else {", "+\t\tint maxWidth = 0;", "+\t\tint[] maxWidths = new int[items.length];", "+\t\tfor (int i = 0; i < items.length; i++) {", "+\t\t\tmaxWidths[i] = items[i].preferredWidth(gc, i == selectedIndex, false);", "+\t\t\tmaxWidth += maxWidths[i];", "-\t\tif (totalWidth > tabAreaWidth) {", "-\t\t\t// try maximum compression size", "-\t\t\ttotalWidth = 0;", "-\t\t\tint[] minWidths = new int[items.length];", "-\t\t\tfor (int i = 0 ; i < count; i++) {", "-\t\t\t\tminWidths[i] = items[i].preferredWidth(gc, i == selectedIndex, true);", "-\t\t\t\ttotalWidth += minWidths[i];", "+\t\tif (maxWidth <= tabAreaWidth) {", "+\t\t\t// no compression required", "+\t\t\twidths = maxWidths;", "+\t\t} else {", "+\t\t\t// determine compression for each item", "+\t\t\tint extra = (tabAreaWidth - minWidth) / items.length;", "+\t\t\twhile (true) {", "+\t\t\t\tint large = 0, totalWidth = 0;", "+\t\t\t\tfor (int i = 0 ; i < items.length; i++) {", "+\t\t\t\t\tif (maxWidths[i] > minWidths[i] + extra) {", "+\t\t\t\t\t\ttotalWidth += minWidths[i] + extra;", "+\t\t\t\t\t\tlarge++;", "+\t\t\t\t\t} else {", "+\t\t\t\t\t\ttotalWidth += maxWidths[i];", "+\t\t\t\t\t}", "+\t\t\t\t}", "+\t\t\t\tif (totalWidth >= tabAreaWidth) {", "+\t\t\t\t\textra--;", "+\t\t\t\t\tbreak;", "+\t\t\t\t}", "+\t\t\t\tif (large == 0 || tabAreaWidth - totalWidth < large) break;", "+\t\t\t\textra++;", "-\t\t\tif (totalWidth > tabAreaWidth) {", "-\t\t\t\t//  maximum compression required and a chevron", "-\t\t\t\tshowChevron = items.length > 1;", "-\t\t\t\tif (showChevron) tabAreaWidth -= 3*BUTTON_SIZE/2;", "-\t\t\t\twidths = minWidths;", "-\t\t\t\tint index = selectedIndex != -1 ? selectedIndex : 0;", "-\t\t\t\tif (tabAreaWidth < widths[index]) {", "-\t\t\t\t\twidths[index] = Math.max(0, tabAreaWidth);", "-\t\t\t\t}", "-\t\t\t} else {", "-\t\t\t\t// determine compression for each item", "-\t\t\t\tint extra = (tabAreaWidth - totalWidth) / items.length;", "-\t\t\t\tint large = 0;", "-\t\t\t\twhile (true) {", "-\t\t\t\t\ttotalWidth = 0;", "-\t\t\t\t\tlarge = 0;", "-\t\t\t\t\tfor (int i = 0 ; i < count; i++) {", "-\t\t\t\t\t\tif (widths[i] > minWidths[i] + extra) {", "- \t\t\t\t\t\t\ttotalWidth += minWidths[i] + extra;", "-\t\t\t\t\t\t\tlarge++;", "-\t\t\t\t\t\t} else {", "-\t\t\t\t\t\t\ttotalWidth += widths[i];", "-\t\t\t\t\t\t}", "-\t\t\t\t\t}", "-\t\t\t\t\tif (totalWidth >= tabAreaWidth) {", "-\t\t\t\t\t\textra--;", "-\t\t\t\t\t\tbreak;", "-\t\t\t\t\t}", "-\t\t\t\t\tif (large == 0 ||tabAreaWidth - totalWidth < large) break;", "-\t\t\t\t\textra++;", "-\t\t\t\t}", "-\t\t\t\tfor (int i = 0; i < items.length; i++) {", "-\t\t\t\t\twidths[i] = Math.min(widths[i], minWidths[i] + extra);", "-\t\t\t\t}\t", "+\t\t\twidths = new int[items.length];", "+\t\t\tfor (int i = 0; i < items.length; i++) {", "+\t\t\t\twidths[i] = Math.min(maxWidths[i], minWidths[i] + extra);", "-\t", "+\tgc.dispose();", "+", "-\tgc.dispose();"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "fb87c3d1afea5c330cd17b6b4da77049", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Custom Widgets/common/org/eclipse/swt/custom/CTabFolder.java", "commitBeforeChange": "1f6933a1b15056c0d45fcdf5019d55449793c82d", "commitAfterChange": "03b27348c501db581e6b7fd3b2d0cc945cd398ee", "methodNumberBeforeChange": 89, "methodNumberAfterChange": 88, "signatureBeforeChange": " boolean setItemSize()", "signatureAfterChange": " boolean setItemSize()", "diff": ["-\tCTabFolderEvent e = new CTabFolderEvent(this);", "-\te.widget = this;", "-\te.time = (int)System.currentTimeMillis();", "-\te.doit = true;", "-\tfor (int i = 0; i < items.length; i++) {", "-\t\te.x = e.y = e.width = e.height = 0;", "-\t\te.item = items[i];", "-\t\tfor (int j = 0; j < folderListeners.length; j++) {", "-\t\t\tfolderListeners[j].getTabSize(e);", "-\t\t}", "-\t\twidths[i] = e.width;", "+\twidths = new int[items.length];", "+\tif (size.x <= 0 || size.y <= 0 || items.length == 0) return false;", "+\txClient = borderLeft + marginWidth + highlight_margin;", "+\tif (onBottom) {", "+\t\tyClient = borderTop + highlight_margin + marginHeight;", "+\t} else {", "+\t\tyClient = borderTop + tabHeight + highlight_header + marginHeight; ", "-\tif (e.doit) {", "-\t\twidths = new int[items.length];", "-\t\tif (size.x <= 0 || size.y <= 0 || items.length == 0) return false;", "-\t\txClient = borderLeft + marginWidth + highlight_margin;", "-\t\tif (onBottom) {", "-\t\t\tyClient = borderTop + highlight_margin + marginHeight;", "-\t\t} else {", "-\t\t\tyClient = borderTop + tabHeight + highlight_header + marginHeight; ", "+\t", "+\tGC gc = new GC(this);", "+\tfor (int i = 0; i < items.length; i++) {", "+\t\twidths[i] = items[i].preferredWidth(gc, i == selectedIndex);", "+\t}", "+\tgc.dispose();", "+\t", "+\tif (!single && items.length > 1) {", "+\t\tint totalWidth = 0;", "+\t\tint tabAreaWidth = size.x - borderLeft - borderRight - minRect.width - maxRect.width;", "+\t\tif (!simple) tabAreaWidth -= curveWidth - curveIndent;", "+\t\tint count = items.length;", "+\t\tfor (int i = 0 ; i < count; i++) {", "+\t\t\ttotalWidth += widths[i];", "-\t\t", "-\t\tGC gc = new GC(this);", "-\t\tfor (int i = 0; i < items.length; i++) {", "-\t\t\twidths[i] = items[i].preferredWidth(gc, i == selectedIndex);", "-\t\t}", "-\t\tgc.dispose();", "-\t\t", "-\t\tif (!single && items.length > 1) {", "-\t\t\tint totalWidth = 0;", "-\t\t\tint tabAreaWidth = size.x - borderLeft - borderRight - minRect.width - maxRect.width;", "-\t\t\tint count = items.length;", "+\t\tif (totalWidth > tabAreaWidth) {", "+\t\t\t// try to compress items", "+\t\t\tint minWidth = MIN_TAB_WIDTH * tabHeight;", "+\t\t\ttotalWidth = 0;", "+\t\t\tint large = 0;", "-\t\t\t\ttotalWidth += widths[i];", "+\t\t\t\ttotalWidth += Math.min(widths[i], minWidth);", "+\t\t\t\tif (widths[i] > minWidth) large++;", "-\t\t\tif (totalWidth > tabAreaWidth) {", "-\t\t\t\t// try to compress items", "-\t\t\t\tint minWidth = MIN_TAB_WIDTH * tabHeight;", "-\t\t\t\ttotalWidth = 0;", "-\t\t\t\tint large = 0;", "-\t\t\t\tfor (int i = 0 ; i < count; i++) {", "-\t\t\t\t\ttotalWidth += Math.min(widths[i], minWidth);", "-\t\t\t\t\tif (widths[i] > minWidth) large++;", "+\t\t\tif (totalWidth >= tabAreaWidth) {", "+\t\t\t\t// maximum compression required", "+\t\t\t\tfor (int i = 0; i < count; i++) {", "+\t\t\t\t\twidths[i] = Math.min(widths[i], minWidth);", "-\t\t\t\tif (totalWidth >= tabAreaWidth) {", "-\t\t\t\t\t// maximum compression required", "-\t\t\t\t\tfor (int i = 0; i < count; i++) {", "-\t\t\t\t\t\twidths[i] = Math.min(widths[i], minWidth);", "+\t\t\t} else {", "+\t\t\t\t// determine compression for each item", "+\t\t\t\tint extra = (tabAreaWidth - totalWidth)/large;", "+\t\t\t\twhile (true) {", "+\t\t\t\t\ttotalWidth = 0;", "+\t\t\t\t\tlarge = 0;", "+\t\t\t\t\tfor (int i = 0 ; i < count; i++) {", "+\t\t\t\t\t\ttotalWidth += Math.min(widths[i], minWidth + extra);", "+\t\t\t\t\t\tif (widths[i] > minWidth + extra) large++;", "-\t\t\t\t} else {", "-\t\t\t\t\t// determine compression for each item", "-\t\t\t\t\tint extra = (tabAreaWidth - totalWidth)/large;", "-\t\t\t\t\twhile (true) {", "-\t\t\t\t\t\ttotalWidth = 0;", "-\t\t\t\t\t\tlarge = 0;", "-\t\t\t\t\t\tfor (int i = 0 ; i < count; i++) {", "-\t\t\t\t\t\t\ttotalWidth += Math.min(widths[i], minWidth + extra);", "-\t\t\t\t\t\t\tif (widths[i] > minWidth + extra) large++;", "-\t\t\t\t\t\t}", "-\t\t\t\t\t\tif (totalWidth >= tabAreaWidth) {", "-\t\t\t\t\t\t\textra--;", "-\t\t\t\t\t\t\tbreak;", "-\t\t\t\t\t\t}", "-\t\t\t\t\t\tif (large == 0 ||tabAreaWidth - totalWidth < large) break;", "-\t\t\t\t\t\textra++;", "+\t\t\t\t\tif (totalWidth >= tabAreaWidth) {", "+\t\t\t\t\t\textra--;", "+\t\t\t\t\t\tbreak;", "-\t\t\t\t\tfor (int i = 0; i < items.length; i++) {", "-\t\t\t\t\t\twidths[i] = Math.min(widths[i], minWidth + extra);", "-\t\t\t\t\t}\t", "+\t\t\t\t\tif (large == 0 ||tabAreaWidth - totalWidth < large) break;", "+\t\t\t\t\textra++;", "+\t\t\t\tfor (int i = 0; i < items.length; i++) {", "+\t\t\t\t\twidths[i] = Math.min(widths[i], minWidth + extra);", "+\t\t\t\t}\t", "-\tfor (int i = 0; i < items.length; i++) { ", "+\tfor (int i = 0; i < items.length; i++) {", "+\t\tif (!simple && !single && i == selectedIndex) widths[i] += curveWidth - curveIndent;"]}], "num": 37161}