{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "6be1495a5d6c80440e609910bcc5bf92", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "24d99170b77dab700d313872246c9ba5", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Mozilla/common/org/eclipse/swt/browser/Mozilla.java", "commitBeforeChange": "a6d7c9702ce7a561db1ee4e580dbac7b182664eb", "commitAfterChange": "b765c2d5227504d1bd072902861bf2c79ab25d2f", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": "  public void create (Composite parent, int style)", "signatureAfterChange": "  public void create (Composite parent, int style)", "diff": ["+", "+\t\t\t\t/*", "+\t\t\t\t * Test whether the detected XULRunner can be used as the GRE before loading swt's", "+\t\t\t\t * XULRunner library.  If it cannot be used then fall back to attempting to use", "+\t\t\t\t * the GRE pointed to by MOZILLA_FIVE_HOME.", "+\t\t\t\t * ", "+\t\t\t\t * One case where this will fail is attempting to use a 64-bit xulrunner while swt", "+\t\t\t\t * is running in 32-bit mode, or vice versa.", "+\t\t\t\t */", "+\t\t\t\tbyte[] path = MozillaDelegate.wcsToMbcs (null, mozillaPath, true);", "+\t\t\t\trc = XPCOMInit.XPCOMGlueStartup (path);", "+\t\t\t\tif (rc != XPCOM.NS_OK) {", "+\t\t\t\t\tisXULRunner = false;\t/* failed */", "+\t\t\t\t\tmozillaPath = mozillaPath.substring (0, mozillaPath.lastIndexOf (SEPARATOR_OS));", "+\t\t\t\t\tif (Device.DEBUG) System.out.println (\"cannot use detected XULRunner: \" + mozillaPath); //$NON-NLS-1$", "+\t\t\t\t} else {", "+\t\t\t\t\tXPCOMInit.XPCOMGlueShutdown ();", "+\t\t\t\t}", "-", "-\t\t\t/*", "-\t\t\t * Test whether the detected XULRunner can be used as the GRE before loading swt's", "-\t\t\t * XULRunner library.  If it cannot be used then fall back to attempting to use", "-\t\t\t * the GRE pointed to by MOZILLA_FIVE_HOME.", "-\t\t\t * ", "-\t\t\t * One case where this will fail is attempting to use a 64-bit xulrunner while swt", "-\t\t\t * is running in 32-bit mode, or vice versa.", "-\t\t\t */", "-\t\t\tbyte[] path = MozillaDelegate.wcsToMbcs (null, mozillaPath, true);", "-\t\t\trc = XPCOMInit.XPCOMGlueStartup (path);", "-\t\t\tif (rc != XPCOM.NS_OK) {", "-\t\t\t\tisXULRunner = false;\t/* failed */", "-\t\t\t\tmozillaPath = mozillaPath.substring (0, mozillaPath.lastIndexOf (SEPARATOR_OS));", "-\t\t\t\tif (Device.DEBUG) System.out.println (\"cannot use detected XULRunner: \" + mozillaPath); //$NON-NLS-1$", "-\t\t\t} else {", "-\t\t\t\tXPCOMInit.XPCOMGlueShutdown ();", "-\t\t\t}"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "d4ab6926060848f203a2b39d7ed79e84", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Mozilla/common/org/eclipse/swt/browser/Mozilla.java", "commitBeforeChange": "576b8b9621143b0dd2c8cf428f00a730c5074665", "commitAfterChange": "282f74d6ee885b09d0645c1a1456a7045a3ac6ee", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": "  public void create (Composite parent, int style)", "signatureAfterChange": "  public void create (Composite parent, int style)", "diff": ["-\t\t\t\t\t\tIsXULRunner = false;\t/* failed */", "-\t\t\t\t\t} else {", "+", "+\t\t\t\t\t\t/* attempt to XPCOMGlueStartup the GRE pointed at by MOZILLA_FIVE_HOME */", "+\t\t\t\t\t\tint /*long*/ ptr = C.getenv (MozillaDelegate.wcsToMbcs (null, XPCOM.MOZILLA_FIVE_HOME, true));", "+\t\t\t\t\t\tif (ptr == 0) {", "+\t\t\t\t\t\t\tIsXULRunner = false;", "+\t\t\t\t\t\t} else {", "+\t\t\t\t\t\t\tlength = C.strlen (ptr);", "+\t\t\t\t\t\t\tbyte[] buffer = new byte[length];", "+\t\t\t\t\t\t\tC.memmove (buffer, ptr, length);", "+\t\t\t\t\t\t\tmozillaPath = new String (MozillaDelegate.mbcsToWcs (null, buffer));", "+\t\t\t\t\t\t\t/*", "+\t\t\t\t\t\t\t * Attempting to XPCOMGlueStartup a mozilla-based GRE != xulrunner can", "+\t\t\t\t\t\t\t * crash, so don't attempt unless the GRE appears to be xulrunner.", "+\t\t\t\t\t\t\t */", "+\t\t\t\t\t\t\tif (mozillaPath.indexOf(\"xulrunner\") == -1) { //$NON-NLS-1$", "+\t\t\t\t\t\t\t\tIsXULRunner = false;\t", "+\t\t\t\t\t\t\t} else {", "+\t\t\t\t\t\t\t\tmozillaPath += SEPARATOR_OS + delegate.getLibraryName ();", "+\t\t\t\t\t\t\t\tpath = MozillaDelegate.wcsToMbcs (null, mozillaPath, true);", "+\t\t\t\t\t\t\t\trc = XPCOMInit.XPCOMGlueStartup (path);", "+\t\t\t\t\t\t\t\tif (rc != XPCOM.NS_OK) {", "+\t\t\t\t\t\t\t\t\tIsXULRunner = false;", "+\t\t\t\t\t\t\t\t\tmozillaPath = mozillaPath.substring (0, mozillaPath.lastIndexOf (SEPARATOR_OS));", "+\t\t\t\t\t\t\t\t\tif (Device.DEBUG) System.out.println (\"failed to start as XULRunner: \" + mozillaPath); //$NON-NLS-1$", "+\t\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t\t}", "+\t\t\t\t\t\t} ", "+\t\t\t\t\t}", "+\t\t\t\t\tif (IsXULRunner) {"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "51faa8f52debac64ad5e10ced4f3b2c2", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Mozilla/common/org/eclipse/swt/browser/Mozilla.java", "commitBeforeChange": "a556436573952e606d00f8af01714440359b5fcd", "commitAfterChange": "1548d2a1d776fa0eb456579bf098076fba27fd97", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": "  public void create (Composite parent, int style)", "signatureAfterChange": "  public void create (Composite parent, int style)", "diff": ["-\t\tboolean isXULRunner = false;", "-\t\t\t\tbyte[] path = MozillaDelegate.wcsToMbcs (null, mozillaPath, true);", "-\t\t\t\trc = XPCOMInit.XPCOMGlueStartup (path);", "-\t\t\t\tif (rc != XPCOM.NS_OK) {", "-\t\t\t\t\tisXULRunner = false;\t/* failed */", "-\t\t\t\t\tmozillaPath = mozillaPath.substring (0, mozillaPath.lastIndexOf (SEPARATOR_OS));", "-\t\t\t\t\tif (Device.DEBUG) System.out.println (\"cannot use detected XULRunner: \" + mozillaPath); //$NON-NLS-1$", "-\t\t\t\t} else {", "-\t\t\t\t\tXPCOMInit.XPCOMGlueShutdown ();", "+\t\t\t\tif (isXULRunner) {", "+\t\t\t\t\tbyte[] path = MozillaDelegate.wcsToMbcs (null, mozillaPath, true);", "+\t\t\t\t\trc = XPCOMInit.XPCOMGlueStartup (path);", "+\t\t\t\t\tif (rc != XPCOM.NS_OK) {", "+\t\t\t\t\t\tisXULRunner = false;\t/* failed */", "+\t\t\t\t\t\tmozillaPath = mozillaPath.substring (0, mozillaPath.lastIndexOf (SEPARATOR_OS));", "+\t\t\t\t\t\tif (Device.DEBUG) System.out.println (\"cannot use detected XULRunner: \" + mozillaPath); //$NON-NLS-1$", "+\t\t\t\t\t} else {", "+\t\t\t\t\t\tXPCOMInit.XPCOMGlueShutdown ();", "+\t\t\t\t\t}", "-\t\tFilePickerFactory pickerFactory = new FilePickerFactory ();", "+\t\tFilePickerFactory pickerFactory = isXULRunner ? new FilePickerFactory_1_8 () : new FilePickerFactory ();"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "0b7a387e972dbb9db438c4a93f048df8", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Mozilla/common/org/eclipse/swt/browser/Mozilla.java", "commitBeforeChange": "24e023b39c6a1f997d00fc39509e25380da519a6", "commitAfterChange": "96d4c6fcb326919f184098175910777b60bec609", "methodNumberBeforeChange": 1, "methodNumberAfterChange": 1, "signatureBeforeChange": "  public void create (Composite parent, int style)", "signatureAfterChange": "  public void create (Composite parent, int style)", "diff": ["+\t\t\t/*", "+\t\t\t * Test whether the detected XULRunner can be used as the GRE before loading swt's", "+\t\t\t * XULRunner library.  If it cannot be used then fall back to attempting to use", "+\t\t\t * the GRE pointed to by MOZILLA_FIVE_HOME.", "+\t\t\t * ", "+\t\t\t * One case where this will fail is attempting to use a 64-bit xulrunner while swt", "+\t\t\t * is running in 32-bit more, or vice versa.", "+\t\t\t */", "+\t\t\tbyte[] path = MozillaDelegate.wcsToMbcs (null, mozillaPath, true);", "+\t\t\tint rc = XPCOMInit.XPCOMGlueStartup (path);", "+\t\t\tif (rc != XPCOM.NS_OK) {", "+\t\t\t\tisXULRunner = false;\t/* failed */", "+\t\t\t\tmozillaPath = mozillaPath.substring (0, mozillaPath.lastIndexOf (SEPARATOR_OS));", "+\t\t\t\tif (Device.DEBUG) System.out.println (\"cannot use detected XULRunner: \" + mozillaPath); //$NON-NLS-1$", "+\t\t\t} else {", "+\t\t\t\tXPCOMInit.XPCOMGlueShutdown ();", "+\t\t\t}", "+\t\t}", "+", "+\t\tif (isXULRunner) {", "-\t\t\t\tSWT.error (SWT.ERROR_NO_HANDLES, null, \" [Could not detect registered XULRunner to use]\"); //$NON-NLS-1$", "+\t\t\t\tString errorString = (mozillaPath != null && mozillaPath.length () > 0) ?", "+\t\t\t\t\t\" [Failed to use detected XULRunner: \" + mozillaPath + \"]\" :", "+\t\t\t\t\t\" [Could not detect registered XULRunner to use]\";\t//$NON-NLS-1$ //$NON-NLS-2$ //$NON-NLS-3$", "+\t\t\t\tSWT.error (SWT.ERROR_NO_HANDLES, null, errorString);", "-\t\t\t}", "-\t\t\tif (mozillaPath == null) {", "+\t\t\t} else {"]}], "num": 19048}