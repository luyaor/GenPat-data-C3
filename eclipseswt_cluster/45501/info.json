{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "4341257336985c76c840159f8c163ebe", "detectedBy": ["DIFF_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "179bf644170f43326175869868046d42", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/carbon/org/eclipse/swt/widgets/Control.java", "commitBeforeChange": "d063aea08192e0213a4b6532b27dc31f9dce6e1b", "commitAfterChange": "48ef0056097e65cbe2f990bf125c93e76b95da33", "methodNumberBeforeChange": 48, "methodNumberAfterChange": 44, "signatureBeforeChange": " public int internal_new_GC (GCData data)", "signatureAfterChange": "  public int internal_new_GC (GCData data)", "diff": ["- */", "+", "-    /* AW", "-\tif (!OS.XtIsRealized (handle)) {", "-\t\tShell shell = getShell ();", "-\t\tshell.realizeWidget ();", "+\tint [] buffer = new int [1];", "+\tint context = 0, paintRgn = 0, visibleRgn = 0;", "+\tif (data.paintEvent != 0) {", "+\t\tint theEvent = data.paintEvent;", "+\t\tOS.GetEventParameter (theEvent, OS.kEventParamCGContextRef, OS.typeCGContextRef, null, 4, null, buffer);", "+\t\tcontext = buffer [0];\t", "+\t\tOS.GetEventParameter (theEvent, OS.kEventParamRgnHandle, OS.typeQDRgnHandle, null, 4, null, buffer);", "+\t\tvisibleRgn = paintRgn = buffer [0];", "-\tint xDisplay = OS.XtDisplay (handle);", "-\tif (xDisplay == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "-\tint xWindow = OS.XtWindow (handle);", "-\tif (xWindow == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "-\tint xGC = OS.XCreateGC (xDisplay, xWindow, 0, null);", "-\tif (xGC == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "-\tOS.XSetGraphicsExposures (xDisplay, xGC, false);", "-\tint [] argList = {OS.XmNforeground, 0, OS.XmNbackground, 0, OS.XmNcolormap, 0};", "-\tOS.XtGetValues (handle, argList, argList.length / 2);", "-\t*/", "+\tif (context == 0) {", "+\t\tint window = OS.GetControlOwner (handle);", "+\t\tint port = OS.GetWindowPort (window);", "+\t\tOS.CreateCGContextForPort (port, buffer);", "+\t\tcontext = buffer [0];", "+\t\tif (context != 0) {", "+\t\t\tRect rect = new Rect ();", "+\t\t\tOS.GetControlBounds (handle, rect);", "+\t\t\tRect portRect = new Rect ();", "+\t\t\tOS.GetPortBounds (port, portRect);", "+\t\t\tvisibleRgn = getVisibleRegion (handle);", "+\t\t\tif (paintRgn != 0) OS.SectRgn (paintRgn, visibleRgn, visibleRgn);", "+\t\t\tOS.ClipCGContextToRegion (context, portRect, visibleRgn);", "+\t\t\tint portHeight = portRect.bottom - portRect.top;", "+\t\t\tOS.CGContextScaleCTM (context, 1, -1);", "+\t\t\tOS.CGContextTranslateCTM (context, rect.left, -portHeight + rect.top);", "+\t\t}", "+\t}", "+\tif (context == 0) SWT.error (SWT.ERROR_NO_HANDLES);", "-\t\tdata.device = getDisplay ();", "-\t\tdata.foreground = getForegroundPixel();", "-\t\tdata.background = getBackgroundPixel();", "-\t\tdata.font = font.handle;", "-\t\tdata.controlHandle = handle;", "-\t}", "-", "-\tint wHandle= 0;", "-\tif (MacUtil.USE_FRAME) {", "-\t\tShell shell= getShell();", "-\t\tif (shell != null)", "-\t\t\twHandle= shell.shellHandle;", "+\t\tDisplay display = getDisplay ();", "+\t\tdata.device = display;", "+\t\tdata.foreground = foreground != null ? foreground : display.getSystemColor (SWT.COLOR_BLACK).handle;", "+\t\tdata.background = background != null ? background : display.getSystemColor (SWT.COLOR_WHITE).handle;", "+\t\tdata.font = font != null ? font : defaultFont ();", "+\t\tdata.visibleRgn = visibleRgn;", "+\t\tdata.control = handle;", "-\t\twHandle= OS.GetControlOwner(handle);", "+\t\tif (visibleRgn != paintRgn) OS.DisposeRgn (visibleRgn);", "-\tint xGC= OS.GetWindowPort(wHandle);", "-\tif (xGC == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "-\t", "-    return xGC;", "+\treturn context;"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "fdb1b2f974b5a80d22cbd16e36b619fa", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/carbon/org/eclipse/swt/graphics/GC.java", "commitBeforeChange": "d063aea08192e0213a4b6532b27dc31f9dce6e1b", "commitAfterChange": "48ef0056097e65cbe2f990bf125c93e76b95da33", "methodNumberBeforeChange": 44, "methodNumberAfterChange": 43, "signatureBeforeChange": " void init(Drawable drawable, GCData data, int xGC)", "signatureAfterChange": "  void init(Drawable drawable, GCData data, int context)", "diff": ["-void init(Drawable drawable, GCData data, int xGC) {", "-\t/* AW", "-\tint xDisplay = data.display;", "-\tint foreground = data.foreground;", "-\tif (foreground != -1) OS.XSetForeground (xDisplay, xGC, foreground);", "-\tint background = data.background;", "-\tif (background != -1) OS.XSetBackground (xDisplay, xGC, background);", "-\t*/", "+", "+void init(Drawable drawable, GCData data, int context) {", "+\tint colorspace = data.device.colorspace;", "+\tOS.CGContextSetStrokeColorSpace(context, colorspace);", "+\tOS.CGContextSetFillColorSpace(context, colorspace);", "+\tfloat[] foreground = data.foreground;", "+\tif (foreground != null) OS.CGContextSetStrokeColor(context, foreground);", "+\tfloat[] background = data.background;", "+\tif (background != null) OS.CGContextSetFillColor(context, background);", "+", "+\tint[] buffer = new int[1];", "+\tOS.ATSUCreateTextLayout(buffer);", "+\tif (buffer[0] == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "+\tdata.layout = buffer[0];", "+\tOS.ATSUCreateStyle(buffer);", "+\tif (buffer[0] == 0) SWT.error(SWT.ERROR_NO_HANDLES);", "+\tdata.style = buffer[0];", "+\t", "+\tint ptr = OS.NewPtr(4);", "+\tbuffer[0] = context;", "+\tOS.memcpy(ptr, buffer, 4);", "+\tint[] tags = new int[]{OS.kATSUCGContextTag};", "+\tint[] sizes = new int[]{4};", "+\tint[] values = new int[]{ptr};", "+\tOS.ATSUSetLayoutControls(data.layout, tags.length, tags, sizes, values);", "+\tOS.DisposePtr(ptr);", "+", "-\t\tif (image.transparentPixel != -1) image.destroyMask();", "+//\t\tif (image.transparentPixel != -1) image.destroyMask();", "-\tif (xGC == 0)", "-\t\tSWT.error(SWT.ERROR_GRAPHIC_DISPOSED);", "-\thandle = xGC;", "+\thandle = context;", "+", "+\tFont font = data.font;", "+\tif (font != null) setFont(font);"]}], "num": 45501}