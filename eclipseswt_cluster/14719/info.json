{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "0654f88919cfbeffed10b98dc4a30036", "detectedBy": ["DIFF_HIERARCHICAL", "DIFF_DBSCAN", "AST_HIERARCHICAL", "AST_DBSCAN"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "10f11aaf0d2e7c0836d62aa364fb06f2", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Custom Widgets/common/org/eclipse/swt/custom/StyledText.java", "commitBeforeChange": "40cdf2a9aca64c3d5be03c7e511afd690ece84ea", "commitAfterChange": "a4b7aa3a6538ae186e20f13ca84baaf05474bec5", "methodNumberBeforeChange": 76, "methodNumberAfterChange": 76, "signatureBeforeChange": " void doLineDown(boolean select)", "signatureAfterChange": " void doLineDown(boolean select)", "diff": ["-\tboolean paragraphDown = true;", "+\tint lineCount = content.getLineCount();", "+\tint y = 0;", "+\tboolean lastLine = false;", "-\t\tTextLayout layout = renderer.getTextLayout(caretLine);", "-\t\tif (layout.getLineCount() > 0) {", "-\t\t\tPoint pos = getCaret().getLocation();", "-\t\t\tpos.x = columnX + horizontalScrollOffset;", "-\t\t\tpos.y -= getLinePixel(caretLine);", "-\t\t\tint offset = layout.getOffset(pos, null);", "-\t\t\tint lineInParagraph = layout.getLineIndex(offset);", "-\t\t\tif (lineInParagraph < layout.getLineCount() - 1) {", "-\t\t\t\tint lineOffset = content.getOffsetAtLine(caretLine);", "-\t\t\t\tparagraphDown = false;", "-\t\t\t\tpos.y += layout.getLineBounds(lineInParagraph).height;", "-\t\t\t\tcaretOffset = lineOffset + layout.getOffset(pos, null);", "-\t\t\t\tadvancing = false;", "-\t\t\t}", "-\t\t}", "-\t\trenderer.disposeTextLayout(layout);", "-\t}", "-\tif (select && caretLine == content.getLineCount() - 1) {", "-\t\tcaretOffset = content.getCharCount();", "-\t}", "-\tif (paragraphDown && caretLine < content.getLineCount() - 1) {", "-\t\tcaretLine++;", "+\t\tint offsetInLine = caretOffset - lineOffset;", "-\t\tint x = columnX + horizontalScrollOffset - leftMargin;", "-\t\tcaretOffset = lineOffset + layout.getOffset(x, 0, null);", "-\t\tadvancing = false;", "+\t\tint lineIndex = layout.getLineIndex(offsetInLine);", "+\t\tint[] offsets = layout.getLineOffsets();", "+\t\tint layoutLineCount = layout.getLineCount();", "+\t\tif (lineIndex != 0 && offsetInLine == offsets[lineIndex] && caretAlignment == PREVIOUS_OFFSET_TRAILING) {", "+\t\t\tlineIndex--;", "+\t\t}", "+\t\tRectangle bounds = layout.getLineBounds(lineIndex); ", "+\t\tlastLine = caretLine == lineCount - 1 && lineIndex == layoutLineCount - 1;", "+\t\ty += bounds.y + bounds.height;", "+\t\tif (lineIndex == layoutLineCount - 1) {", "+\t\t\ty += layout.getSpacing();", "+\t\t}", "+\t} else {", "+\t\tlastLine = caretLine == content.getLineCount() - 1;", "+\t\ty += renderer.getLineHeight(caretLine);", "+\t}", "+\tif (lastLine) {", "+\t\tif (select) {", "+\t\t\tcaretOffset = content.getCharCount();", "+\t\t}", "+\t} else {", "+\t\tcaretOffset = getOffsetAtPoint(columnX, y + getLinePixel(caretLine));"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "224f716d396f7a0708c864ea4670e75e", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT Custom Widgets/common/org/eclipse/swt/custom/StyledText.java", "commitBeforeChange": "40cdf2a9aca64c3d5be03c7e511afd690ece84ea", "commitAfterChange": "a4b7aa3a6538ae186e20f13ca84baaf05474bec5", "methodNumberBeforeChange": 79, "methodNumberAfterChange": 79, "signatureBeforeChange": " void doLineUp(boolean select)", "signatureAfterChange": " void doLineUp(boolean select)", "diff": ["-\tboolean paragraphUp = true;", "+\tint y = 0;", "+\tboolean firstLine;", "-\t\tTextLayout layout = renderer.getTextLayout(caretLine);", "-\t\tif (layout.getLineCount() > 0) {", "-\t\t\tPoint pos = getCaret().getLocation();", "-\t\t\tpos.x = columnX + horizontalScrollOffset;", "-\t\t\tpos.y -= getLinePixel(caretLine);", "-\t\t\tint offset = layout.getOffset(pos, null);", "-\t\t\tint lineInParagraph = layout.getLineIndex(offset);", "-\t\t\tif (lineInParagraph > 0) {", "-\t\t\t\tint lineOffset = content.getOffsetAtLine(caretLine);", "-\t\t\t\tparagraphUp = false;", "-\t\t\t\tpos.y -= layout.getLineBounds(lineInParagraph).height;", "-\t\t\t\tcaretOffset = lineOffset + layout.getOffset(pos, null);", "-\t\t\t\tadvancing = false;", "-\t\t\t}", "-\t\t}", "-\t\trenderer.disposeTextLayout(layout);", "-\t}", "-\tif (select && caretLine == 0) {", "-\t\tcaretOffset = 0;", "-\t}", "-\tif (paragraphUp && caretLine > 0) {", "-\t\tcaretLine--;", "+\t\tint offsetInLine = caretOffset - lineOffset;", "-\t\tint x = columnX + horizontalScrollOffset - leftMargin;", "-\t\tint y = layout.getBounds().height - 1;", "-\t\tcaretOffset = lineOffset + layout.getOffset(x, y, null);", "-\t\tadvancing = false;", "+\t\tint lineIndex = layout.getLineIndex(offsetInLine);", "+\t\tint[] offsets = layout.getLineOffsets();", "+\t\tif (lineIndex != 0 && offsetInLine == offsets[lineIndex] && caretAlignment == PREVIOUS_OFFSET_TRAILING) {", "+\t\t\tlineIndex--;", "+\t\t}", "+\t\tRectangle bounds = layout.getLineBounds(lineIndex);", "+\t\tfirstLine = caretLine == 0 && lineIndex == 0;", "+\t\ty += bounds.y;", "+\t} else {", "+\t\tfirstLine = caretLine == 0;", "+\t}", "+\tif (firstLine) {", "+\t\tif (select) caretOffset = 0;", "+\t} else {", "+\t\tcaretOffset = getOffsetAtPoint(columnX, y - 1 + getLinePixel(caretLine));"]}], "num": 14719}