{"@class": "de.fau.cs.inf2.cthree.data.Cluster", "id": "c2cb4989cb7c7163151be451158720e9", "detectedBy": ["DIFF_HIERARCHICAL"], "members": [{"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "8f154c87ecbef348ed23bdeea485aa11", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/gtk/org/eclipse/swt/graphics/TextLayout.java", "commitBeforeChange": "4ae7c7f058994a04613cca5e83c6754094e0435f", "commitAfterChange": "630867c677acb403ca1cea9965df17e2af419fee", "methodNumberBeforeChange": 6, "methodNumberAfterChange": 6, "signatureBeforeChange": " public void draw(GC gc, int x, int y, int selectionStart, int selectionEnd, Color selectionForeground, Color selectionBackground)", "signatureAfterChange": " public void draw(GC gc, int x, int y, int selectionStart, int selectionEnd, Color selectionForeground, Color selectionBackground)", "diff": ["+\tGCData data = gc.data;", "+\tint /*long*/ cairo = data.cairo;", "-\t\tOS.gdk_draw_layout(gc.data.drawable, gc.handle, x, y, layout);", "+\t\tif (cairo != 0 && OS.GTK_VERSION >= OS.VERSION(2, 8, 0)) {", "+\t\t\tCairo.cairo_move_to(cairo, x, y);", "+\t\t\tOS.pango_cairo_show_layout(cairo, layout);", "+\t\t} else {", "+\t\t\tOS.gdk_draw_layout(data.drawable, gc.handle, x, y, layout);", "+\t\t}", "-\t\t\tOS.gdk_draw_layout_with_colors(gc.data.drawable, gc.handle, x, y, layout, selectionForeground.handle, selectionBackground.handle);", "+\t\t\tif (cairo != 0 && OS.GTK_VERSION >= OS.VERSION(2, 8, 0)) {", "+\t\t\t\tint /*long*/ ptr = OS.pango_layout_get_text(layout);", "+\t\t\t\tdrawWithCairo(cairo, x, y, 0, OS.strlen(ptr), fullSelection, selectionBackground.handle, selectionForeground.handle);", "+\t\t\t} else {", "+\t\t\t\tOS.gdk_draw_layout_with_colors(data.drawable, gc.handle, x, y, layout, selectionForeground.handle, selectionBackground.handle);", "+\t\t\t}", "-\t\t\tRegion clipping = new Region();", "-\t\t\tgc.getClipping(clipping);", "-\t\t\tOS.gdk_draw_layout(gc.data.drawable, gc.handle, x, y, layout);", "-\t\t\tint[] ranges = new int[]{byteSelStart, byteSelEnd};", "-\t\t\tint /*long*/ rgn = OS.gdk_pango_layout_get_clip_region(layout, x, y, ranges, ranges.length / 2);", "-\t\t\tif (rgn != 0) {", "-\t\t\t\tOS.gdk_gc_set_clip_region(gc.handle, rgn);", "-\t\t\t\tOS.gdk_region_destroy(rgn);", "+\t\t\tif (cairo != 0 && OS.GTK_VERSION >= OS.VERSION(2, 8, 0)) {", "+\t\t\t\tdrawWithCairo(cairo, x, y, byteSelStart, byteSelEnd, fullSelection, selectionBackground.handle, selectionForeground.handle);", "+\t\t\t} else {", "+\t\t\t\tRegion clipping = new Region();", "+\t\t\t\tgc.getClipping(clipping);", "+\t\t\t\tOS.gdk_draw_layout(data.drawable, gc.handle, x, y, layout);", "+\t\t\t\tint[] ranges = new int[]{byteSelStart, byteSelEnd};", "+\t\t\t\tint /*long*/ rgn = OS.gdk_pango_layout_get_clip_region(layout, x, y, ranges, ranges.length / 2);", "+\t\t\t\tif (rgn != 0) {", "+\t\t\t\t\tOS.gdk_gc_set_clip_region(gc.handle, rgn);", "+\t\t\t\t\tOS.gdk_region_destroy(rgn);", "+\t\t\t\t}", "+\t\t\t\tOS.gdk_draw_layout_with_colors(data.drawable, gc.handle, x, y, layout, selectionForeground.handle, selectionBackground.handle);", "+\t\t\t\tgc.setClipping(clipping);", "+\t\t\t\tclipping.dispose();", "-\t\t\tOS.gdk_draw_layout_with_colors(gc.data.drawable, gc.handle, x, y, layout, selectionForeground.handle, selectionBackground.handle);", "-\t\t\tgc.setClipping(clipping);", "-\t\t\tclipping.dispose();"]}, {"@class": "de.fau.cs.inf2.cthree.data.CodeChange", "id": "f9901229dc8a3e3b8861fe94a3f9a8c9", "repository": "http://git.eclipse.org/gitroot/platform/eclipse.platform.swt.git", "fileName": "bundles/org.eclipse.swt/Eclipse SWT/gtk/org/eclipse/swt/graphics/GC.java", "commitBeforeChange": "f09fa17598b171271add9842e034e13ff6ff6c75", "commitAfterChange": "9b6f622a04ffc6428b9bddee8e107bf304da0051", "methodNumberBeforeChange": 11, "methodNumberAfterChange": 11, "signatureBeforeChange": " public void copyArea(int srcX, int srcY, int width, int height, int destX, int destY, boolean paint)", "signatureAfterChange": " public void copyArea(int srcX, int srcY, int width, int height, int destX, int destY, boolean paint)", "diff": ["-\t//TODO fix for USE_CAIRO", "-\tif (data.image == null && paint) OS.gdk_gc_set_exposures(handle, true);", "-\tOS.gdk_draw_drawable(drawable, handle, drawable, srcX, srcY, destX, destY, width, height);", "+\tif (OS.USE_CAIRO) {", "+\t\tif (data.image != null) {", "+\t\t\tCairo.cairo_set_source_surface(handle, data.image.surface, deltaX, deltaY);", "+\t\t\tCairo.cairo_rectangle(handle, destX, destY, width, height);", "+\t\t\tCairo.cairo_set_operator(handle, Cairo.CAIRO_OPERATOR_SOURCE);", "+\t\t\tCairo.cairo_fill(handle);", "+\t\t} else if (drawable != 0) {", "+\t\t\tCairo.cairo_save(handle);", "+\t\t\tCairo.cairo_rectangle(handle, destX, destY, width, height);", "+\t\t\tCairo.cairo_clip(handle);", "+\t\t\tCairo.cairo_translate(handle, deltaX, deltaY);", "+\t\t\tCairo.cairo_set_operator(handle, Cairo.CAIRO_OPERATOR_SOURCE);", "+\t\t\tCairo.cairo_push_group(handle);", "+\t\t\tOS.gdk_cairo_set_source_window(handle, drawable, 0, 0);", "+\t\t\tCairo.cairo_paint(handle);", "+\t\t\tCairo.cairo_pop_group_to_source(handle);", "+\t\t\tCairo.cairo_rectangle(handle, destX - deltaX, destY - deltaY, width, height);", "+\t\t\tCairo.cairo_clip(handle);", "+\t\t\tCairo.cairo_paint(handle);", "+\t\t\tCairo.cairo_restore(handle);", "+\t\t\tif (paint) {", "+\t\t\t\tint /*long*/ visibleRegion = OS.gdk_drawable_get_visible_region (drawable);", "+\t\t\t\tGdkRectangle srcRect = new GdkRectangle ();", "+\t\t\t\tsrcRect.x = srcX;", "+\t\t\t\tsrcRect.y = srcY;", "+\t\t\t\tsrcRect.width = width;", "+\t\t\t\tsrcRect.height = height;", "+\t\t\t\tint /*long*/ copyRegion = OS.gdk_region_rectangle (srcRect);", "+\t\t\t\tOS.gdk_region_intersect(copyRegion, visibleRegion);", "+\t\t\t\tint /*long*/ invalidateRegion = OS.gdk_region_rectangle (srcRect);\t", "+\t\t\t\tOS.gdk_region_subtract (invalidateRegion, visibleRegion);", "+\t\t\t\tOS.gdk_region_offset (invalidateRegion, deltaX, deltaY);", "+\t\t\t\tOS.gdk_window_invalidate_region(drawable, invalidateRegion, false);", "+\t\t\t\tOS.gdk_region_destroy (visibleRegion);", "+\t\t\t\tOS.gdk_region_destroy (copyRegion);", "+\t\t\t\tOS.gdk_region_destroy (invalidateRegion);", "+\t\t\t}", "+\t\t}", "+\t} else {", "+\t\tif (data.image == null && paint) OS.gdk_gc_set_exposures(handle, true);", "+\t\tOS.gdk_draw_drawable(drawable, handle, drawable, srcX, srcY, destX, destY, width, height);", "+\t}", "-\t\tOS.gdk_gc_set_exposures(handle, false);", "+\t\tif (!OS.USE_CAIRO) OS.gdk_gc_set_exposures(handle, false);"]}], "num": 48579}